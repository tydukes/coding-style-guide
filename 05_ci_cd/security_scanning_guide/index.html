
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Comprehensive guide to SAST, DAST, SCA, policy-as-code security testing with multi-tool strategy, CIS benchmarks, OPA/Rego policies, and centralized security dashboards">
      
      
        <meta name="author" content="Tyler Dukes">
      
      
        <link rel="canonical" href="https://tydukes.github.io/coding-style-guide/05_ci_cd/security_scanning_guide/">
      
      
        <link rel="prev" href="../ide_integration_guide/">
      
      
        <link rel="next" href="../code_signing_guide/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Security Scanning Guide - The Dukes Engineering Style Guide</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-XXXXXXXXXX",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="The Dukes Engineering Style Guide" class="md-header__button md-logo" aria-label="The Dukes Engineering Style Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The Dukes Engineering Style Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Security Scanning Guide
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/tydukes/coding-style-guide" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    coding-style-guide
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../01_overview/getting_started/" class="md-tabs__link">
          
  
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../00_standards/heading_structure/" class="md-tabs__link">
          
  
  
  Standards

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../02_language_guides/comparison_matrix/" class="md-tabs__link">
          
  
  
  Language Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../03_metadata_schema/schema_reference/" class="md-tabs__link">
        
  
  
    
  
  Metadata Schema

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../04_templates/README_template/" class="md-tabs__link">
          
  
  
  Templates

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../05_examples/python_package_example/" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../09_refactoring/" class="md-tabs__link">
          
  
  
  Refactoring

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../08_anti_patterns/" class="md-tabs__link">
          
  
  
  Anti-Patterns

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../10_migration_guides/from_pep8/" class="md-tabs__link">
          
  
  
  Migration Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../11_cloud_providers/azure/" class="md-tabs__link">
          
  
  
  Cloud Providers

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../ai_validation_pipeline/" class="md-tabs__link">
          
  
  
  CI / CD

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../06_container/usage/" class="md-tabs__link">
        
  
  
    
  
  Container Usage

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../07_integration/integration_prompt/" class="md-tabs__link">
          
  
  
  Integration

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../glossary/" class="md-tabs__link">
        
  
  
    
  
  Glossary

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../changelog/" class="md-tabs__link">
        
  
  
    
  
  Changelog

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="The Dukes Engineering Style Guide" class="md-nav__button md-logo" aria-label="The Dukes Engineering Style Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    The Dukes Engineering Style Guide
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/tydukes/coding-style-guide" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    coding-style-guide
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Overview
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01_overview/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01_overview/principles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Principles
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01_overview/governance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Governance
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01_overview/structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Structure
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01_overview/decision_trees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Decision Trees
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../project_status/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Project Status
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Standards
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Standards
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00_standards/heading_structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Heading Structure
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00_standards/code_block_language_tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Block Language Tags
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Language Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Language Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/comparison_matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Comparison Matrix
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Infrastructure as Code
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Infrastructure as Code
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/terraform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Terraform & Terragrunt
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/terragrunt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Terragrunt (live)
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/hcl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HCL
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/cloudformation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS CloudFormation
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/bicep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Bicep
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/cdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS CDK
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/pulumi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pulumi
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes & Helm
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/gitops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GitOps (ArgoCD & Flux)
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/crossplane/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Crossplane
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Configuration Management
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Configuration Management
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/ansible/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ansible
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Programming Languages
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Programming Languages
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Python
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/go/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Go
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/typescript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TypeScript
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/bash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bash
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/powershell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PowerShell
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/sql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SQL
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    CI/CD & Automation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    CI/CD & Automation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/jenkins_groovy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Jenkins / Groovy
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/jenkins_shared_libraries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Jenkins Shared Libraries
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/github_actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GitHub Actions
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/gitlab_ci/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GitLab CI/CD
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Compliance as Code
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Compliance as Code
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/compliance_as_code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    InSpec, OPA & Sentinel
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Data Formats
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data Formats
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/yaml/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    YAML
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/json/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JSON
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/json_schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JSON Schema
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/toml_ini/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TOML & INI
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Containerization
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Containerization
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/dockerfile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dockerfile
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/docker_compose/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker Compose
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/devcontainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dev Containers
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Build Tools
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Build Tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/makefile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Makefile
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/task_runners/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Task & Just
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Diagram as Code
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Diagram as Code
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02_language_guides/diagram_as_code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Diagram as Code
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03_metadata_schema/schema_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metadata Schema
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Templates
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Templates
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/README_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    README Template
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/terraform_module_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Terraform Module
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/python_package_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Python Package
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/gitignore_templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    .gitignore Templates
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/precommit_config_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pre-commit Config
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/github_actions_workflow_templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GitHub Actions Workflows
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/dockerfile_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dockerfile
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/docker_compose_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker Compose
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/helm_chart_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Helm Chart
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/contract_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CONTRACT.md Template
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/testing_docs_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Documentation
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/ide_settings_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IDE Settings
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/debug_config_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debug Configurations
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/operational_templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Operational Templates
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/adr_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR Template
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/reusable_workflows_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reusable Workflows
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_templates/code_generators_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Generators
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05_examples/python_package_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Python Package
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05_examples/terraform_module_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Terraform Module
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05_examples/ansible_role_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ansible Role
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05_examples/typescript_library_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TypeScript Library
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Refactoring
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Refactoring
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../09_refactoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../09_refactoring/python_refactoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Python Examples
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../09_refactoring/typescript_refactoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TypeScript Examples
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../09_refactoring/terraform_refactoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Terraform Examples
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../09_refactoring/ansible_refactoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ansible Examples
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../09_refactoring/bash_refactoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bash Examples
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Anti-Patterns
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Anti-Patterns
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../08_anti_patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Common Anti-Patterns
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../08_anti_patterns/code_smell_catalog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Smell Catalog
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../08_anti_patterns/azure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Anti-Patterns
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Migration Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Migration Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../10_migration_guides/from_pep8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    From PEP 8
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../10_migration_guides/from_google/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    From Google Style Guide
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../10_migration_guides/from_airbnb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    From Airbnb Style Guide
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cloud Providers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cloud Providers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../11_cloud_providers/azure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Microsoft Azure
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../11_cloud_providers/gcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Google Cloud Platform
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" checked>
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    CI / CD
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    CI / CD
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ai_validation_pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI Validation Pipeline
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog_automation_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog Automation
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../github_actions_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GitHub Actions Guide
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dependency_update_policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dependency Update Policies
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dependabot_auto_merge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dependabot Auto-Merge
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gitlab_ci_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GitLab CI Guide
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jenkins_pipeline_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Jenkins Pipeline Guide
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../precommit_hooks_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pre-commit Hooks Guide
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../local_validation_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Local Validation Setup
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ide_integration_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IDE Integration Guide
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Security Scanning Guide
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Security Scanning Guide
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-tool-security-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-tool Security Strategy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Multi-tool Security Strategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tool-selection-by-category" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tool Selection by Category
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defense-in-depth-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defense in Depth Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tool-integration-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tool Integration Matrix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unified-configuration-schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unified Configuration Schema
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secret-detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Secret Detection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Secret Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detect-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      
        detect-secrets
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trufflehog" class="md-nav__link">
    <span class="md-ellipsis">
      
        TruffleHog
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gitleaks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gitleaks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gitguardian" class="md-nav__link">
    <span class="md-ellipsis">
      
        GitGuardian
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#static-application-security-testing-sast" class="md-nav__link">
    <span class="md-ellipsis">
      
        Static Application Security Testing (SAST)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Static Application Security Testing (SAST)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonarqubesonarcloud" class="md-nav__link">
    <span class="md-ellipsis">
      
        SonarQube/SonarCloud
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#semgrep" class="md-nav__link">
    <span class="md-ellipsis">
      
        Semgrep
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bandit-python" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bandit (Python)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eslint-security-plugins-javascripttypescript" class="md-nav__link">
    <span class="md-ellipsis">
      
        ESLint Security Plugins (JavaScript/TypeScript)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gosec-go" class="md-nav__link">
    <span class="md-ellipsis">
      
        gosec (Go)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sast-tool-selection-by-language" class="md-nav__link">
    <span class="md-ellipsis">
      
        SAST Tool Selection by Language
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SAST Tool Selection by Language">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tool-recommendation-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tool Recommendation Matrix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-language-projects-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-Language Projects Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#language-specific-semgrep-rulesets" class="md-nav__link">
    <span class="md-ellipsis">
      
        Language-Specific Semgrep Rulesets
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#software-composition-analysis-sca" class="md-nav__link">
    <span class="md-ellipsis">
      
        Software Composition Analysis (SCA)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Software Composition Analysis (SCA)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snyk" class="md-nav__link">
    <span class="md-ellipsis">
      
        Snyk
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#owasp-dependency-check" class="md-nav__link">
    <span class="md-ellipsis">
      
        OWASP Dependency-Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#safety-python" class="md-nav__link">
    <span class="md-ellipsis">
      
        Safety (Python)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#container-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Container Security
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Container Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trivy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trivy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grype" class="md-nav__link">
    <span class="md-ellipsis">
      
        Grype
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hadolint-dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hadolint (Dockerfile)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#infrastructure-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Infrastructure Security
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Infrastructure Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checkov" class="md-nav__link">
    <span class="md-ellipsis">
      
        Checkov
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tfsec" class="md-nav__link">
    <span class="md-ellipsis">
      
        tfsec
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terrascan" class="md-nav__link">
    <span class="md-ellipsis">
      
        Terrascan
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamic-application-security-testing-dast" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dynamic Application Security Testing (DAST)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Application Security Testing (DAST)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#owasp-zap" class="md-nav__link">
    <span class="md-ellipsis">
      
        OWASP ZAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nuclei" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nuclei
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#burp-suite" class="md-nav__link">
    <span class="md-ellipsis">
      
        Burp Suite
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compliance-scanning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Compliance Scanning
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Compliance Scanning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openscap" class="md-nav__link">
    <span class="md-ellipsis">
      
        OpenSCAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chef-inspec" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chef InSpec
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cis-benchmarks" class="md-nav__link">
    <span class="md-ellipsis">
      
        CIS Benchmarks
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#policy-as-code-oparego" class="md-nav__link">
    <span class="md-ellipsis">
      
        Policy as Code (OPA/Rego)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Policy as Code (OPA/Rego)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#opa-installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        OPA Installation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rego-policy-basics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rego Policy Basics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes-admission-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        Kubernetes Admission Control
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terraform-policy-enforcement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Terraform Policy Enforcement
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conftest-for-policy-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conftest for Policy Testing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile-policies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dockerfile Policies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#policy-validation-in-cicd" class="md-nav__link">
    <span class="md-ellipsis">
      
        Policy Validation in CI/CD
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gatekeeper-for-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gatekeeper for Kubernetes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#severity-classification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Severity Classification
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Severity Classification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#severity-levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        Severity Levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#severity-classification-by-finding-type" class="md-nav__link">
    <span class="md-ellipsis">
      
        Severity Classification by Finding Type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-severity-assignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automated Severity Assignment
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#false-positive-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        False Positive Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="False Positive Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#false-positive-handling-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        False Positive Handling Workflow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unified-suppression-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unified Suppression Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inline-suppression-standards" class="md-nav__link">
    <span class="md-ellipsis">
      
        Inline Suppression Standards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#false-positive-tracking-script" class="md-nav__link">
    <span class="md-ellipsis">
      
        False Positive Tracking Script
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-gate-policies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Gate Policies
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Gate Policies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gate-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gate Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gate-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gate Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#github-actions-gate-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        GitHub Actions Gate Integration
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remediation-slas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Remediation SLAs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Remediation SLAs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sla-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        SLA Definitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sla-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        SLA Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sla-tracking-script" class="md-nav__link">
    <span class="md-ellipsis">
      
        SLA Tracking Script
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#issue-tracker-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Issue Tracker Integration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Issue Tracker Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jira-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Jira Integration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#github-issues-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        GitHub Issues Integration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cicd-issue-creation" class="md-nav__link">
    <span class="md-ellipsis">
      
        CI/CD Issue Creation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-dashboards" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Dashboards
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Dashboards">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grafana-security-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      
        Grafana Security Dashboard
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prometheus-metrics-exporter" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prometheus Metrics Exporter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defectdojo-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        DefectDojo Integration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consolidated-sarif-reporting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Consolidated SARIF Reporting
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cicd-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        CI/CD Integration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CI/CD Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#github-actions" class="md-nav__link">
    <span class="md-ellipsis">
      
        GitHub Actions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gitlab-ci" class="md-nav__link">
    <span class="md-ellipsis">
      
        GitLab CI
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jenkins" class="md-nav__link">
    <span class="md-ellipsis">
      
        Jenkins
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-policies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Policies
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Policies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#securitytxt" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security.txt
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-disclosure-policy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vulnerability Disclosure Policy
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    <span class="md-ellipsis">
      
        Resources
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Resources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standards-and-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Standards and Guidelines
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secret-detection-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Secret Detection Tools
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sast-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        SAST Tools
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dast-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        DAST Tools
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependency-scanning-sca" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dependency Scanning (SCA)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#container-and-infrastructure-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Container and Infrastructure Security
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#policy-as-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Policy as Code
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-and-benchmarks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Compliance and Benchmarks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-dashboards-and-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Dashboards and Management
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code_signing_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Signing Guide
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing_strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Strategies
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smoke_test_standards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Smoke Test Standards
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../performance_testing_standards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Performance Testing
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chaos_engineering_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chaos Engineering
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../seed_data_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Seed Data Management
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../environment_configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Environment Configuration
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observability Guide
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../iac_testing_standards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IaC Testing Standards
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../06_container/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Container Usage
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Integration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            
  
    Integration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../07_integration/integration_prompt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Integration Guide
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../07_integration/ai_code_review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI Code Review
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../07_integration/cli_tool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Tool
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Glossary
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-tool-security-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-tool Security Strategy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Multi-tool Security Strategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tool-selection-by-category" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tool Selection by Category
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defense-in-depth-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defense in Depth Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tool-integration-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tool Integration Matrix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unified-configuration-schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unified Configuration Schema
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secret-detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Secret Detection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Secret Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detect-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      
        detect-secrets
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trufflehog" class="md-nav__link">
    <span class="md-ellipsis">
      
        TruffleHog
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gitleaks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gitleaks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gitguardian" class="md-nav__link">
    <span class="md-ellipsis">
      
        GitGuardian
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#static-application-security-testing-sast" class="md-nav__link">
    <span class="md-ellipsis">
      
        Static Application Security Testing (SAST)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Static Application Security Testing (SAST)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonarqubesonarcloud" class="md-nav__link">
    <span class="md-ellipsis">
      
        SonarQube/SonarCloud
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#semgrep" class="md-nav__link">
    <span class="md-ellipsis">
      
        Semgrep
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bandit-python" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bandit (Python)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eslint-security-plugins-javascripttypescript" class="md-nav__link">
    <span class="md-ellipsis">
      
        ESLint Security Plugins (JavaScript/TypeScript)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gosec-go" class="md-nav__link">
    <span class="md-ellipsis">
      
        gosec (Go)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sast-tool-selection-by-language" class="md-nav__link">
    <span class="md-ellipsis">
      
        SAST Tool Selection by Language
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SAST Tool Selection by Language">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tool-recommendation-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tool Recommendation Matrix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-language-projects-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-Language Projects Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#language-specific-semgrep-rulesets" class="md-nav__link">
    <span class="md-ellipsis">
      
        Language-Specific Semgrep Rulesets
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#software-composition-analysis-sca" class="md-nav__link">
    <span class="md-ellipsis">
      
        Software Composition Analysis (SCA)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Software Composition Analysis (SCA)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snyk" class="md-nav__link">
    <span class="md-ellipsis">
      
        Snyk
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#owasp-dependency-check" class="md-nav__link">
    <span class="md-ellipsis">
      
        OWASP Dependency-Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#safety-python" class="md-nav__link">
    <span class="md-ellipsis">
      
        Safety (Python)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#container-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Container Security
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Container Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trivy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trivy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grype" class="md-nav__link">
    <span class="md-ellipsis">
      
        Grype
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hadolint-dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hadolint (Dockerfile)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#infrastructure-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Infrastructure Security
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Infrastructure Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checkov" class="md-nav__link">
    <span class="md-ellipsis">
      
        Checkov
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tfsec" class="md-nav__link">
    <span class="md-ellipsis">
      
        tfsec
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terrascan" class="md-nav__link">
    <span class="md-ellipsis">
      
        Terrascan
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamic-application-security-testing-dast" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dynamic Application Security Testing (DAST)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Application Security Testing (DAST)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#owasp-zap" class="md-nav__link">
    <span class="md-ellipsis">
      
        OWASP ZAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nuclei" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nuclei
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#burp-suite" class="md-nav__link">
    <span class="md-ellipsis">
      
        Burp Suite
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compliance-scanning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Compliance Scanning
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Compliance Scanning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openscap" class="md-nav__link">
    <span class="md-ellipsis">
      
        OpenSCAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chef-inspec" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chef InSpec
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cis-benchmarks" class="md-nav__link">
    <span class="md-ellipsis">
      
        CIS Benchmarks
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#policy-as-code-oparego" class="md-nav__link">
    <span class="md-ellipsis">
      
        Policy as Code (OPA/Rego)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Policy as Code (OPA/Rego)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#opa-installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        OPA Installation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rego-policy-basics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rego Policy Basics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes-admission-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        Kubernetes Admission Control
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terraform-policy-enforcement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Terraform Policy Enforcement
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conftest-for-policy-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conftest for Policy Testing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile-policies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dockerfile Policies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#policy-validation-in-cicd" class="md-nav__link">
    <span class="md-ellipsis">
      
        Policy Validation in CI/CD
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gatekeeper-for-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gatekeeper for Kubernetes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#severity-classification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Severity Classification
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Severity Classification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#severity-levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        Severity Levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#severity-classification-by-finding-type" class="md-nav__link">
    <span class="md-ellipsis">
      
        Severity Classification by Finding Type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-severity-assignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automated Severity Assignment
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#false-positive-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        False Positive Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="False Positive Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#false-positive-handling-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        False Positive Handling Workflow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unified-suppression-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unified Suppression Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inline-suppression-standards" class="md-nav__link">
    <span class="md-ellipsis">
      
        Inline Suppression Standards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#false-positive-tracking-script" class="md-nav__link">
    <span class="md-ellipsis">
      
        False Positive Tracking Script
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-gate-policies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Gate Policies
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Gate Policies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gate-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gate Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gate-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gate Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#github-actions-gate-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        GitHub Actions Gate Integration
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remediation-slas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Remediation SLAs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Remediation SLAs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sla-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        SLA Definitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sla-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        SLA Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sla-tracking-script" class="md-nav__link">
    <span class="md-ellipsis">
      
        SLA Tracking Script
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#issue-tracker-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Issue Tracker Integration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Issue Tracker Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jira-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Jira Integration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#github-issues-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        GitHub Issues Integration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cicd-issue-creation" class="md-nav__link">
    <span class="md-ellipsis">
      
        CI/CD Issue Creation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-dashboards" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Dashboards
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Dashboards">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grafana-security-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      
        Grafana Security Dashboard
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prometheus-metrics-exporter" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prometheus Metrics Exporter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defectdojo-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        DefectDojo Integration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consolidated-sarif-reporting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Consolidated SARIF Reporting
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cicd-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        CI/CD Integration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CI/CD Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#github-actions" class="md-nav__link">
    <span class="md-ellipsis">
      
        GitHub Actions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gitlab-ci" class="md-nav__link">
    <span class="md-ellipsis">
      
        GitLab CI
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jenkins" class="md-nav__link">
    <span class="md-ellipsis">
      
        Jenkins
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-policies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Policies
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Policies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#securitytxt" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security.txt
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-disclosure-policy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vulnerability Disclosure Policy
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    <span class="md-ellipsis">
      
        Resources
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Resources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standards-and-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Standards and Guidelines
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secret-detection-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Secret Detection Tools
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sast-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        SAST Tools
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dast-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        DAST Tools
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependency-scanning-sca" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dependency Scanning (SCA)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#container-and-infrastructure-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Container and Infrastructure Security
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#policy-as-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Policy as Code
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-and-benchmarks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Compliance and Benchmarks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-dashboards-and-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Dashboards and Management
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Security Scanning Guide</h1>

<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>This guide provides comprehensive coverage of security scanning tools and practices for DevSecOps pipelines.
It covers static analysis (SAST), dynamic analysis (DAST), software composition analysis (SCA), secret detection,
container scanning, infrastructure scanning, and compliance validation.</p>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#multi-tool-security-strategy">Multi-tool Security Strategy</a></li>
<li><a href="#secret-detection">Secret Detection</a></li>
<li><a href="#static-application-security-testing-sast">Static Application Security Testing (SAST)</a></li>
<li><a href="#sast-tool-selection-by-language">SAST Tool Selection by Language</a></li>
<li><a href="#software-composition-analysis-sca">Software Composition Analysis (SCA)</a></li>
<li><a href="#container-security">Container Security</a></li>
<li><a href="#infrastructure-security">Infrastructure Security</a></li>
<li><a href="#dynamic-application-security-testing-dast">Dynamic Application Security Testing (DAST)</a></li>
<li><a href="#compliance-scanning">Compliance Scanning</a></li>
<li><a href="#policy-as-code-oparego">Policy as Code (OPA/Rego)</a></li>
<li><a href="#severity-classification">Severity Classification</a></li>
<li><a href="#false-positive-management">False Positive Management</a></li>
<li><a href="#security-gate-policies">Security Gate Policies</a></li>
<li><a href="#remediation-slas">Remediation SLAs</a></li>
<li><a href="#issue-tracker-integration">Issue Tracker Integration</a></li>
<li><a href="#security-dashboards">Security Dashboards</a></li>
<li><a href="#cicd-integration">CI/CD Integration</a></li>
<li><a href="#security-policies">Security Policies</a></li>
</ol>
<hr />
<h2 id="multi-tool-security-strategy">Multi-tool Security Strategy<a class="headerlink" href="#multi-tool-security-strategy" title="Permanent link">&para;</a></h2>
<p>Effective security scanning requires a layered approach with specialized tools for each
security domain. This section provides guidance on tool selection and integration strategies.</p>
<h3 id="tool-selection-by-category">Tool Selection by Category<a class="headerlink" href="#tool-selection-by-category" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>
                          Security Scanning Tool Categories                              

 Category               Primary Tool     Secondary Tool   CI/CD Integration          

 Secret Detection       TruffleHog       GitGuardian      Pre-commit + PR gates      
 SAST                   Semgrep          SonarQube        PR checks + quality gates  
 Dependency (SCA)       Snyk             Dependabot       PR + scheduled scans       
 Container              Trivy            Grype (Anchore)  Build pipeline + registry  
 IaC                    Checkov          tfsec            PR + plan stage            
 DAST                   OWASP ZAP        Nuclei           Post-deployment            
 Compliance             InSpec           OpenSCAP         Scheduled + audit          
 Policy                 OPA              Conftest         Admission control + CI     

</code></pre></div>
<h3 id="defense-in-depth-strategy">Defense in Depth Strategy<a class="headerlink" href="#defense-in-depth-strategy" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># security-strategy.yml</span>
<span class="nt">defense_in_depth</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Layer 1: Developer Workstation</span>
<span class="w">  </span><span class="nt">local</span><span class="p">:</span>
<span class="w">    </span><span class="nt">pre_commit</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">detect-secrets</span><span class="w">  </span><span class="c1"># Secrets baseline</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gitleaks</span><span class="w">        </span><span class="c1"># Git history scan</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">semgrep</span><span class="w">         </span><span class="c1"># Quick SAST rules</span>
<span class="w">    </span><span class="nt">ide_integration</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">snyk</span><span class="w">            </span><span class="c1"># Real-time dependency alerts</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sonarLint</span><span class="w">       </span><span class="c1"># Code quality feedback</span>

<span class="w">  </span><span class="c1"># Layer 2: Pull Request Gates</span>
<span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<span class="w">    </span><span class="nt">blocking</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secret_detection</span><span class="w">   </span><span class="c1"># Zero tolerance for secrets</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">critical_sast</span><span class="w">      </span><span class="c1"># Critical vulnerabilities only</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dependency_critical</span><span class="w"> </span><span class="c1"># Known exploited vulnerabilities</span>
<span class="w">    </span><span class="nt">non_blocking</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">full_sast</span><span class="w">          </span><span class="c1"># All severity levels</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">container_scan</span><span class="w">     </span><span class="c1"># Image vulnerabilities</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iac_scan</span><span class="w">           </span><span class="c1"># Infrastructure misconfigurations</span>

<span class="w">  </span><span class="c1"># Layer 3: Main Branch Protection</span>
<span class="w">  </span><span class="nt">main_branch</span><span class="p">:</span>
<span class="w">    </span><span class="nt">blocking</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all_sast_high</span><span class="w">      </span><span class="c1"># High+ severity</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dependency_high</span><span class="w">    </span><span class="c1"># High+ CVEs</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">container_high</span><span class="w">     </span><span class="c1"># High+ container vulns</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iac_high</span><span class="w">           </span><span class="c1"># High+ misconfigurations</span>
<span class="w">    </span><span class="nt">reporting</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">full_compliance</span><span class="w">    </span><span class="c1"># Compliance baseline</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sbom_generation</span><span class="w">    </span><span class="c1"># Software bill of materials</span>

<span class="w">  </span><span class="c1"># Layer 4: Pre-Release Gates</span>
<span class="w">  </span><span class="nt">release</span><span class="p">:</span>
<span class="w">    </span><span class="nt">blocking</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">penetration_test</span><span class="w">   </span><span class="c1"># Manual or automated pentest</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dast_scan</span><span class="w">          </span><span class="c1"># Dynamic analysis</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compliance_audit</span><span class="w">   </span><span class="c1"># Full compliance check</span>
<span class="w">    </span><span class="nt">attestation</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sbom_signed</span><span class="w">        </span><span class="c1"># Signed SBOM</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vulnerability_attestation</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compliance_attestation</span>

<span class="w">  </span><span class="c1"># Layer 5: Runtime Protection</span>
<span class="w">  </span><span class="nt">runtime</span><span class="p">:</span>
<span class="w">    </span><span class="nt">continuous</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">container_registry_scan</span><span class="w">  </span><span class="c1"># Scheduled image scans</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dependency_monitoring</span><span class="w">    </span><span class="c1"># CVE feed monitoring</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runtime_protection</span><span class="w">       </span><span class="c1"># RASP/WAF</span>
<span class="w">    </span><span class="nt">alerting</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">new_cve_notification</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compliance_drift</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">anomaly_detection</span>
</code></pre></div>
<h3 id="tool-integration-matrix">Tool Integration Matrix<a class="headerlink" href="#tool-integration-matrix" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;Security tool integration configuration generator.&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ScanPhase</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;CI/CD pipeline phases for security scanning.&quot;&quot;&quot;</span>

    <span class="n">PRE_COMMIT</span> <span class="o">=</span> <span class="s2">&quot;pre_commit&quot;</span>
    <span class="n">PULL_REQUEST</span> <span class="o">=</span> <span class="s2">&quot;pull_request&quot;</span>
    <span class="n">MAIN_BRANCH</span> <span class="o">=</span> <span class="s2">&quot;main_branch&quot;</span>
    <span class="n">RELEASE</span> <span class="o">=</span> <span class="s2">&quot;release&quot;</span>
    <span class="n">RUNTIME</span> <span class="o">=</span> <span class="s2">&quot;runtime&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ToolCategory</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Security tool categories.&quot;&quot;&quot;</span>

    <span class="n">SECRETS</span> <span class="o">=</span> <span class="s2">&quot;secrets&quot;</span>
    <span class="n">SAST</span> <span class="o">=</span> <span class="s2">&quot;sast&quot;</span>
    <span class="n">SCA</span> <span class="o">=</span> <span class="s2">&quot;sca&quot;</span>
    <span class="n">CONTAINER</span> <span class="o">=</span> <span class="s2">&quot;container&quot;</span>
    <span class="n">IAC</span> <span class="o">=</span> <span class="s2">&quot;iac&quot;</span>
    <span class="n">DAST</span> <span class="o">=</span> <span class="s2">&quot;dast&quot;</span>
    <span class="n">COMPLIANCE</span> <span class="o">=</span> <span class="s2">&quot;compliance&quot;</span>
    <span class="n">POLICY</span> <span class="o">=</span> <span class="s2">&quot;policy&quot;</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityTool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Security tool configuration.&quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">category</span><span class="p">:</span> <span class="n">ToolCategory</span>
    <span class="n">phases</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ScanPhase</span><span class="p">]</span>
    <span class="n">blocking</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">severity_threshold</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">timeout_minutes</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">config_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">SECURITY_TOOLS</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">SecurityTool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">SecurityTool</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;trufflehog&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="n">ToolCategory</span><span class="o">.</span><span class="n">SECRETS</span><span class="p">,</span>
        <span class="n">phases</span><span class="o">=</span><span class="p">[</span><span class="n">ScanPhase</span><span class="o">.</span><span class="n">PRE_COMMIT</span><span class="p">,</span> <span class="n">ScanPhase</span><span class="o">.</span><span class="n">PULL_REQUEST</span><span class="p">],</span>
        <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">severity_threshold</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">,</span>
        <span class="n">timeout_minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">config_file</span><span class="o">=</span><span class="s2">&quot;.trufflehog-exclude.txt&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">SecurityTool</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;gitguardian&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="n">ToolCategory</span><span class="o">.</span><span class="n">SECRETS</span><span class="p">,</span>
        <span class="n">phases</span><span class="o">=</span><span class="p">[</span><span class="n">ScanPhase</span><span class="o">.</span><span class="n">PULL_REQUEST</span><span class="p">,</span> <span class="n">ScanPhase</span><span class="o">.</span><span class="n">MAIN_BRANCH</span><span class="p">],</span>
        <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">severity_threshold</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">,</span>
        <span class="n">timeout_minutes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">config_file</span><span class="o">=</span><span class="s2">&quot;.gitguardian.yml&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">SecurityTool</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;semgrep&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="n">ToolCategory</span><span class="o">.</span><span class="n">SAST</span><span class="p">,</span>
        <span class="n">phases</span><span class="o">=</span><span class="p">[</span><span class="n">ScanPhase</span><span class="o">.</span><span class="n">PRE_COMMIT</span><span class="p">,</span> <span class="n">ScanPhase</span><span class="o">.</span><span class="n">PULL_REQUEST</span><span class="p">,</span> <span class="n">ScanPhase</span><span class="o">.</span><span class="n">MAIN_BRANCH</span><span class="p">],</span>
        <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">severity_threshold</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">timeout_minutes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">config_file</span><span class="o">=</span><span class="s2">&quot;.semgrep.yml&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">SecurityTool</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sonarqube&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="n">ToolCategory</span><span class="o">.</span><span class="n">SAST</span><span class="p">,</span>
        <span class="n">phases</span><span class="o">=</span><span class="p">[</span><span class="n">ScanPhase</span><span class="o">.</span><span class="n">PULL_REQUEST</span><span class="p">,</span> <span class="n">ScanPhase</span><span class="o">.</span><span class="n">MAIN_BRANCH</span><span class="p">],</span>
        <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">severity_threshold</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">timeout_minutes</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="n">config_file</span><span class="o">=</span><span class="s2">&quot;sonar-project.properties&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">SecurityTool</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;snyk&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="n">ToolCategory</span><span class="o">.</span><span class="n">SCA</span><span class="p">,</span>
        <span class="n">phases</span><span class="o">=</span><span class="p">[</span><span class="n">ScanPhase</span><span class="o">.</span><span class="n">PULL_REQUEST</span><span class="p">,</span> <span class="n">ScanPhase</span><span class="o">.</span><span class="n">MAIN_BRANCH</span><span class="p">,</span> <span class="n">ScanPhase</span><span class="o">.</span><span class="n">RUNTIME</span><span class="p">],</span>
        <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">severity_threshold</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">timeout_minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">config_file</span><span class="o">=</span><span class="s2">&quot;.snyk&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">SecurityTool</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;trivy&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="n">ToolCategory</span><span class="o">.</span><span class="n">CONTAINER</span><span class="p">,</span>
        <span class="n">phases</span><span class="o">=</span><span class="p">[</span><span class="n">ScanPhase</span><span class="o">.</span><span class="n">PULL_REQUEST</span><span class="p">,</span> <span class="n">ScanPhase</span><span class="o">.</span><span class="n">MAIN_BRANCH</span><span class="p">,</span> <span class="n">ScanPhase</span><span class="o">.</span><span class="n">RELEASE</span><span class="p">],</span>
        <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">severity_threshold</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
        <span class="n">timeout_minutes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">config_file</span><span class="o">=</span><span class="s2">&quot;trivy.yaml&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">SecurityTool</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;checkov&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="n">ToolCategory</span><span class="o">.</span><span class="n">IAC</span><span class="p">,</span>
        <span class="n">phases</span><span class="o">=</span><span class="p">[</span><span class="n">ScanPhase</span><span class="o">.</span><span class="n">PULL_REQUEST</span><span class="p">,</span> <span class="n">ScanPhase</span><span class="o">.</span><span class="n">MAIN_BRANCH</span><span class="p">],</span>
        <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">severity_threshold</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">timeout_minutes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">config_file</span><span class="o">=</span><span class="s2">&quot;.checkov.yaml&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">SecurityTool</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;zap&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="n">ToolCategory</span><span class="o">.</span><span class="n">DAST</span><span class="p">,</span>
        <span class="n">phases</span><span class="o">=</span><span class="p">[</span><span class="n">ScanPhase</span><span class="o">.</span><span class="n">RELEASE</span><span class="p">,</span> <span class="n">ScanPhase</span><span class="o">.</span><span class="n">RUNTIME</span><span class="p">],</span>
        <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">severity_threshold</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="n">timeout_minutes</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
        <span class="n">config_file</span><span class="o">=</span><span class="s2">&quot;zap-config.yml&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">SecurityTool</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;opa&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="n">ToolCategory</span><span class="o">.</span><span class="n">POLICY</span><span class="p">,</span>
        <span class="n">phases</span><span class="o">=</span><span class="p">[</span><span class="n">ScanPhase</span><span class="o">.</span><span class="n">PULL_REQUEST</span><span class="p">,</span> <span class="n">ScanPhase</span><span class="o">.</span><span class="n">MAIN_BRANCH</span><span class="p">,</span> <span class="n">ScanPhase</span><span class="o">.</span><span class="n">RUNTIME</span><span class="p">],</span>
        <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">severity_threshold</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">,</span>
        <span class="n">timeout_minutes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">config_file</span><span class="o">=</span><span class="s2">&quot;policy/&quot;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_tools_for_phase</span><span class="p">(</span><span class="n">phase</span><span class="p">:</span> <span class="n">ScanPhase</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">SecurityTool</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all security tools configured for a specific phase.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">tool</span> <span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="n">SECURITY_TOOLS</span> <span class="k">if</span> <span class="n">phase</span> <span class="ow">in</span> <span class="n">tool</span><span class="o">.</span><span class="n">phases</span><span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">generate_ci_config</span><span class="p">(</span><span class="n">phase</span><span class="p">:</span> <span class="n">ScanPhase</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate CI configuration for a specific phase.&quot;&quot;&quot;</span>
    <span class="n">tools</span> <span class="o">=</span> <span class="n">get_tools_for_phase</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;phase&quot;</span><span class="p">:</span> <span class="n">phase</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">tool</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="n">tool</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="s2">&quot;blocking&quot;</span><span class="p">:</span> <span class="n">tool</span><span class="o">.</span><span class="n">blocking</span><span class="p">,</span>
                <span class="s2">&quot;severity_threshold&quot;</span><span class="p">:</span> <span class="n">tool</span><span class="o">.</span><span class="n">severity_threshold</span><span class="p">,</span>
                <span class="s2">&quot;timeout_minutes&quot;</span><span class="p">:</span> <span class="n">tool</span><span class="o">.</span><span class="n">timeout_minutes</span><span class="p">,</span>
                <span class="s2">&quot;config_file&quot;</span><span class="p">:</span> <span class="n">tool</span><span class="o">.</span><span class="n">config_file</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="n">tools</span>
        <span class="p">],</span>
    <span class="p">}</span>
</code></pre></div>
<h3 id="unified-configuration-schema">Unified Configuration Schema<a class="headerlink" href="#unified-configuration-schema" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .security-scanning.yml - Unified security scanning configuration</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span>

<span class="nt">global</span><span class="p">:</span>
<span class="w">  </span><span class="nt">fail_on_error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">report_format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sarif</span>
<span class="w">  </span><span class="nt">upload_results</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">notification</span><span class="p">:</span>
<span class="w">    </span><span class="nt">slack_channel</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;#security-alerts&quot;</span>
<span class="w">    </span><span class="nt">email</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security@example.com</span>

<span class="nt">tools</span><span class="p">:</span>
<span class="w">  </span><span class="nt">secrets</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trufflehog</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.trufflehog-exclude.txt</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gitguardian</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.gitguardian.yml</span>
<span class="w">    </span><span class="nt">blocking</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">phases</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">pre_commit</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">pull_request</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">sast</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">semgrep</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.semgrep.yml</span>
<span class="w">        </span><span class="nt">rulesets</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">p/security-audit</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">p/owasp-top-ten</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sonarqube</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sonar-project.properties</span>
<span class="w">    </span><span class="nt">severity_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">high</span>
<span class="w">    </span><span class="nt">blocking</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">phases</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">pull_request</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">main_branch</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">sca</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">snyk</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.snyk</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dependabot</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.github/dependabot.yml</span>
<span class="w">    </span><span class="nt">severity_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">high</span>
<span class="w">    </span><span class="nt">blocking</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">phases</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">pull_request</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">main_branch</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">runtime</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">container</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trivy</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trivy.yaml</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">grype</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.grype.yaml</span>
<span class="w">    </span><span class="nt">severity_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">critical</span>
<span class="w">    </span><span class="nt">blocking</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">phases</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">pull_request</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">release</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">iac</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">checkov</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.checkov.yaml</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tfsec</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tfsec.json</span>
<span class="w">    </span><span class="nt">severity_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">high</span>
<span class="w">    </span><span class="nt">blocking</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">phases</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">pull_request</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">main_branch</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">dast</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zap</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zap-config.yml</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nuclei</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nuclei-config.yml</span>
<span class="w">    </span><span class="nt">severity_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">high</span>
<span class="w">    </span><span class="nt">blocking</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">phases</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">release</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">runtime</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">compliance</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inspec</span>
<span class="w">        </span><span class="nt">profiles</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cis-benchmark</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pci-dss</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openscap</span>
<span class="w">        </span><span class="nt">profiles</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xccdf_org.ssgproject.content_profile_pci-dss</span>
<span class="w">    </span><span class="nt">phases</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">release</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">scheduled</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">policy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">opa</span>
<span class="w">        </span><span class="nt">policy_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">policy/</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conftest</span>
<span class="w">        </span><span class="nt">policy_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">policy/</span>
<span class="w">    </span><span class="nt">blocking</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">phases</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">pull_request</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">main_branch</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">runtime</span><span class="p p-Indicator">]</span>

<span class="nt">reporting</span><span class="p">:</span>
<span class="w">  </span><span class="nt">consolidate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">formats</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sarif</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">html</span>
<span class="w">  </span><span class="nt">retention_days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">90</span>
<span class="w">  </span><span class="nt">dashboard</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">grafana</span>
</code></pre></div>
<hr />
<h2 id="secret-detection">Secret Detection<a class="headerlink" href="#secret-detection" title="Permanent link">&para;</a></h2>
<h3 id="detect-secrets">detect-secrets<a class="headerlink" href="#detect-secrets" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Using pipx</span>
pipx<span class="w"> </span>install<span class="w"> </span>detect-secrets

<span class="c1">## Verify</span>
detect-secrets<span class="w"> </span>--version
</code></pre></div>
<p><strong>Initialize baseline</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Scan current repository</span>
detect-secrets<span class="w"> </span>scan<span class="w"> </span>&gt;<span class="w"> </span>.secrets.baseline

<span class="c1">## Audit findings</span>
detect-secrets<span class="w"> </span>audit<span class="w"> </span>.secrets.baseline

<span class="c1">## Update baseline</span>
detect-secrets<span class="w"> </span>scan<span class="w"> </span>--baseline<span class="w"> </span>.secrets.baseline
</code></pre></div>
<p><strong>.secrets.baseline</strong> configuration:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.4.0&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;filters_used&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;detect_secrets.filters.allowlist.is_line_allowlisted&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;detect_secrets.filters.common.is_ignored_due_to_verification_policies&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;min_level&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;detect_secrets.filters.heuristic.is_indirect_reference&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;detect_secrets.filters.heuristic.is_likely_id_string&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;detect_secrets.filters.heuristic.is_potential_uuid&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;results&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span>
<span class="w">  </span><span class="nt">&quot;generated_at&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-12-01T10:00:00Z&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Pre-commit integration</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">repos</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/Yelp/detect-secrets</span>
<span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.4.0</span>
<span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">detect-secrets</span>
<span class="w">        </span><span class="nt">args</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;--baseline&#39;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;.secrets.baseline&#39;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;--exclude-files&#39;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;\.lock$&#39;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;--exclude-files&#39;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;package-lock\.json$&#39;</span>
</code></pre></div>
<h3 id="trufflehog">TruffleHog<a class="headerlink" href="#trufflehog" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## macOS</span>
brew<span class="w"> </span>install<span class="w"> </span>trufflesecurity/trufflehog/trufflehog

<span class="c1">## Linux</span>
curl<span class="w"> </span>-sSfL<span class="w"> </span>https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>sh<span class="w"> </span>-s<span class="w"> </span>--<span class="w"> </span>-b<span class="w"> </span>/usr/local/bin

<span class="c1">## Verify</span>
trufflehog<span class="w"> </span>--version
</code></pre></div>
<p><strong>Scan filesystem</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Scan current directory</span>
trufflehog<span class="w"> </span>filesystem<span class="w"> </span>.<span class="w"> </span>--json

<span class="c1">## Scan with exclusions</span>
trufflehog<span class="w"> </span>filesystem<span class="w"> </span>.<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--exclude-paths<span class="w"> </span>.trufflehog-exclude.txt<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--json

<span class="c1">## Scan specific branch</span>
trufflehog<span class="w"> </span>git<span class="w"> </span>file://.<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--branch<span class="w"> </span>main<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--json
</code></pre></div>
<p><strong>.trufflehog-exclude.txt</strong>:</p>
<div class="highlight"><pre><span></span><code>## Dependency directories
node_modules/
.venv/
vendor/

## Build outputs
dist/
build/
*.min.js

## Lock files
package-lock.json
yarn.lock
Pipfile.lock

## Images
*.svg
*.png
*.jpg
</code></pre></div>
<p><strong>CI/CD integration</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## GitHub Actions</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TruffleHog Secret Scan</span>
<span class="w">  </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trufflesecurity/trufflehog@main</span>
<span class="w">  </span><span class="nt">with</span><span class="p">:</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./</span>
<span class="w">    </span><span class="nt">base</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.event.repository.default_branch }}</span>
<span class="w">    </span><span class="nt">head</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HEAD</span>
</code></pre></div>
<h3 id="gitleaks">Gitleaks<a class="headerlink" href="#gitleaks" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## macOS</span>
brew<span class="w"> </span>install<span class="w"> </span>gitleaks

<span class="c1">## Linux</span>
wget<span class="w"> </span>https://github.com/gitleaks/gitleaks/releases/download/v8.18.1/gitleaks_8.18.1_linux_x64.tar.gz
tar<span class="w"> </span>xvzf<span class="w"> </span>gitleaks_8.18.1_linux_x64.tar.gz
sudo<span class="w"> </span>mv<span class="w"> </span>gitleaks<span class="w"> </span>/usr/local/bin/

<span class="c1">## Verify</span>
gitleaks<span class="w"> </span>version
</code></pre></div>
<p><strong>Configuration (.gitleaks.toml)</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Gitleaks Configuration&quot;</span>

<span class="k">[extend]</span>
<span class="n">useDefault</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>

<span class="k">[[rules]]</span>
<span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;generic-api-key&quot;</span>
<span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Generic API Key&quot;</span>
<span class="n">regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;(?i)(api[_-]?key|apikey)[_-]?[:=]\s*[&#39;&quot;]?([a-z0-9]{32,})[&#39;&quot;]?&#39;&#39;&#39;</span>
<span class="n">tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;api&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;key&quot;</span><span class="p">]</span>

<span class="k">[[rules]]</span>
<span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;aws-access-key&quot;</span>
<span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;AWS Access Key ID&quot;</span>
<span class="n">regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}&#39;&#39;&#39;</span>
<span class="n">tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;aws&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;credentials&quot;</span><span class="p">]</span>

<span class="k">[[rules]]</span>
<span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;private-key&quot;</span>
<span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Private Key&quot;</span>
<span class="n">regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;-----BEGIN (RSA|EC|DSA|OPENSSH) PRIV[A]TE KEY-----&#39;&#39;&#39;</span>
<span class="n">tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;private-key&quot;</span><span class="p">]</span>

<span class="k">[allowlist]</span>
<span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Allowlist&quot;</span>
<span class="n">paths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="s1">&#39;&#39;&#39;\.lock$&#39;&#39;&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;&#39;&#39;node_modules/&#39;&#39;&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;&#39;&#39;\.min\.js$&#39;&#39;&#39;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">commits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="c1"># Add commit hashes to ignore</span>
<span class="p">]</span>

<span class="n">regexes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="s1">&#39;&#39;&#39;example\.com&#39;&#39;&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;&#39;&#39;placeholder&#39;&#39;&#39;</span><span class="p">,</span>
<span class="p">]</span>
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Scan entire repository history</span>
gitleaks<span class="w"> </span>detect<span class="w"> </span>--source<span class="w"> </span>.<span class="w"> </span>--verbose

<span class="c1">## Scan specific commit range</span>
gitleaks<span class="w"> </span>detect<span class="w"> </span>--source<span class="w"> </span>.<span class="w"> </span>--log-opts<span class="o">=</span><span class="s2">&quot;HEAD~10..HEAD&quot;</span>

<span class="c1">## Scan uncommitted changes</span>
gitleaks<span class="w"> </span>protect<span class="w"> </span>--staged

<span class="c1">## Generate report</span>
gitleaks<span class="w"> </span>detect<span class="w"> </span>--report-path<span class="w"> </span>gitleaks-report.json<span class="w"> </span>--report-format<span class="w"> </span>json
</code></pre></div>
<h3 id="gitguardian">GitGuardian<a class="headerlink" href="#gitguardian" title="Permanent link">&para;</a></h3>
<p>GitGuardian provides real-time secret detection with policy management and incident response.</p>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Using pip</span>
pip<span class="w"> </span>install<span class="w"> </span>ggshield

<span class="c1">## Using pipx</span>
pipx<span class="w"> </span>install<span class="w"> </span>ggshield

<span class="c1">## Verify</span>
ggshield<span class="w"> </span>--version
</code></pre></div>
<p><strong>Authentication</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Authenticate with GitGuardian</span>
ggshield<span class="w"> </span>auth<span class="w"> </span>login

<span class="c1">## Or use API key</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">GITGUARDIAN_API_KEY</span><span class="o">=</span><span class="s2">&quot;your-api-key&quot;</span>
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Scan current directory</span>
ggshield<span class="w"> </span>secret<span class="w"> </span>scan<span class="w"> </span>path<span class="w"> </span>.

<span class="c1">## Scan specific files</span>
ggshield<span class="w"> </span>secret<span class="w"> </span>scan<span class="w"> </span>path<span class="w"> </span>src/<span class="w"> </span>tests/

<span class="c1">## Scan git history</span>
ggshield<span class="w"> </span>secret<span class="w"> </span>scan<span class="w"> </span>repo<span class="w"> </span>.

<span class="c1">## Scan pre-commit</span>
ggshield<span class="w"> </span>secret<span class="w"> </span>scan<span class="w"> </span>pre-commit

<span class="c1">## Scan CI commit range</span>
ggshield<span class="w"> </span>secret<span class="w"> </span>scan<span class="w"> </span>ci
</code></pre></div>
<p><strong>Configuration (.gitguardian.yml)</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## GitGuardian configuration</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>

<span class="nt">secret</span><span class="p">:</span>
<span class="w">  </span><span class="c1">## Paths to ignore</span>
<span class="w">  </span><span class="nt">ignored_paths</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;**/node_modules/**&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;**/.venv/**&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;**/vendor/**&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;**/*.lock&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;**/package-lock.json&quot;</span>

<span class="w">  </span><span class="c1">## Detectors to ignore</span>
<span class="w">  </span><span class="nt">ignored_detectors</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">generic_high_entropy_secret</span>

<span class="w">  </span><span class="c1">## Match patterns to ignore (allowlist)</span>
<span class="w">  </span><span class="nt">ignored_matches</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example</span><span class="nv"> </span><span class="s">API</span><span class="nv"> </span><span class="s">key</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">documentation&quot;</span>
<span class="w">      </span><span class="nt">match</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;EXAMPLE_API_KEY_12345&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Test</span><span class="nv"> </span><span class="s">credentials&quot;</span>
<span class="w">      </span><span class="nt">match</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test_secret_*&quot;</span>

<span class="w">  </span><span class="c1">## Show secrets in output (for debugging only)</span>
<span class="w">  </span><span class="nt">show_secrets</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="w">  </span><span class="c1">## Exit code on secret found</span>
<span class="w">  </span><span class="nt">exit_zero</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="c1">## Incident management</span>
<span class="nt">incident</span><span class="p">:</span>
<span class="w">  </span><span class="c1">## Auto-assign incidents</span>
<span class="w">  </span><span class="nt">default_assignee</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-team</span>

<span class="w">  </span><span class="c1">## Severity overrides</span>
<span class="w">  </span><span class="nt">severity_overrides</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">detector</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slack_bot_token</span>
<span class="w">      </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">critical</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">detector</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws_iam</span>
<span class="w">      </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">critical</span>
</code></pre></div>
<p><strong>Pre-commit integration</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">repos</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/gitguardian/ggshield</span>
<span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.25.0</span>
<span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ggshield</span>
<span class="w">        </span><span class="nt">language_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python3</span>
<span class="w">        </span><span class="nt">stages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">commit</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p><strong>GitHub Actions integration</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GitGuardian Secret Scan</span>

<span class="nt">on</span><span class="p">:</span>
<span class="w">  </span><span class="nt">push</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">develop</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">]</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">gitguardian</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">fetch-depth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GitGuardian Scan</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GitGuardian/ggshield-action@v1</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">          </span><span class="nt">GITHUB_PUSH_BEFORE_SHA</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.event.before }}</span>
<span class="w">          </span><span class="nt">GITHUB_PUSH_BASE_SHA</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.event.base_ref }}</span>
<span class="w">          </span><span class="nt">GITHUB_PULL_BASE_SHA</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.event.pull_request.base.sha }}</span>
<span class="w">          </span><span class="nt">GITHUB_DEFAULT_BRANCH</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.event.repository.default_branch }}</span>
<span class="w">          </span><span class="nt">GITGUARDIAN_API_KEY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.GITGUARDIAN_API_KEY }}</span>
</code></pre></div>
<p><strong>Incident response workflow</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;GitGuardian incident response automation.&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecretIncident</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a GitGuardian incident.&quot;&quot;&quot;</span>

    <span class="n">incident_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">detector_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">commit_sha</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">author_email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">status</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">detected_at</span><span class="p">:</span> <span class="n">datetime</span>


<span class="k">class</span><span class="w"> </span><span class="nc">GitGuardianClient</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Client for GitGuardian API.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">api_key</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GITGUARDIAN_API_KEY&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://api.gitguardian.com/v1&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Token </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_incidents</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;triggered&quot;</span><span class="p">,</span> <span class="n">severity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">SecretIncident</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch incidents from GitGuardian.&quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">status</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">severity</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;severity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">severity</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/incidents&quot;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

        <span class="n">incidents</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">():</span>
            <span class="n">incidents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">SecretIncident</span><span class="p">(</span>
                    <span class="n">incident_id</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
                    <span class="n">detector_name</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;detector&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
                    <span class="n">file_path</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;occurrences&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;filename&quot;</span><span class="p">],</span>
                    <span class="n">commit_sha</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;occurrences&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;commit_sha&quot;</span><span class="p">],</span>
                    <span class="n">author_email</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;occurrences&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;author_email&quot;</span><span class="p">],</span>
                    <span class="n">severity</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;severity&quot;</span><span class="p">],</span>
                    <span class="n">status</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">],</span>
                    <span class="n">detected_at</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span>
                        <span class="n">item</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="s2">&quot;+00:00&quot;</span><span class="p">)</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">incidents</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resolve_incident</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">resolution</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resolve an incident with given resolution.&quot;&quot;&quot;</span>
        <span class="n">valid_resolutions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;false_positive&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test_credential&quot;</span><span class="p">,</span>
            <span class="s2">&quot;revoked&quot;</span><span class="p">,</span>
            <span class="s2">&quot;will_not_fix&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">resolution</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_resolutions</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid resolution. Must be one of: </span><span class="si">{</span><span class="n">valid_resolutions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/incidents/</span><span class="si">{</span><span class="n">incident_id</span><span class="si">}</span><span class="s2">/resolve&quot;</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
            <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="n">resolution</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_remediation_pr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident</span><span class="p">:</span> <span class="n">SecretIncident</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate remediation instructions for an incident.&quot;&quot;&quot;</span>
        <span class="n">remediation_steps</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;## Secret Detected: </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">detector_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;**File:** `</span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;**Commit:** `</span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">commit_sha</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;**Author:** </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">author_email</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;**Severity:** </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">severity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;### Remediation Steps&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;1. **Revoke the secret immediately**&quot;</span><span class="p">,</span>
            <span class="s2">&quot;   - Rotate credentials in the source system&quot;</span><span class="p">,</span>
            <span class="s2">&quot;   - Update any dependent services&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;2. **Remove from git history**&quot;</span><span class="p">,</span>
            <span class="s2">&quot;   ```bash&quot;</span><span class="p">,</span>
            <span class="s2">&quot;   # Use git-filter-repo to remove sensitive data&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;   git filter-repo --path </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2"> --invert-paths&quot;</span><span class="p">,</span>
            <span class="s2">&quot;   ```&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;3. **Add to .gitignore or use secrets manager**&quot;</span><span class="p">,</span>
            <span class="s2">&quot;   - Use environment variables&quot;</span><span class="p">,</span>
            <span class="s2">&quot;   - Use a secrets manager (Vault, AWS Secrets Manager)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;4. **Force push and notify team**&quot;</span><span class="p">,</span>
            <span class="s2">&quot;   ```bash&quot;</span><span class="p">,</span>
            <span class="s2">&quot;   git push --force-with-lease&quot;</span><span class="p">,</span>
            <span class="s2">&quot;   ```&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">remediation_steps</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process GitGuardian incidents.&quot;&quot;&quot;</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">GitGuardianClient</span><span class="p">()</span>

    <span class="c1">## Get critical incidents</span>
    <span class="n">incidents</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_incidents</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;triggered&quot;</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">incident</span> <span class="ow">in</span> <span class="n">incidents</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing incident: </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">incident_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">create_remediation_pr</span><span class="p">(</span><span class="n">incident</span><span class="p">))</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
<hr />
<h2 id="static-application-security-testing-sast">Static Application Security Testing (SAST)<a class="headerlink" href="#static-application-security-testing-sast" title="Permanent link">&para;</a></h2>
<h3 id="sonarqubesonarcloud">SonarQube/SonarCloud<a class="headerlink" href="#sonarqubesonarcloud" title="Permanent link">&para;</a></h3>
<p><strong>Installation (SonarQube)</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Docker</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>sonarqube<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">9000</span>:9000<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>sonarqube:lts-community

<span class="c1">## Access at http://localhost:9000</span>
<span class="c1">## Default credentials: admin/admin</span>
</code></pre></div>
<p><strong>Scanner installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## macOS</span>
brew<span class="w"> </span>install<span class="w"> </span>sonar-scanner

<span class="c1">## Linux</span>
wget<span class="w"> </span>https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-5.0.1.3006-linux.zip
unzip<span class="w"> </span>sonar-scanner-cli-5.0.1.3006-linux.zip
sudo<span class="w"> </span>mv<span class="w"> </span>sonar-scanner-5.0.1.3006-linux<span class="w"> </span>/opt/sonar-scanner
<span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/opt/sonar-scanner/bin
</code></pre></div>
<p><strong>sonar-project.properties</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="na">sonar.projectKey</span><span class="o">=</span><span class="s">my-project</span>
<span class="na">sonar.projectName</span><span class="o">=</span><span class="s">My Project</span>
<span class="na">sonar.projectVersion</span><span class="o">=</span><span class="s">1.0</span>

<span class="c1">## Source directories</span>
<span class="na">sonar.sources</span><span class="o">=</span><span class="s">src</span>
<span class="na">sonar.tests</span><span class="o">=</span><span class="s">tests</span>

<span class="c1">## Exclude patterns</span>
<span class="na">sonar.exclusions</span><span class="o">=</span><span class="s">**/node_modules/**,**/dist/**,**/*.test.ts</span>

<span class="c1">## Language-specific settings</span>
<span class="na">sonar.python.version</span><span class="o">=</span><span class="s">3.11</span>
<span class="na">sonar.javascript.node.maxspace</span><span class="o">=</span><span class="s">4096</span>

<span class="c1">## Coverage reports</span>
<span class="na">sonar.python.coverage.reportPaths</span><span class="o">=</span><span class="s">coverage.xml</span>
<span class="na">sonar.javascript.lcov.reportPaths</span><span class="o">=</span><span class="s">coverage/lcov.info</span>

<span class="c1">## Quality gate</span>
<span class="na">sonar.qualitygate.wait</span><span class="o">=</span><span class="s">true</span>
</code></pre></div>
<p><strong>Scan execution</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Scan with properties file</span>
sonar-scanner

<span class="c1">## Scan with inline parameters</span>
sonar-scanner<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-Dsonar.projectKey<span class="o">=</span>my-project<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-Dsonar.sources<span class="o">=</span>src<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-Dsonar.host.url<span class="o">=</span>http://localhost:9000<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-Dsonar.login<span class="o">=</span>your-token
</code></pre></div>
<h3 id="semgrep">Semgrep<a class="headerlink" href="#semgrep" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Using pipx</span>
pipx<span class="w"> </span>install<span class="w"> </span>semgrep

<span class="c1">## macOS</span>
brew<span class="w"> </span>install<span class="w"> </span>semgrep

<span class="c1">## Verify</span>
semgrep<span class="w"> </span>--version
</code></pre></div>
<p><strong>Configuration (.semgrep.yml)</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-sql-injection</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Potential SQL injection vulnerability</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>
<span class="w">    </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">cursor.execute(f&quot;...&quot;)</span>
<span class="w">    </span><span class="nt">fix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Use parameterized queries</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">javascript-eval-usage</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">javascript</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">typescript</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Avoid using eval()</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WARNING</span>
<span class="w">    </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eval(...)</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hardcoded-secret</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">javascript</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">typescript</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Potential hardcoded secret</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>
<span class="w">    </span><span class="nt">pattern-either</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password = &quot;...&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api_key = &quot;...&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secret = &quot;...&quot;</span>
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Scan with default rules</span>
semgrep<span class="w"> </span>--config<span class="o">=</span>auto<span class="w"> </span>.

<span class="c1">## Scan with specific rulesets</span>
semgrep<span class="w"> </span>--config<span class="o">=</span>p/security-audit<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--config<span class="o">=</span>p/owasp-top-ten<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--config<span class="o">=</span>p/python<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>.

<span class="c1">## Scan with custom rules</span>
semgrep<span class="w"> </span>--config<span class="o">=</span>.semgrep.yml<span class="w"> </span>.

<span class="c1">## Generate SARIF report</span>
semgrep<span class="w"> </span>--config<span class="o">=</span>auto<span class="w"> </span>--sarif<span class="w"> </span>--output<span class="o">=</span>semgrep.sarif<span class="w"> </span>.
</code></pre></div>
<h3 id="bandit-python">Bandit (Python)<a class="headerlink" href="#bandit-python" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code>pipx<span class="w"> </span>install<span class="w"> </span>bandit
</code></pre></div>
<p><strong>Configuration (.bandit)</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Bandit configuration</span>
<span class="nt">exclude_dirs</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/test</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tests</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/.venv</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/venv</span>

<span class="nt">skips</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B101</span><span class="w">  </span><span class="c1"># assert_used</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B601</span><span class="w">  </span><span class="c1"># paramiko_calls</span>

<span class="nt">tests</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B201</span><span class="w">  </span><span class="c1"># flask_debug_true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B301</span><span class="w">  </span><span class="c1"># pickle</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B302</span><span class="w">  </span><span class="c1"># marshal</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B303</span><span class="w">  </span><span class="c1"># md5</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B304</span><span class="w">  </span><span class="c1"># insecure_cipher</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B305</span><span class="w">  </span><span class="c1"># insecure_cipher_mode</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B306</span><span class="w">  </span><span class="c1"># insecure_mktemp</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B307</span><span class="w">  </span><span class="c1"># eval</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B308</span><span class="w">  </span><span class="c1"># mark_safe</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B501</span><span class="w">  </span><span class="c1"># request_with_no_cert_validation</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B502</span><span class="w">  </span><span class="c1"># ssl_with_bad_version</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B503</span><span class="w">  </span><span class="c1"># ssl_with_bad_defaults</span>
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Scan directory</span>
bandit<span class="w"> </span>-r<span class="w"> </span>src/

<span class="c1">## Scan with config</span>
bandit<span class="w"> </span>-r<span class="w"> </span>src/<span class="w"> </span>-c<span class="w"> </span>.bandit

<span class="c1">## Generate reports</span>
bandit<span class="w"> </span>-r<span class="w"> </span>src/<span class="w"> </span>-f<span class="w"> </span>json<span class="w"> </span>-o<span class="w"> </span>bandit-report.json
bandit<span class="w"> </span>-r<span class="w"> </span>src/<span class="w"> </span>-f<span class="w"> </span>html<span class="w"> </span>-o<span class="w"> </span>bandit-report.html

<span class="c1">## Only show high severity</span>
bandit<span class="w"> </span>-r<span class="w"> </span>src/<span class="w"> </span>-ll
</code></pre></div>
<h3 id="eslint-security-plugins-javascripttypescript">ESLint Security Plugins (JavaScript/TypeScript)<a class="headerlink" href="#eslint-security-plugins-javascripttypescript" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code>npm<span class="w"> </span>install<span class="w"> </span>--save-dev<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>eslint-plugin-security<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>eslint-plugin-no-secrets<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>eslint-plugin-xss
</code></pre></div>
<p><strong>.eslintrc.json</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;plugins&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;no-secrets&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;xss&quot;</span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;extends&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;plugin:security/recommended&quot;</span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;rules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;security/detect-object-injection&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;security/detect-non-literal-regexp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;warn&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;security/detect-unsafe-regex&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;security/detect-buffer-noassert&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;security/detect-child-process&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;warn&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;security/detect-disable-mustache-escape&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;security/detect-eval-with-expression&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;security/detect-no-csrf-before-method-override&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;security/detect-non-literal-fs-filename&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;warn&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;security/detect-non-literal-require&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;warn&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;security/detect-possible-timing-attacks&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;warn&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;security/detect-pseudoRandomBytes&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;no-secrets/no-secrets&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;xss/no-mixed-html&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="gosec-go">gosec (Go)<a class="headerlink" href="#gosec-go" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Go install</span>
go<span class="w"> </span>install<span class="w"> </span>github.com/securego/gosec/v2/cmd/gosec@latest

<span class="c1">## Verify</span>
gosec<span class="w"> </span>--version
</code></pre></div>
<p><strong>Configuration (.gosec.json)</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;global&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;audit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;nosec&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;showignored&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;rules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;G101&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G102&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G103&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G104&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G106&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G107&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G108&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G109&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G110&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G201&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G202&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G203&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G204&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G301&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G302&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G303&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G304&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G305&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G306&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G307&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G401&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G402&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G403&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G404&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G501&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G502&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G503&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G504&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G505&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;G601&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Scan current directory</span>
gosec<span class="w"> </span>./...

<span class="c1">## Scan with specific rules</span>
gosec<span class="w"> </span>-include<span class="o">=</span>G101,G102,G103<span class="w"> </span>./...

<span class="c1">## Exclude rules</span>
gosec<span class="w"> </span>-exclude<span class="o">=</span>G104<span class="w"> </span>./...

<span class="c1">## Generate reports</span>
gosec<span class="w"> </span>-fmt<span class="o">=</span>json<span class="w"> </span>-out<span class="o">=</span>gosec-report.json<span class="w"> </span>./...
gosec<span class="w"> </span>-fmt<span class="o">=</span>sarif<span class="w"> </span>-out<span class="o">=</span>gosec.sarif<span class="w"> </span>./...
gosec<span class="w"> </span>-fmt<span class="o">=</span>html<span class="w"> </span>-out<span class="o">=</span>gosec-report.html<span class="w"> </span>./...

<span class="c1">## Scan with confidence level</span>
gosec<span class="w"> </span>-confidence<span class="o">=</span>medium<span class="w"> </span>./...

<span class="c1">## Scan with severity level</span>
gosec<span class="w"> </span>-severity<span class="o">=</span>high<span class="w"> </span>./...
</code></pre></div>
<p><strong>gosec rules reference</strong>:</p>
<div class="highlight"><pre><span></span><code>
 Rule   Description                                                   

 G101   Look for hard coded credentials                               
 G102   Bind to all interfaces                                        
 G103   Audit the use of unsafe block                                 
 G104   Audit errors not checked                                      
 G106   Audit the use of ssh.InsecureIgnoreHostKey                    
 G107   Url provided to HTTP request as taint input                   
 G108   Profiling endpoint automatically exposed on /debug/pprof      
 G109   Potential Integer overflow made by strconv.Atoi               
 G110   Potential DoS via decompression bomb                          
 G201   SQL query construction using format string                    
 G202   SQL query construction using string concatenation             
 G203   Use of unescaped data in HTML templates                       
 G204   Audit use of command execution                                
 G301   Poor file permissions used when creating a directory          
 G302   Poor file permissions used with chmod                         
 G303   Creating tempfile using a predictable path                    
 G304   File path provided as taint input                             
 G305   File traversal when extracting zip/tar archive                
 G306   Poor file permissions used when writing to a new file         
 G307   Deferring a method which returns an error                     
 G401   Detect the usage of DES, RC4, MD5 or SHA1                     
 G402   Look for bad TLS connection settings                          
 G403   Ensure minimum RSA key length of 2048 bits                    
 G404   Insecure random number source (rand)                          
 G501   Import blocklist: crypto/md5                                  
 G502   Import blocklist: crypto/des                                  
 G503   Import blocklist: crypto/rc4                                  
 G504   Import blocklist: net/http/cgi                                
 G505   Import blocklist: crypto/sha1                                 
 G601   Implicit memory aliasing of items from a range statement      

</code></pre></div>
<p><strong>Pre-commit integration</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">repos</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/securego/gosec</span>
<span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v2.18.2</span>
<span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gosec</span>
<span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-exclude=G104&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;./...&#39;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p><strong>CI/CD integration</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## GitHub Actions</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run gosec</span>
<span class="w">  </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">securego/gosec@master</span>
<span class="w">  </span><span class="nt">with</span><span class="p">:</span>
<span class="w">    </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;-no-fail</span><span class="nv"> </span><span class="s">-fmt</span><span class="nv"> </span><span class="s">sarif</span><span class="nv"> </span><span class="s">-out</span><span class="nv"> </span><span class="s">gosec.sarif</span><span class="nv"> </span><span class="s">./...&#39;</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload gosec results</span>
<span class="w">  </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">github/codeql-action/upload-sarif@v2</span>
<span class="w">  </span><span class="nt">with</span><span class="p">:</span>
<span class="w">    </span><span class="nt">sarif_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gosec.sarif</span>
</code></pre></div>
<hr />
<h2 id="sast-tool-selection-by-language">SAST Tool Selection by Language<a class="headerlink" href="#sast-tool-selection-by-language" title="Permanent link">&para;</a></h2>
<h3 id="tool-recommendation-matrix">Tool Recommendation Matrix<a class="headerlink" href="#tool-recommendation-matrix" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>
 Language         Recommended Tools (Primary  Secondary)                    

 Python           Bandit  Semgrep  SonarQube                               
 JavaScript/TS    ESLint Security  Semgrep  SonarQube                      
 Go               gosec  Semgrep  SonarQube                                
 Java             SpotBugs + FindSecBugs  Semgrep  SonarQube               
 C/C++            Flawfinder  cppcheck  SonarQube                          
 Ruby             Brakeman  Semgrep  SonarQube                             
 PHP              PHPStan + Psalm  Semgrep  SonarQube                      
 C#/.NET          Security Code Scan  Semgrep  SonarQube                   
 Kotlin           detekt  Semgrep  SonarQube                               
 Swift            SwiftLint  Semgrep                                        
 Rust             cargo-audit  Semgrep                                      
 Terraform        tfsec  Checkov  Terrascan                                
 CloudFormation   cfn-lint  Checkov                                         
 Kubernetes       kubesec  Checkov  Trivy                                  
 Dockerfile       Hadolint  Trivy                                           
 Shell/Bash       ShellCheck  Semgrep                                       
 SQL              sqlfluff  Semgrep                                         

</code></pre></div>
<h3 id="multi-language-projects-configuration">Multi-Language Projects Configuration<a class="headerlink" href="#multi-language-projects-configuration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .security-scan.yml - Unified security scanning configuration</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span>

<span class="nt">languages</span><span class="p">:</span>
<span class="w">  </span><span class="nt">python</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bandit</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.bandit</span>
<span class="w">        </span><span class="nt">severity_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">medium</span>
<span class="w">        </span><span class="nt">fail_on_error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">semgrep</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">p/python</span>
<span class="w">        </span><span class="nt">fail_on_error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">  </span><span class="nt">javascript</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eslint-security</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.eslintrc.json</span>
<span class="w">        </span><span class="nt">fail_on_error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">semgrep</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">p/javascript</span>
<span class="w">        </span><span class="nt">fail_on_error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">  </span><span class="nt">typescript</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eslint-security</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.eslintrc.json</span>
<span class="w">        </span><span class="nt">fail_on_error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">semgrep</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">p/typescript</span>
<span class="w">        </span><span class="nt">fail_on_error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">  </span><span class="nt">go</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gosec</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.gosec.json</span>
<span class="w">        </span><span class="nt">severity_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">medium</span>
<span class="w">        </span><span class="nt">fail_on_error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">semgrep</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">p/golang</span>
<span class="w">        </span><span class="nt">fail_on_error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">  </span><span class="nt">java</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spotbugs</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spotbugs-exclude.xml</span>
<span class="w">        </span><span class="nt">fail_on_error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">semgrep</span>
<span class="w">        </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">p/java</span>
<span class="w">        </span><span class="nt">fail_on_error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="nt">global</span><span class="p">:</span>
<span class="w">  </span><span class="nt">semgrep</span><span class="p">:</span>
<span class="w">    </span><span class="nt">configs</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">p/security-audit</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">p/owasp-top-ten</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">p/secrets</span>
<span class="w">    </span><span class="nt">exclude_paths</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;**/test/**&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;**/tests/**&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;**/vendor/**&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;**/node_modules/**&quot;</span>

<span class="w">  </span><span class="nt">sonarqube</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">quality_gate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SONAR_HOST_URL}</span>
</code></pre></div>
<h3 id="language-specific-semgrep-rulesets">Language-Specific Semgrep Rulesets<a class="headerlink" href="#language-specific-semgrep-rulesets" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .semgrep/rules/python-security.yml</span>
<span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-sql-injection-format-string</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">Potential SQL injection using format string.</span>
<span class="w">      </span><span class="no">Use parameterized queries instead.</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cwe</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CWE-89&quot;</span>
<span class="w">      </span><span class="nt">owasp</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A03:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Injection&quot;</span>
<span class="w">      </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
<span class="w">    </span><span class="nt">patterns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern-either</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cursor.execute(f&quot;...&quot;)</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cursor.execute(&quot;...&quot; % ...)</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cursor.execute(&quot;...&quot; + ...)</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$DB.execute(f&quot;...&quot;)</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$DB.raw(f&quot;...&quot;)</span>
<span class="w">    </span><span class="nt">fix</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">Use parameterized queries: cursor.execute(&quot;SELECT * FROM users WHERE id = %s&quot;, (user_id,))</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-dangerous-deserialization</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">Dangerous deserialization detected. pickle/marshal can execute arbitrary code.</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cwe</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CWE-502&quot;</span>
<span class="w">      </span><span class="nt">owasp</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A08:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Software</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">Data</span><span class="nv"> </span><span class="s">Integrity</span><span class="nv"> </span><span class="s">Failures&quot;</span>
<span class="w">    </span><span class="nt">pattern-either</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pickle.loads(...)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pickle.load(...)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marshal.loads(...)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yaml.load(..., Loader=yaml.Loader)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yaml.load(..., Loader=yaml.UnsafeLoader)</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-command-injection</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">Potential command injection. Use subprocess with shell=False.</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cwe</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CWE-78&quot;</span>
<span class="w">      </span><span class="nt">owasp</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A03:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Injection&quot;</span>
<span class="w">    </span><span class="nt">pattern-either</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">os.system($CMD)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">os.popen($CMD)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subprocess.call($CMD, shell=True, ...)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subprocess.run($CMD, shell=True, ...)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subprocess.Popen($CMD, shell=True, ...)</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-weak-cryptography</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">Weak cryptographic algorithm detected. Use SHA-256 or stronger.</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WARNING</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cwe</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CWE-327&quot;</span>
<span class="w">    </span><span class="nt">pattern-either</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hashlib.md5(...)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hashlib.sha1(...)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Crypto.Hash.MD5.new(...)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Crypto.Hash.SHA.new(...)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># .semgrep/rules/javascript-security.yml</span>
<span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">js-xss-innerhtml</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">javascript</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">typescript</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">Potential XSS via innerHTML. Use textContent or sanitize input.</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cwe</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CWE-79&quot;</span>
<span class="w">      </span><span class="nt">owasp</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A03:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Injection&quot;</span>
<span class="w">    </span><span class="nt">pattern-either</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$EL.innerHTML = $INPUT</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">document.write($INPUT)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">document.writeln($INPUT)</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">js-prototype-pollution</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">javascript</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">typescript</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">Potential prototype pollution vulnerability.</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cwe</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CWE-1321&quot;</span>
<span class="w">    </span><span class="nt">pattern-either</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$OBJ[...][...] = ...</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Object.assign($OBJ, $INPUT)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">_.merge($OBJ, $INPUT)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.extend(true, $OBJ, $INPUT)</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">js-insecure-randomness</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">javascript</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">typescript</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">Math.random() is not cryptographically secure.</span>
<span class="w">      </span><span class="no">Use crypto.randomBytes() or crypto.getRandomValues().</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WARNING</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cwe</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CWE-338&quot;</span>
<span class="w">    </span><span class="nt">patterns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Math.random()</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern-not-inside</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">// nosec</span>
<span class="w">          </span><span class="no">...</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">js-hardcoded-jwt-secret</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">javascript</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">typescript</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">Hardcoded JWT secret detected. Use environment variables.</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cwe</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CWE-798&quot;</span>
<span class="w">    </span><span class="nt">pattern-either</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jwt.sign($PAYLOAD, &quot;...&quot;, ...)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jwt.verify($TOKEN, &quot;...&quot;, ...)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">const secret = &quot;...&quot;</span>
<span class="w">          </span><span class="no">...</span>
<span class="w">          </span><span class="no">jwt.sign($PAYLOAD, secret, ...)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># .semgrep/rules/go-security.yml</span>
<span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">go-sql-injection</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">go</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">Potential SQL injection. Use parameterized queries.</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cwe</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CWE-89&quot;</span>
<span class="w">      </span><span class="nt">owasp</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A03:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Injection&quot;</span>
<span class="w">    </span><span class="nt">pattern-either</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$DB.Query(fmt.Sprintf(...))</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$DB.Exec(fmt.Sprintf(...))</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$DB.QueryRow(fmt.Sprintf(...))</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$DB.Query($QUERY + ...)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$DB.Exec($QUERY + ...)</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">go-path-traversal</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">go</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">Potential path traversal vulnerability. Validate file paths.</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cwe</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CWE-22&quot;</span>
<span class="w">    </span><span class="nt">patterns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern-either</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">os.Open($PATH)</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">os.ReadFile($PATH)</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ioutil.ReadFile($PATH)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern-not-inside</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">if !strings.Contains($PATH, &quot;..&quot;) {</span>
<span class="w">            </span><span class="no">...</span>
<span class="w">          </span><span class="no">}</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">go-ssrf</span>
<span class="w">    </span><span class="nt">languages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">go</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">Potential SSRF vulnerability. Validate and allowlist URLs.</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cwe</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CWE-918&quot;</span>
<span class="w">    </span><span class="nt">patterns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern-either</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http.Get($URL)</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http.Post($URL, ...)</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$CLIENT.Get($URL)</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$CLIENT.Post($URL, ...)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">metavariable-regex</span><span class="p">:</span>
<span class="w">          </span><span class="nt">metavariable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$URL</span>
<span class="w">          </span><span class="nt">regex</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;.*\$.*&#39;</span>
</code></pre></div>
<hr />
<h2 id="software-composition-analysis-sca">Software Composition Analysis (SCA)<a class="headerlink" href="#software-composition-analysis-sca" title="Permanent link">&para;</a></h2>
<h3 id="snyk">Snyk<a class="headerlink" href="#snyk" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## npm</span>
npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>snyk

<span class="c1">## Homebrew</span>
brew<span class="w"> </span>install<span class="w"> </span>snyk

<span class="c1">## Authenticate</span>
snyk<span class="w"> </span>auth

<span class="c1">## Verify</span>
snyk<span class="w"> </span>--version
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Test dependencies</span>
snyk<span class="w"> </span><span class="nb">test</span>

<span class="c1">## Test and monitor</span>
snyk<span class="w"> </span>monitor

<span class="c1">## Test with severity threshold</span>
snyk<span class="w"> </span><span class="nb">test</span><span class="w"> </span>--severity-threshold<span class="o">=</span>high

<span class="c1">## Test Docker image</span>
snyk<span class="w"> </span>container<span class="w"> </span><span class="nb">test</span><span class="w"> </span>myapp:latest

<span class="c1">## Test infrastructure as code</span>
snyk<span class="w"> </span>iac<span class="w"> </span><span class="nb">test</span><span class="w"> </span>terraform/
</code></pre></div>
<p><strong>snyk.json configuration</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;language-settings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;python&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;targetFile&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;requirements.txt&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;exclude&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;global&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="s2">&quot;node_modules/**&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;.venv/**&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;test/**&quot;</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;severity-threshold&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ignore-policy&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.snyk&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>.snyk policy file</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Snyk policy file</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.25.0</span>

<span class="nt">ignore</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Ignore specific vulnerabilities</span>
<span class="w">  </span><span class="nt">SNYK-PYTHON-REQUESTS-12345</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;*&#39;</span><span class="p p-Indicator">:</span>
<span class="w">        </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False positive</span>
<span class="w">        </span><span class="nt">expires</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2025-12-31T00:00:00.000Z</span>

<span class="w">  </span><span class="c1"># Ignore all low severity</span>
<span class="w">  </span><span class="s">&#39;*&#39;</span><span class="p p-Indicator">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;*&#39;</span><span class="p p-Indicator">:</span>
<span class="w">        </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Low severity</span>
<span class="w">        </span><span class="nt">expires</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2025-12-31T00:00:00.000Z</span>
<span class="w">      </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">low</span>

<span class="nt">patch</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div>
<h3 id="owasp-dependency-check">OWASP Dependency-Check<a class="headerlink" href="#owasp-dependency-check" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Download</span>
<span class="nv">VERSION</span><span class="o">=</span><span class="m">9</span>.0.9
wget<span class="w"> </span>https://github.com/jeremylong/DependencyCheck/releases/download/v<span class="si">${</span><span class="nv">VERSION</span><span class="si">}</span>/dependency-check-<span class="si">${</span><span class="nv">VERSION</span><span class="si">}</span>-release.zip
unzip<span class="w"> </span>dependency-check-<span class="si">${</span><span class="nv">VERSION</span><span class="si">}</span>-release.zip
sudo<span class="w"> </span>mv<span class="w"> </span>dependency-check<span class="w"> </span>/opt/
<span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/opt/dependency-check/bin

<span class="c1">## Verify</span>
dependency-check.sh<span class="w"> </span>--version
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Scan project</span>
dependency-check.sh<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--project<span class="w"> </span><span class="s2">&quot;My Project&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--scan<span class="w"> </span>./src<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--out<span class="w"> </span>./reports<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--format<span class="w"> </span>HTML<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--format<span class="w"> </span>JSON

<span class="c1">## Scan with suppression file</span>
dependency-check.sh<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--project<span class="w"> </span><span class="s2">&quot;My Project&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--scan<span class="w"> </span>./src<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--suppression<span class="w"> </span>dependency-check-suppressions.xml<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--out<span class="w"> </span>./reports
</code></pre></div>
<p><strong>dependency-check-suppressions.xml</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;suppressions</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;https://jeremylong.github.io/DependencyCheck/dependency-suppression.1.3.xsd&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;suppress&gt;</span>
<span class="w">    </span><span class="nt">&lt;notes&gt;</span>False<span class="w"> </span>positive<span class="nt">&lt;/notes&gt;</span>
<span class="w">    </span><span class="nt">&lt;cve&gt;</span>CVE-2021-12345<span class="nt">&lt;/cve&gt;</span>
<span class="w">  </span><span class="nt">&lt;/suppress&gt;</span>
<span class="w">  </span><span class="nt">&lt;suppress&gt;</span>
<span class="w">    </span><span class="nt">&lt;notes&gt;</span>Not<span class="w"> </span>applicable<span class="w"> </span>to<span class="w"> </span>our<span class="w"> </span>use<span class="w"> </span>case<span class="nt">&lt;/notes&gt;</span>
<span class="w">    </span><span class="nt">&lt;gav</span><span class="w"> </span><span class="na">regex=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>^org\.example:.*:.*$<span class="nt">&lt;/gav&gt;</span>
<span class="w">    </span><span class="nt">&lt;cpe&gt;</span>cpe:/a:example:library<span class="nt">&lt;/cpe&gt;</span>
<span class="w">  </span><span class="nt">&lt;/suppress&gt;</span>
<span class="nt">&lt;/suppressions&gt;</span>
</code></pre></div>
<h3 id="safety-python">Safety (Python)<a class="headerlink" href="#safety-python" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code>pipx<span class="w"> </span>install<span class="w"> </span>safety
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Check requirements file</span>
safety<span class="w"> </span>check<span class="w"> </span>-r<span class="w"> </span>requirements.txt

<span class="c1">## Check installed packages</span>
safety<span class="w"> </span>check

<span class="c1">## Check with policy file</span>
safety<span class="w"> </span>check<span class="w"> </span>--policy-file<span class="w"> </span>.safety-policy.yml

<span class="c1">## Generate JSON report</span>
safety<span class="w"> </span>check<span class="w"> </span>--json<span class="w"> </span>--output<span class="w"> </span>safety-report.json
</code></pre></div>
<p><strong>.safety-policy.yml</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Safety policy file</span>
<span class="nt">security</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Ignore specific vulnerabilities</span>
<span class="w">  </span><span class="nt">ignore-vulnerabilities</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12345</span>
<span class="w">      </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False positive</span>
<span class="w">      </span><span class="nt">expires</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;2025-12-31&#39;</span>

<span class="w">  </span><span class="c1"># Ignore packages</span>
<span class="w">  </span><span class="nt">ignore-packages</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example-package</span>
<span class="w">      </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1.0.0&#39;</span>
<span class="w">      </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Known issue, waiting for patch</span>

<span class="w">  </span><span class="c1"># Severity threshold</span>
<span class="w">  </span><span class="nt">continue-on-vulnerability-error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div>
<hr />
<h2 id="container-security">Container Security<a class="headerlink" href="#container-security" title="Permanent link">&para;</a></h2>
<h3 id="trivy">Trivy<a class="headerlink" href="#trivy" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## macOS</span>
brew<span class="w"> </span>install<span class="w"> </span>aquasecurity/trivy/trivy

<span class="c1">## Ubuntu/Debian</span>
wget<span class="w"> </span>-qO<span class="w"> </span>-<span class="w"> </span>https://aquasecurity.github.io/trivy-repo/deb/public.key<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>sudo<span class="w"> </span>apt-key<span class="w"> </span>add<span class="w"> </span>-
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb https://aquasecurity.github.io/trivy-repo/deb </span><span class="k">$(</span>lsb_release<span class="w"> </span>-sc<span class="k">)</span><span class="s2"> main&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/apt/sources.list.d/trivy.list
sudo<span class="w"> </span>apt<span class="w"> </span>update
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>trivy

<span class="c1">## Verify</span>
trivy<span class="w"> </span>--version
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Scan Docker image</span>
trivy<span class="w"> </span>image<span class="w"> </span>myapp:latest

<span class="c1">## Scan with severity filter</span>
trivy<span class="w"> </span>image<span class="w"> </span>--severity<span class="w"> </span>HIGH,CRITICAL<span class="w"> </span>myapp:latest

<span class="c1">## Scan filesystem</span>
trivy<span class="w"> </span>fs<span class="w"> </span>.

<span class="c1">## Scan Git repository</span>
trivy<span class="w"> </span>repo<span class="w"> </span>https://github.com/user/repo

<span class="c1">## Generate reports</span>
trivy<span class="w"> </span>image<span class="w"> </span>--format<span class="w"> </span>json<span class="w"> </span>--output<span class="w"> </span>trivy-report.json<span class="w"> </span>myapp:latest
trivy<span class="w"> </span>image<span class="w"> </span>--format<span class="w"> </span>sarif<span class="w"> </span>--output<span class="w"> </span>trivy.sarif<span class="w"> </span>myapp:latest

<span class="c1">## Scan Kubernetes manifests</span>
trivy<span class="w"> </span>k8s<span class="w"> </span>--report<span class="w"> </span>summary<span class="w"> </span>cluster
</code></pre></div>
<p><strong>trivy.yaml configuration</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Trivy configuration</span>
<span class="nt">severity</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CRITICAL</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HIGH</span>

<span class="nt">vulnerability</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">os</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">library</span>

<span class="nt">scan</span><span class="p">:</span>
<span class="w">  </span><span class="nt">skip-dirs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/test</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tests</span>

<span class="nt">exit-code</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</code></pre></div>
<h3 id="grype">Grype<a class="headerlink" href="#grype" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## macOS</span>
brew<span class="w"> </span>install<span class="w"> </span>grype

<span class="c1">## Linux</span>
curl<span class="w"> </span>-sSfL<span class="w"> </span>https://raw.githubusercontent.com/anchore/grype/main/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh<span class="w"> </span>-s<span class="w"> </span>--<span class="w"> </span>-b<span class="w"> </span>/usr/local/bin

<span class="c1">## Verify</span>
grype<span class="w"> </span>version
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Scan image</span>
grype<span class="w"> </span>myapp:latest

<span class="c1">## Scan with output format</span>
grype<span class="w"> </span>myapp:latest<span class="w"> </span>-o<span class="w"> </span>json<span class="w"> </span>&gt;<span class="w"> </span>grype-report.json

<span class="c1">## Scan directory</span>
grype<span class="w"> </span>dir:.

<span class="c1">## Scan with fail on severity</span>
grype<span class="w"> </span>myapp:latest<span class="w"> </span>--fail-on<span class="w"> </span>high
</code></pre></div>
<p><strong>.grype.yaml</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Grype configuration</span>
<span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>

<span class="nt">fail-on-severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">high</span>

<span class="nt">ignore</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">vulnerability</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CVE-2021-12345</span>
<span class="w">    </span><span class="nt">fix-state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wont-fix</span>
<span class="w">    </span><span class="nt">package</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example-package</span>
<span class="w">      </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0.0</span>

<span class="nt">registry</span><span class="p">:</span>
<span class="w">  </span><span class="nt">insecure-skip-tls-verify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">insecure-use-http</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div>
<h3 id="hadolint-dockerfile">Hadolint (Dockerfile)<a class="headerlink" href="#hadolint-dockerfile" title="Permanent link">&para;</a></h3>
<p><strong>Configuration (.hadolint.yaml)</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">ignored</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DL3008</span><span class="w">  </span><span class="c1"># Pin versions in apt-get install</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DL3009</span><span class="w">  </span><span class="c1"># Delete apt-get lists after installing</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DL3018</span><span class="w">  </span><span class="c1"># Pin versions in apk add</span>

<span class="nt">trustedRegistries</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker.io</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcr.io</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ghcr.io</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">quay.io</span>

<span class="nt">failure-threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">warning</span>

<span class="nt">override</span><span class="p">:</span>
<span class="w">  </span><span class="nt">error</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DL3001</span><span class="w">  </span><span class="c1"># HTTPS for registry</span>
<span class="w">  </span><span class="nt">warning</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DL3002</span><span class="w">  </span><span class="c1"># Last USER should not be root</span>
<span class="w">  </span><span class="nt">info</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DL3032</span><span class="w">  </span><span class="c1"># yum clean</span>
</code></pre></div>
<hr />
<h2 id="infrastructure-security">Infrastructure Security<a class="headerlink" href="#infrastructure-security" title="Permanent link">&para;</a></h2>
<h3 id="checkov">Checkov<a class="headerlink" href="#checkov" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code>pipx<span class="w"> </span>install<span class="w"> </span>checkov
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Scan Terraform</span>
checkov<span class="w"> </span>-d<span class="w"> </span>terraform/

<span class="c1">## Scan with specific framework</span>
checkov<span class="w"> </span>--framework<span class="w"> </span>terraform<span class="w"> </span>-d<span class="w"> </span>terraform/

<span class="c1">## Scan CloudFormation</span>
checkov<span class="w"> </span>--framework<span class="w"> </span>cloudformation<span class="w"> </span>-f<span class="w"> </span>template.yaml

<span class="c1">## Scan Kubernetes</span>
checkov<span class="w"> </span>--framework<span class="w"> </span>kubernetes<span class="w"> </span>-f<span class="w"> </span>deployment.yaml

<span class="c1">## Generate reports</span>
checkov<span class="w"> </span>-d<span class="w"> </span>terraform/<span class="w"> </span>--output<span class="w"> </span>json<span class="w"> </span>--output-file<span class="w"> </span>checkov-report.json
checkov<span class="w"> </span>-d<span class="w"> </span>terraform/<span class="w"> </span>--output<span class="w"> </span>sarif<span class="w"> </span>--output-file<span class="w"> </span>checkov.sarif

<span class="c1">## Skip specific checks</span>
checkov<span class="w"> </span>-d<span class="w"> </span>terraform/<span class="w"> </span>--skip-check<span class="w"> </span>CKV_AWS_1,CKV_AWS_2
</code></pre></div>
<p><strong>.checkov.yaml</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Checkov configuration</span>
<span class="nt">framework</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terraform</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cloudformation</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dockerfile</span>

<span class="nt">skip-check</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CKV_AWS_1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CKV_AWS_2</span>

<span class="nt">soft-fail</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cli</span>

<span class="nt">compact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="nt">quiet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="nt">directory</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terraform/</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cloudformation/</span>
</code></pre></div>
<h3 id="tfsec">tfsec<a class="headerlink" href="#tfsec" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## macOS</span>
brew<span class="w"> </span>install<span class="w"> </span>tfsec

<span class="c1">## Linux</span>
wget<span class="w"> </span>https://github.com/aquasecurity/tfsec/releases/download/v1.28.4/tfsec-linux-amd64
chmod<span class="w"> </span>+x<span class="w"> </span>tfsec-linux-amd64
sudo<span class="w"> </span>mv<span class="w"> </span>tfsec-linux-amd64<span class="w"> </span>/usr/local/bin/tfsec

<span class="c1">## Verify</span>
tfsec<span class="w"> </span>--version
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Scan Terraform directory</span>
tfsec<span class="w"> </span>.

<span class="c1">## Scan with severity filter</span>
tfsec<span class="w"> </span>--minimum-severity<span class="w"> </span>HIGH<span class="w"> </span>.

<span class="c1">## Generate reports</span>
tfsec<span class="w"> </span>--format<span class="w"> </span>json<span class="w"> </span>--out<span class="w"> </span>tfsec-report.json<span class="w"> </span>.
tfsec<span class="w"> </span>--format<span class="w"> </span>sarif<span class="w"> </span>--out<span class="w"> </span>tfsec.sarif<span class="w"> </span>.

<span class="c1">## Run specific checks</span>
tfsec<span class="w"> </span>--include-passed<span class="w"> </span>--include-ignored<span class="w"> </span>.
</code></pre></div>
<p><strong>tfsec.json configuration</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;severity_overrides&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;aws-s3-enable-versioning&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HIGH&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;exclude&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;aws-vpc-no-public-ingress-sgr&quot;</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;minimum_severity&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MEDIUM&quot;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="terrascan">Terrascan<a class="headerlink" href="#terrascan" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## macOS</span>
brew<span class="w"> </span>install<span class="w"> </span>terrascan

<span class="c1">## Linux</span>
curl<span class="w"> </span>-L<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>https://api.github.com/repos/tenable/terrascan/releases/latest<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>grep<span class="w"> </span>-o<span class="w"> </span>-E<span class="w"> </span><span class="s1">&#39;https://.+?_Linux_x86_64.tar.gz&#39;</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>terrascan.tar.gz
tar<span class="w"> </span>-xf<span class="w"> </span>terrascan.tar.gz<span class="w"> </span>terrascan
sudo<span class="w"> </span>mv<span class="w"> </span>terrascan<span class="w"> </span>/usr/local/bin/

<span class="c1">## Verify</span>
terrascan<span class="w"> </span>version
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Scan Terraform</span>
terrascan<span class="w"> </span>scan<span class="w"> </span>-t<span class="w"> </span>terraform<span class="w"> </span>-d<span class="w"> </span>.

<span class="c1">## Scan with specific policy</span>
terrascan<span class="w"> </span>scan<span class="w"> </span>-t<span class="w"> </span>terraform<span class="w"> </span>-p<span class="w"> </span>aws<span class="w"> </span>-d<span class="w"> </span>.

<span class="c1">## Generate reports</span>
terrascan<span class="w"> </span>scan<span class="w"> </span>-t<span class="w"> </span>terraform<span class="w"> </span>-d<span class="w"> </span>.<span class="w"> </span>-o<span class="w"> </span>json<span class="w"> </span>&gt;<span class="w"> </span>terrascan-report.json
terrascan<span class="w"> </span>scan<span class="w"> </span>-t<span class="w"> </span>terraform<span class="w"> </span>-d<span class="w"> </span>.<span class="w"> </span>-o<span class="w"> </span>sarif<span class="w"> </span>&gt;<span class="w"> </span>terrascan.sarif

<span class="c1">## Skip rules</span>
terrascan<span class="w"> </span>scan<span class="w"> </span>-t<span class="w"> </span>terraform<span class="w"> </span>-d<span class="w"> </span>.<span class="w"> </span>--skip-rules<span class="w"> </span>AWS.S3Bucket.DS.High.1043
</code></pre></div>
<hr />
<h2 id="dynamic-application-security-testing-dast">Dynamic Application Security Testing (DAST)<a class="headerlink" href="#dynamic-application-security-testing-dast" title="Permanent link">&para;</a></h2>
<h3 id="owasp-zap">OWASP ZAP<a class="headerlink" href="#owasp-zap" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Docker</span>
docker<span class="w"> </span>pull<span class="w"> </span>zaproxy/zap-stable

<span class="c1">## Run ZAP in daemon mode</span>
docker<span class="w"> </span>run<span class="w"> </span>-u<span class="w"> </span>zap<span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>:8080<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span>zaproxy/zap-stable<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>zap.sh<span class="w"> </span>-daemon<span class="w"> </span>-host<span class="w"> </span><span class="m">0</span>.0.0.0<span class="w"> </span>-port<span class="w"> </span><span class="m">8080</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-config<span class="w"> </span>api.disablekey<span class="o">=</span><span class="nb">true</span>
</code></pre></div>
<p><strong>Baseline scan</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Baseline scan</span>
docker<span class="w"> </span>run<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/zap/wrk/:rw<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>zaproxy/zap-stable<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>zap-baseline.py<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-t<span class="w"> </span>https://example.com<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-r<span class="w"> </span>zap-baseline-report.html

<span class="c1">## Full scan</span>
docker<span class="w"> </span>run<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/zap/wrk/:rw<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>zaproxy/zap-stable<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>zap-full-scan.py<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-t<span class="w"> </span>https://example.com<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-r<span class="w"> </span>zap-full-report.html

<span class="c1">## API scan</span>
docker<span class="w"> </span>run<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/zap/wrk/:rw<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>zaproxy/zap-stable<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>zap-api-scan.py<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-t<span class="w"> </span>https://api.example.com/openapi.json<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-f<span class="w"> </span>openapi<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-r<span class="w"> </span>zap-api-report.html
</code></pre></div>
<h3 id="nuclei">Nuclei<a class="headerlink" href="#nuclei" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Go install</span>
go<span class="w"> </span>install<span class="w"> </span>-v<span class="w"> </span>github.com/projectdiscovery/nuclei/v2/cmd/nuclei@latest

<span class="c1">## Verify</span>
nuclei<span class="w"> </span>-version
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Update templates</span>
nuclei<span class="w"> </span>-update-templates

<span class="c1">## Scan target</span>
nuclei<span class="w"> </span>-u<span class="w"> </span>https://example.com

<span class="c1">## Scan with severity filter</span>
nuclei<span class="w"> </span>-u<span class="w"> </span>https://example.com<span class="w"> </span>-severity<span class="w"> </span>critical,high

<span class="c1">## Scan with specific templates</span>
nuclei<span class="w"> </span>-u<span class="w"> </span>https://example.com<span class="w"> </span>-t<span class="w"> </span>cves/<span class="w"> </span>-t<span class="w"> </span>vulnerabilities/

<span class="c1">## Generate report</span>
nuclei<span class="w"> </span>-u<span class="w"> </span>https://example.com<span class="w"> </span>-json<span class="w"> </span>-o<span class="w"> </span>nuclei-report.json
</code></pre></div>
<h3 id="burp-suite">Burp Suite<a class="headerlink" href="#burp-suite" title="Permanent link">&para;</a></h3>
<p>Burp Suite Professional provides comprehensive web application security testing with
automated scanning and manual testing capabilities.</p>
<p><strong>Headless scanning with Burp Suite Enterprise/Pro</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Run headless scan using Burp Suite CLI</span>
java<span class="w"> </span>-jar<span class="w"> </span>burpsuite_pro.jar<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--unpause-spider-and-scanner<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--project-file<span class="o">=</span>project.burp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--config-file<span class="o">=</span>burp-config.json<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--user-config-file<span class="o">=</span>user-config.json

<span class="c1">## Export results</span>
java<span class="w"> </span>-jar<span class="w"> </span>burpsuite_pro.jar<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--project-file<span class="o">=</span>project.burp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--export-report<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--report-type<span class="o">=</span>HTML<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--output-file<span class="o">=</span>burp-report.html
</code></pre></div>
<p><strong>Burp Suite REST API integration</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;Burp Suite Enterprise API integration for CI/CD pipelines.&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ScanConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for a Burp Suite scan.&quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">target_url</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">scan_config_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">schedule</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;now&quot;</span>
    <span class="n">credential_config_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ScanResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Result from a Burp Suite scan.&quot;&quot;&quot;</span>

    <span class="n">scan_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">status</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">issue_count</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">high_count</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">medium_count</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">low_count</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">info_count</span><span class="p">:</span> <span class="nb">int</span>


<span class="k">class</span><span class="w"> </span><span class="nc">BurpSuiteClient</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Client for Burp Suite Enterprise REST API.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">base_url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">api_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;BURP_ENTERPRISE_URL&quot;</span><span class="p">,</span> <span class="s2">&quot;https://burp.example.com/api&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">api_key</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;BURP_API_KEY&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">ScanConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new scan and return scan ID.&quot;&quot;&quot;</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;scan_configurations&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">scan_config_id</span><span class="p">}],</span>
            <span class="s2">&quot;scope&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;include&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">target_url</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;SimpleScopeDef&quot;</span><span class="p">}]</span>
            <span class="p">},</span>
            <span class="s2">&quot;urls&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">target_url</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">credential_config_id</span><span class="p">:</span>
            <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;application_logins&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">credential_config_id</span><span class="p">}]</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/scans&quot;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_scan_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current scan status.&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/scans/</span><span class="si">{</span><span class="n">scan_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3600</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for scan to complete.&quot;&quot;&quot;</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="n">timeout</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scan_status</span><span class="p">(</span><span class="n">scan_id</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;succeeded&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">status</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;failed&quot;</span><span class="p">,</span> <span class="s2">&quot;cancelled&quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_issues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all issues from a scan.&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/scans/</span><span class="si">{</span><span class="n">scan_id</span><span class="si">}</span><span class="s2">/issues&quot;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;issues&quot;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_scan_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScanResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get summarized scan results.&quot;&quot;&quot;</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_issues</span><span class="p">(</span><span class="n">scan_id</span><span class="p">)</span>

        <span class="n">severity_counts</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="n">issues</span><span class="p">:</span>
            <span class="n">severity</span> <span class="o">=</span> <span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;severity&quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">severity</span> <span class="ow">in</span> <span class="n">severity_counts</span><span class="p">:</span>
                <span class="n">severity_counts</span><span class="p">[</span><span class="n">severity</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">ScanResult</span><span class="p">(</span>
            <span class="n">scan_id</span><span class="o">=</span><span class="n">scan_id</span><span class="p">,</span>
            <span class="n">status</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_scan_status</span><span class="p">(</span><span class="n">scan_id</span><span class="p">),</span>
            <span class="n">issue_count</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">issues</span><span class="p">),</span>
            <span class="n">high_count</span><span class="o">=</span><span class="n">severity_counts</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">],</span>
            <span class="n">medium_count</span><span class="o">=</span><span class="n">severity_counts</span><span class="p">[</span><span class="s2">&quot;medium&quot;</span><span class="p">],</span>
            <span class="n">low_count</span><span class="o">=</span><span class="n">severity_counts</span><span class="p">[</span><span class="s2">&quot;low&quot;</span><span class="p">],</span>
            <span class="n">info_count</span><span class="o">=</span><span class="n">severity_counts</span><span class="p">[</span><span class="s2">&quot;info&quot;</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">export_report</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">scan_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">format_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;html&quot;</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;report.html&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Export scan report to file.&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/scans/</span><span class="si">{</span><span class="n">scan_id</span><span class="si">}</span><span class="s2">/report&quot;</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;report_type&quot;</span><span class="p">:</span> <span class="n">format_type</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output_path</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run_ci_scan</span><span class="p">(</span><span class="n">target_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">threshold_high</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run Burp scan in CI pipeline and enforce quality gates.&quot;&quot;&quot;</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">BurpSuiteClient</span><span class="p">()</span>

    <span class="n">config</span> <span class="o">=</span> <span class="n">ScanConfig</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;CI Scan - </span><span class="si">{</span><span class="n">target_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">target_url</span><span class="o">=</span><span class="n">target_url</span><span class="p">,</span>
        <span class="n">scan_config_id</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;BURP_SCAN_CONFIG_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting scan for </span><span class="si">{</span><span class="n">target_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">scan_id</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_scan</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Waiting for scan </span><span class="si">{</span><span class="n">scan_id</span><span class="si">}</span><span class="s2"> to complete...&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">client</span><span class="o">.</span><span class="n">wait_for_scan</span><span class="p">(</span><span class="n">scan_id</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Scan failed or timed out&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_scan_result</span><span class="p">(</span><span class="n">scan_id</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scan complete: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">issue_count</span><span class="si">}</span><span class="s2"> issues found&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  High: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">high_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Medium: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">medium_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Low: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">low_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1">## Export report</span>
    <span class="n">client</span><span class="o">.</span><span class="n">export_report</span><span class="p">(</span><span class="n">scan_id</span><span class="p">,</span> <span class="s2">&quot;html&quot;</span><span class="p">,</span> <span class="s2">&quot;burp-report.html&quot;</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">export_report</span><span class="p">(</span><span class="n">scan_id</span><span class="p">,</span> <span class="s2">&quot;xml&quot;</span><span class="p">,</span> <span class="s2">&quot;burp-report.xml&quot;</span><span class="p">)</span>

    <span class="c1">## Check thresholds</span>
    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">high_count</span> <span class="o">&gt;</span> <span class="n">threshold_high</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FAILED: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">high_count</span><span class="si">}</span><span class="s2"> high severity issues exceed threshold&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PASSED: Security scan within acceptable thresholds&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

    <span class="n">target</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;https://staging.example.com&quot;</span>
    <span class="n">success</span> <span class="o">=</span> <span class="n">run_ci_scan</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">success</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p><strong>CI/CD integration (GitHub Actions)</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DAST Security Scan</span>

<span class="nt">on</span><span class="p">:</span>
<span class="w">  </span><span class="nt">deployment_status</span><span class="p">:</span>
<span class="w">    </span><span class="nt">types</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">created</span><span class="p p-Indicator">]</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">burp-scan</span><span class="p">:</span>
<span class="w">    </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">github.event.deployment_status.state == &#39;success&#39;</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v5</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.11&#39;</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install dependencies</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip install requests</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Burp Suite Scan</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">          </span><span class="nt">BURP_ENTERPRISE_URL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.BURP_ENTERPRISE_URL }}</span>
<span class="w">          </span><span class="nt">BURP_API_KEY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.BURP_API_KEY }}</span>
<span class="w">          </span><span class="nt">BURP_SCAN_CONFIG_ID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.BURP_SCAN_CONFIG_ID }}</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">python scripts/burp_scan.py ${{ github.event.deployment.payload.target_url }}</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload Burp Report</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/upload-artifact@v4</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">burp-report</span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">            </span><span class="no">burp-report.html</span>
<span class="w">            </span><span class="no">burp-report.xml</span>
</code></pre></div>
<p><strong>Burp Suite scan configuration (burp-config.json)</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;scanner&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;audit_optimization&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;consolidate_passive_issues&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;follow_redirections&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;skip_audit_checks_unlikely_to_have_issues&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;error_handling&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;consecutive_audit_check_failures&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;skip_remaining_checks_for_insertion_point&quot;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;number_of_consecutive_insertion_point_failures&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;issues_reported&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;scan_type_intrusive_active&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;scan_type_light_active&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;scan_type_medium_active&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;scan_type_passive&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;crawl&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;crawl_limits&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;max_crawl_depth&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;max_request_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5000</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;crawl_optimization&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;avoid_duplicate_content&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="compliance-scanning">Compliance Scanning<a class="headerlink" href="#compliance-scanning" title="Permanent link">&para;</a></h2>
<h3 id="openscap">OpenSCAP<a class="headerlink" href="#openscap" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Ubuntu/Debian</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libopenscap8<span class="w"> </span>openscap-scanner

<span class="c1">## RHEL/CentOS</span>
sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>openscap-scanner
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Scan system</span>
sudo<span class="w"> </span>oscap<span class="w"> </span>xccdf<span class="w"> </span><span class="nb">eval</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--profile<span class="w"> </span>xccdf_org.ssgproject.content_profile_pci-dss<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--results<span class="w"> </span>scan-results.xml<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--report<span class="w"> </span>scan-report.html<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>/usr/share/xml/scap/ssg/content/ssg-ubuntu2004-ds.xml
</code></pre></div>
<h3 id="chef-inspec">Chef InSpec<a class="headerlink" href="#chef-inspec" title="Permanent link">&para;</a></h3>
<p><strong>Installation</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## macOS/Linux</span>
curl<span class="w"> </span>https://omnitruck.chef.io/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span>-s<span class="w"> </span>--<span class="w"> </span>-P<span class="w"> </span>inspec

<span class="c1">## Verify</span>
inspec<span class="w"> </span>--version
</code></pre></div>
<p><strong>Profile example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## controls/example.rb</span>
<span class="n">control</span><span class="w"> </span><span class="s1">&#39;ssh-config&#39;</span><span class="w"> </span><span class="k">do</span>
<span class="w">  </span><span class="n">impact</span><span class="w"> </span><span class="mi">1</span><span class="o">.</span><span class="mi">0</span>
<span class="w">  </span><span class="n">title</span><span class="w"> </span><span class="s1">&#39;SSH Configuration&#39;</span>
<span class="w">  </span><span class="n">desc</span><span class="w"> </span><span class="s1">&#39;Ensure SSH is configured securely&#39;</span>

<span class="w">  </span><span class="n">describe</span><span class="w"> </span><span class="n">sshd_config</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="n">its</span><span class="p">(</span><span class="s1">&#39;PermitRootLogin&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">eq</span><span class="w"> </span><span class="s1">&#39;no&#39;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="n">its</span><span class="p">(</span><span class="s1">&#39;PasswordAuthentication&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">eq</span><span class="w"> </span><span class="s1">&#39;no&#39;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="n">its</span><span class="p">(</span><span class="s1">&#39;Protocol&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">eq</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p><strong>Scanning</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Run profile</span>
inspec<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>/path/to/profile

<span class="c1">## Run with reporter</span>
inspec<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>/path/to/profile<span class="w"> </span>--reporter<span class="w"> </span>json:inspec-report.json

<span class="c1">## Run remote</span>
inspec<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>/path/to/profile<span class="w"> </span>-t<span class="w"> </span>ssh://user@host
</code></pre></div>
<h3 id="cis-benchmarks">CIS Benchmarks<a class="headerlink" href="#cis-benchmarks" title="Permanent link">&para;</a></h3>
<p>CIS (Center for Internet Security) Benchmarks provide prescriptive security
configuration guidelines for hardening systems and infrastructure.</p>
<p><strong>Using CIS-CAT Pro</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Download CIS-CAT Pro from CIS SecureSuite</span>
<span class="c1">## https://www.cisecurity.org/cis-securesuite</span>

<span class="c1">## Run assessment</span>
./Assessor-CLI.sh<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-b<span class="w"> </span>benchmarks/CIS_Ubuntu_Linux_22.04_LTS_Benchmark_v1.0.0-xccdf.xml<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="s2">&quot;Level 1 - Server&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-rd<span class="w"> </span>/reports

<span class="c1">## Generate HTML report</span>
./Assessor-CLI.sh<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-b<span class="w"> </span>benchmarks/CIS_Ubuntu_Linux_22.04_LTS_Benchmark_v1.0.0-xccdf.xml<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="s2">&quot;Level 1 - Server&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-html<span class="w"> </span>-rd<span class="w"> </span>/reports
</code></pre></div>
<p><strong>Using InSpec with CIS Profiles</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Install CIS profile from Chef Supermarket</span>
inspec<span class="w"> </span>supermarket<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>dev-sec/linux-baseline

<span class="c1">## Run CIS benchmark profile</span>
inspec<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>https://github.com/dev-sec/linux-baseline<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--reporter<span class="w"> </span>json:cis-report.json<span class="w"> </span>html:cis-report.html

<span class="c1">## Run against remote target</span>
inspec<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>https://github.com/dev-sec/linux-baseline<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-t<span class="w"> </span>ssh://user@hostname<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--sudo
</code></pre></div>
<p><strong>Available CIS InSpec Profiles</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Available CIS compliance profiles</span>
<span class="nt">cis_profiles</span><span class="p">:</span>
<span class="w">  </span><span class="nt">operating_systems</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">linux-baseline</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/dev-sec/linux-baseline</span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Linux security baseline (CIS Level 1)</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">windows-baseline</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/dev-sec/windows-baseline</span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Windows security baseline</span>

<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cis-docker-benchmark</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/dev-sec/cis-docker-benchmark</span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CIS Docker Benchmark</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cis-kubernetes-benchmark</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/dev-sec/cis-kubernetes-benchmark</span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CIS Kubernetes Benchmark</span>

<span class="w">  </span><span class="nt">cloud</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws-foundations-benchmark</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/mitre/aws-foundations-cis-baseline</span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CIS AWS Foundations Benchmark</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-foundations-benchmark</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/mitre/microsoft-azure-cis-foundations-baseline</span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CIS Azure Foundations Benchmark</span>
</code></pre></div>
<p><strong>Kubernetes CIS Benchmark with kube-bench</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Install kube-bench</span>
go<span class="w"> </span>install<span class="w"> </span>github.com/aquasecurity/kube-bench@latest

<span class="c1">## Run CIS benchmark</span>
kube-bench<span class="w"> </span>run<span class="w"> </span>--targets<span class="w"> </span>master,node

<span class="c1">## Run specific version</span>
kube-bench<span class="w"> </span>run<span class="w"> </span>--benchmark<span class="w"> </span>cis-1.8

<span class="c1">## Generate JSON report</span>
kube-bench<span class="w"> </span>run<span class="w"> </span>--json<span class="w"> </span>--outputfile<span class="w"> </span>kube-bench-report.json

<span class="c1">## Run as Kubernetes Job</span>
kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>https://raw.githubusercontent.com/aquasecurity/kube-bench/main/job.yaml
</code></pre></div>
<p><strong>kube-bench Job manifest</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">batch/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Job</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kube-bench</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">hostPID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kube-bench</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aquasec/kube-bench:latest</span>
<span class="w">          </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;kube-bench&quot;</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;run&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;--json&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;--outputfile&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;/results/report.json&quot;</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">var-lib-kubelet</span>
<span class="w">              </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/lib/kubelet</span>
<span class="w">              </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">etc-kubernetes</span>
<span class="w">              </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kubernetes</span>
<span class="w">              </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">results</span>
<span class="w">              </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/results</span>
<span class="w">      </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Never</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">var-lib-kubelet</span>
<span class="w">          </span><span class="nt">hostPath</span><span class="p">:</span>
<span class="w">            </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/lib/kubelet</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">etc-kubernetes</span>
<span class="w">          </span><span class="nt">hostPath</span><span class="p">:</span>
<span class="w">            </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kubernetes</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">results</span>
<span class="w">          </span><span class="nt">emptyDir</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div>
<p><strong>AWS CIS Benchmark with Prowler</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## Install Prowler</span>
pip<span class="w"> </span>install<span class="w"> </span>prowler

<span class="c1">## Run AWS CIS Benchmark</span>
prowler<span class="w"> </span>aws<span class="w"> </span>--compliance<span class="w"> </span>cis_1.5_aws

<span class="c1">## Run specific checks</span>
prowler<span class="w"> </span>aws<span class="w"> </span>-c<span class="w"> </span>cis_1.5_aws<span class="w"> </span>-M<span class="w"> </span>json-ocsf

<span class="c1">## Generate multiple report formats</span>
prowler<span class="w"> </span>aws<span class="w"> </span>--compliance<span class="w"> </span>cis_1.5_aws<span class="w"> </span>-M<span class="w"> </span>csv<span class="w"> </span>json<span class="w"> </span>html
</code></pre></div>
<p><strong>CI/CD integration for CIS compliance</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CIS Compliance Scan</span>

<span class="nt">on</span><span class="p">:</span>
<span class="w">  </span><span class="nt">schedule</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">cron</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0</span><span class="nv"> </span><span class="s">0</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">0&#39;</span><span class="w">  </span><span class="c1"># Weekly</span>
<span class="w">  </span><span class="nt">workflow_dispatch</span><span class="p">:</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">cis-scan</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Ruby</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ruby/setup-ruby@v1</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">ruby-version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.2&#39;</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install InSpec</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gem install inspec-bin</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Linux Baseline</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">inspec exec https://github.com/dev-sec/linux-baseline \</span>
<span class="w">            </span><span class="no">--reporter json:linux-baseline.json cli</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Docker Benchmark</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">inspec exec https://github.com/dev-sec/cis-docker-benchmark \</span>
<span class="w">            </span><span class="no">--reporter json:docker-benchmark.json cli</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload Compliance Reports</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/upload-artifact@v4</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cis-compliance-reports</span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">            </span><span class="no">linux-baseline.json</span>
<span class="w">            </span><span class="no">docker-benchmark.json</span>

<span class="w">  </span><span class="nt">kubernetes-cis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up kubectl</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure/setup-kubectl@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run kube-bench</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">kubectl apply -f kube-bench-job.yaml</span>
<span class="w">          </span><span class="no">kubectl wait --for=condition=complete job/kube-bench -n security --timeout=300s</span>
<span class="w">          </span><span class="no">kubectl logs job/kube-bench -n security &gt; kube-bench-report.txt</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload kube-bench Report</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/upload-artifact@v4</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kube-bench-report</span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kube-bench-report.txt</span>
</code></pre></div>
<hr />
<h2 id="policy-as-code-oparego">Policy as Code (OPA/Rego)<a class="headerlink" href="#policy-as-code-oparego" title="Permanent link">&para;</a></h2>
<p>Open Policy Agent (OPA) enables policy as code for authorization, admission control,
and security policy enforcement across the software delivery lifecycle.</p>
<h3 id="opa-installation">OPA Installation<a class="headerlink" href="#opa-installation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">## macOS</span>
brew<span class="w"> </span>install<span class="w"> </span>opa

<span class="c1">## Linux</span>
curl<span class="w"> </span>-L<span class="w"> </span>-o<span class="w"> </span>opa<span class="w"> </span>https://openpolicyagent.org/downloads/latest/opa_linux_amd64_static
chmod<span class="w"> </span>+x<span class="w"> </span>opa
sudo<span class="w"> </span>mv<span class="w"> </span>opa<span class="w"> </span>/usr/local/bin/

<span class="c1">## Verify</span>
opa<span class="w"> </span>version
</code></pre></div>
<h3 id="rego-policy-basics">Rego Policy Basics<a class="headerlink" href="#rego-policy-basics" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># policy/security/secrets.rego</span>
<span class="k">package</span><span class="w"> </span><span class="n">security</span><span class="p">.</span><span class="n">secrets</span>

<span class="c1"># Deny commits containing hardcoded secrets</span>
<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">input</span><span class="p">.</span><span class="n">file</span><span class="p">.</span><span class="n">extension</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;py&quot;</span>
<span class="w">    </span><span class="k">contains</span><span class="p">(</span><span class="nb">input</span><span class="p">.</span><span class="n">file</span><span class="p">.</span><span class="n">content</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;password&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">contains</span><span class="p">(</span><span class="nb">input</span><span class="p">.</span><span class="n">file</span><span class="p">.</span><span class="n">content</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">not</span><span class="w"> </span><span class="k">contains</span><span class="p">(</span><span class="nb">input</span><span class="p">.</span><span class="n">file</span><span class="p">.</span><span class="n">content</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;os.environ&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">sprintf</span><span class="p">(</span><span class="s2">&quot;Hardcoded password detected in %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nb">input</span><span class="p">.</span><span class="n">file</span><span class="p">.</span><span class="n">path</span><span class="p">])</span>
<span class="p">}</span>

<span class="c1"># Deny AWS credentials in code</span>
<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">regex</span><span class="p">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;AKIA[A-Z0-9]{16}&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">input</span><span class="p">.</span><span class="n">file</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">sprintf</span><span class="p">(</span><span class="s2">&quot;AWS Access Key ID detected in %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nb">input</span><span class="p">.</span><span class="n">file</span><span class="p">.</span><span class="n">path</span><span class="p">])</span>
<span class="p">}</span>

<span class="c1"># Deny private keys</span>
<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">contains</span><span class="p">(</span><span class="nb">input</span><span class="p">.</span><span class="n">file</span><span class="p">.</span><span class="n">content</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-----BEGIN RSA PRIV&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;ATE KEY-----&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">sprintf</span><span class="p">(</span><span class="s2">&quot;Private key detected in %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nb">input</span><span class="p">.</span><span class="n">file</span><span class="p">.</span><span class="n">path</span><span class="p">])</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="kubernetes-admission-control">Kubernetes Admission Control<a class="headerlink" href="#kubernetes-admission-control" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># policy/kubernetes/pod_security.rego</span>
<span class="k">package</span><span class="w"> </span><span class="n">kubernetes</span><span class="p">.</span><span class="n">admission</span>

<span class="c1"># Deny containers running as root</span>
<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">input</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">kind</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;Pod&quot;</span>
<span class="w">    </span><span class="n">container</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">input</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">object</span><span class="p">.</span><span class="n">spec</span><span class="p">.</span><span class="n">containers</span><span class="p">[</span><span class="n">_</span><span class="p">]</span>
<span class="w">    </span><span class="n">container</span><span class="p">.</span><span class="n">securityContext</span><span class="p">.</span><span class="n">runAsUser</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">sprintf</span><span class="p">(</span><span class="s2">&quot;Container &#39;%s&#39; cannot run as root&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">container</span><span class="p">.</span><span class="n">name</span><span class="p">])</span>
<span class="p">}</span>

<span class="c1"># Deny privileged containers</span>
<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">input</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">kind</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;Pod&quot;</span>
<span class="w">    </span><span class="n">container</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">input</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">object</span><span class="p">.</span><span class="n">spec</span><span class="p">.</span><span class="n">containers</span><span class="p">[</span><span class="n">_</span><span class="p">]</span>
<span class="w">    </span><span class="n">container</span><span class="p">.</span><span class="n">securityContext</span><span class="p">.</span><span class="n">privileged</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">true</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">sprintf</span><span class="p">(</span><span class="s2">&quot;Container &#39;%s&#39; cannot be privileged&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">container</span><span class="p">.</span><span class="n">name</span><span class="p">])</span>
<span class="p">}</span>

<span class="c1"># Require resource limits</span>
<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">input</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">kind</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;Pod&quot;</span>
<span class="w">    </span><span class="n">container</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">input</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">object</span><span class="p">.</span><span class="n">spec</span><span class="p">.</span><span class="n">containers</span><span class="p">[</span><span class="n">_</span><span class="p">]</span>
<span class="w">    </span><span class="k">not</span><span class="w"> </span><span class="n">container</span><span class="p">.</span><span class="n">resources</span><span class="p">.</span><span class="n">limits</span><span class="p">.</span><span class="n">memory</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">sprintf</span><span class="p">(</span><span class="s2">&quot;Container &#39;%s&#39; must have memory limits&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">container</span><span class="p">.</span><span class="n">name</span><span class="p">])</span>
<span class="p">}</span>

<span class="c1"># Deny latest tag</span>
<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">input</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">kind</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;Pod&quot;</span>
<span class="w">    </span><span class="n">container</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">input</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">object</span><span class="p">.</span><span class="n">spec</span><span class="p">.</span><span class="n">containers</span><span class="p">[</span><span class="n">_</span><span class="p">]</span>
<span class="w">    </span><span class="n">endswith</span><span class="p">(</span><span class="n">container</span><span class="p">.</span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;:latest&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">sprintf</span><span class="p">(</span><span class="s2">&quot;Container &#39;%s&#39; cannot use :latest tag&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">container</span><span class="p">.</span><span class="n">name</span><span class="p">])</span>
<span class="p">}</span>

<span class="c1"># Require approved registries</span>
<span class="n">approved_registries</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;gcr.io/my-project&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ghcr.io/my-org&quot;</span><span class="p">]</span>

<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">input</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">kind</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;Pod&quot;</span>
<span class="w">    </span><span class="n">container</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">input</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">object</span><span class="p">.</span><span class="n">spec</span><span class="p">.</span><span class="n">containers</span><span class="p">[</span><span class="n">_</span><span class="p">]</span>
<span class="w">    </span><span class="k">not</span><span class="w"> </span><span class="n">any_approved_registry</span><span class="p">(</span><span class="n">container</span><span class="p">.</span><span class="n">image</span><span class="p">)</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">sprintf</span><span class="p">(</span><span class="s2">&quot;Container &#39;%s&#39; uses unapproved registry&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">container</span><span class="p">.</span><span class="n">name</span><span class="p">])</span>
<span class="p">}</span>

<span class="n">any_approved_registry</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">registry</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">approved_registries</span><span class="p">[</span><span class="n">_</span><span class="p">]</span>
<span class="w">    </span><span class="n">startswith</span><span class="p">(</span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="terraform-policy-enforcement">Terraform Policy Enforcement<a class="headerlink" href="#terraform-policy-enforcement" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># policy/terraform/aws_security.rego</span>
<span class="k">package</span><span class="w"> </span><span class="n">terraform</span><span class="p">.</span><span class="n">aws</span>

<span class="c1"># Deny S3 buckets without encryption</span>
<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">resource</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">input</span><span class="p">.</span><span class="n">resource_changes</span><span class="p">[</span><span class="n">_</span><span class="p">]</span>
<span class="w">    </span><span class="n">resource</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;aws_s3_bucket&quot;</span>
<span class="w">    </span><span class="n">resource</span><span class="p">.</span><span class="n">change</span><span class="p">.</span><span class="n">after</span><span class="p">.</span><span class="n">server_side_encryption_configuration</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">sprintf</span><span class="p">(</span><span class="s2">&quot;S3 bucket &#39;%s&#39; must have encryption enabled&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">resource</span><span class="p">.</span><span class="n">address</span><span class="p">])</span>
<span class="p">}</span>

<span class="c1"># Deny public S3 buckets</span>
<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">resource</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">input</span><span class="p">.</span><span class="n">resource_changes</span><span class="p">[</span><span class="n">_</span><span class="p">]</span>
<span class="w">    </span><span class="n">resource</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;aws_s3_bucket_public_access_block&quot;</span>
<span class="w">    </span><span class="k">not</span><span class="w"> </span><span class="n">resource</span><span class="p">.</span><span class="n">change</span><span class="p">.</span><span class="n">after</span><span class="p">.</span><span class="n">block_public_acls</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">sprintf</span><span class="p">(</span><span class="s2">&quot;S3 bucket &#39;%s&#39; must block public ACLs&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">resource</span><span class="p">.</span><span class="n">address</span><span class="p">])</span>
<span class="p">}</span>

<span class="c1"># Deny security groups with 0.0.0.0/0 ingress</span>
<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">resource</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">input</span><span class="p">.</span><span class="n">resource_changes</span><span class="p">[</span><span class="n">_</span><span class="p">]</span>
<span class="w">    </span><span class="n">resource</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;aws_security_group_rule&quot;</span>
<span class="w">    </span><span class="n">resource</span><span class="p">.</span><span class="n">change</span><span class="p">.</span><span class="n">after</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;ingress&quot;</span>
<span class="w">    </span><span class="n">resource</span><span class="p">.</span><span class="n">change</span><span class="p">.</span><span class="n">after</span><span class="p">.</span><span class="n">cidr_blocks</span><span class="p">[</span><span class="n">_</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;0.0.0.0/0&quot;</span>
<span class="w">    </span><span class="n">resource</span><span class="p">.</span><span class="n">change</span><span class="p">.</span><span class="n">after</span><span class="p">.</span><span class="n">from_port</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">443</span>
<span class="w">    </span><span class="n">resource</span><span class="p">.</span><span class="n">change</span><span class="p">.</span><span class="n">after</span><span class="p">.</span><span class="n">from_port</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">80</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">sprintf</span><span class="p">(</span>
<span class="w">        </span><span class="s2">&quot;Security group rule &#39;%s&#39; allows unrestricted ingress on port %d&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="p">[</span><span class="n">resource</span><span class="p">.</span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="p">.</span><span class="n">change</span><span class="p">.</span><span class="n">after</span><span class="p">.</span><span class="n">from_port</span><span class="p">]</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Require tags on all resources</span>
<span class="n">required_tags</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Environment&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Owner&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Project&quot;</span><span class="p">]</span>

<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">resource</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">input</span><span class="p">.</span><span class="n">resource_changes</span><span class="p">[</span><span class="n">_</span><span class="p">]</span>
<span class="w">    </span><span class="n">resource</span><span class="p">.</span><span class="n">change</span><span class="p">.</span><span class="n">after</span><span class="p">.</span><span class="n">tags</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span>
<span class="w">    </span><span class="n">missing_tags</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">[</span><span class="n">tag</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">required_tags</span><span class="p">[</span><span class="n">_</span><span class="p">];</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">resource</span><span class="p">.</span><span class="n">change</span><span class="p">.</span><span class="n">after</span><span class="p">.</span><span class="n">tags</span><span class="p">[</span><span class="n">tag</span><span class="p">]]</span>
<span class="w">    </span><span class="n">count</span><span class="p">(</span><span class="n">missing_tags</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">sprintf</span><span class="p">(</span><span class="s2">&quot;Resource &#39;%s&#39; missing required tags: %v&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">resource</span><span class="p">.</span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="n">missing_tags</span><span class="p">])</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="conftest-for-policy-testing">Conftest for Policy Testing<a class="headerlink" href="#conftest-for-policy-testing" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">## Install Conftest</span>
brew<span class="w"> </span>install<span class="w"> </span>conftest

<span class="c1">## Test Terraform plan</span>
terraform<span class="w"> </span>plan<span class="w"> </span>-out<span class="o">=</span>tfplan
terraform<span class="w"> </span>show<span class="w"> </span>-json<span class="w"> </span>tfplan<span class="w"> </span>&gt;<span class="w"> </span>tfplan.json
conftest<span class="w"> </span><span class="nb">test</span><span class="w"> </span>tfplan.json<span class="w"> </span>-p<span class="w"> </span>policy/terraform/

<span class="c1">## Test Kubernetes manifests</span>
conftest<span class="w"> </span><span class="nb">test</span><span class="w"> </span>deployment.yaml<span class="w"> </span>-p<span class="w"> </span>policy/kubernetes/

<span class="c1">## Test Dockerfile</span>
conftest<span class="w"> </span><span class="nb">test</span><span class="w"> </span>Dockerfile<span class="w"> </span>-p<span class="w"> </span>policy/docker/

<span class="c1">## Pull policies from OCI registry</span>
conftest<span class="w"> </span>pull<span class="w"> </span>oci://ghcr.io/my-org/policies:latest
conftest<span class="w"> </span><span class="nb">test</span><span class="w"> </span>--update<span class="w"> </span>oci://ghcr.io/my-org/policies:latest<span class="w"> </span>deployment.yaml
</code></pre></div>
<h3 id="dockerfile-policies">Dockerfile Policies<a class="headerlink" href="#dockerfile-policies" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># policy/docker/dockerfile.rego</span>
<span class="k">package</span><span class="w"> </span><span class="n">docker</span><span class="p">.</span><span class="n">security</span>

<span class="c1"># Deny running as root</span>
<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">input</span><span class="p">.</span><span class="n">Cmd</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;user&quot;</span>
<span class="w">    </span><span class="nb">input</span><span class="p">.</span><span class="n">Value</span><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;root&quot;</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s2">&quot;Dockerfile should not run as root user&quot;</span>
<span class="p">}</span>

<span class="c1"># Require USER instruction</span>
<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">not</span><span class="w"> </span><span class="n">has_user_instruction</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s2">&quot;Dockerfile must include USER instruction&quot;</span>
<span class="p">}</span>

<span class="n">has_user_instruction</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">input</span><span class="p">[</span><span class="n">_</span><span class="p">].</span><span class="n">Cmd</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;user&quot;</span>
<span class="p">}</span>

<span class="c1"># Deny ADD instruction (prefer COPY)</span>
<span class="n">warn</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">input</span><span class="p">[</span><span class="n">_</span><span class="p">].</span><span class="n">Cmd</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;add&quot;</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s2">&quot;Use COPY instead of ADD unless extracting archives&quot;</span>
<span class="p">}</span>

<span class="c1"># Require specific base image versions</span>
<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">input</span><span class="p">.</span><span class="n">Cmd</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;from&quot;</span>
<span class="w">    </span><span class="n">endswith</span><span class="p">(</span><span class="nb">input</span><span class="p">.</span><span class="n">Value</span><span class="p">[</span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="s2">&quot;:latest&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s2">&quot;Base image must use specific version tag, not :latest&quot;</span>
<span class="p">}</span>

<span class="c1"># Deny curl/wget piped to shell</span>
<span class="n">deny</span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">input</span><span class="p">.</span><span class="n">Cmd</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;run&quot;</span>
<span class="w">    </span><span class="n">cmd</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">input</span><span class="p">.</span><span class="n">Value</span><span class="p">[</span><span class="n">_</span><span class="p">]</span>
<span class="w">    </span><span class="k">contains</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;curl&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">contains</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;| sh&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s2">&quot;Do not pipe curl output directly to shell&quot;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="policy-validation-in-cicd">Policy Validation in CI/CD<a class="headerlink" href="#policy-validation-in-cicd" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy Validation</span>

<span class="nt">on</span><span class="p">:</span>
<span class="w">  </span><span class="nt">push</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">]</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">terraform-policy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Setup Terraform</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hashicorp/setup-terraform@v3</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Terraform Init</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terraform init</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Terraform Plan</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terraform plan -out=tfplan</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Convert Plan to JSON</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terraform show -json tfplan &gt; tfplan.json</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install Conftest</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">wget https://github.com/open-policy-agent/conftest/releases/download/v0.50.0/conftest_0.50.0_Linux_x86_64.tar.gz</span>
<span class="w">          </span><span class="no">tar xzf conftest_0.50.0_Linux_x86_64.tar.gz</span>
<span class="w">          </span><span class="no">sudo mv conftest /usr/local/bin/</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Policy Tests</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conftest test tfplan.json -p policy/terraform/</span>

<span class="w">  </span><span class="nt">kubernetes-policy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install Conftest</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">wget https://github.com/open-policy-agent/conftest/releases/download/v0.50.0/conftest_0.50.0_Linux_x86_64.tar.gz</span>
<span class="w">          </span><span class="no">tar xzf conftest_0.50.0_Linux_x86_64.tar.gz</span>
<span class="w">          </span><span class="no">sudo mv conftest /usr/local/bin/</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Test Kubernetes Manifests</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">conftest test k8s/*.yaml -p policy/kubernetes/</span>

<span class="w">  </span><span class="nt">dockerfile-policy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install Conftest</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">wget https://github.com/open-policy-agent/conftest/releases/download/v0.50.0/conftest_0.50.0_Linux_x86_64.tar.gz</span>
<span class="w">          </span><span class="no">tar xzf conftest_0.50.0_Linux_x86_64.tar.gz</span>
<span class="w">          </span><span class="no">sudo mv conftest /usr/local/bin/</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Parse Dockerfile</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">docker run --rm -i hadolint/hadolint hadolint --format json - &lt; Dockerfile &gt; dockerfile.json</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Test Dockerfile Policies</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conftest test Dockerfile -p policy/docker/</span>
</code></pre></div>
<h3 id="gatekeeper-for-kubernetes">Gatekeeper for Kubernetes<a class="headerlink" href="#gatekeeper-for-kubernetes" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Install Gatekeeper</span>
<span class="c1"># kubectl apply -f https://raw.githubusercontent.com/open-policy-agent/gatekeeper/master/deploy/gatekeeper.yaml</span>

<span class="c1"># Constraint Template for required labels</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">templates.gatekeeper.sh/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ConstraintTemplate</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k8srequiredlabels</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">crd</span><span class="p">:</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">names</span><span class="p">:</span>
<span class="w">        </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">K8sRequiredLabels</span>
<span class="w">      </span><span class="nt">validation</span><span class="p">:</span>
<span class="w">        </span><span class="nt">openAPIV3Schema</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="w">          </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">            </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">              </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">array</span>
<span class="w">              </span><span class="nt">items</span><span class="p">:</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">  </span><span class="nt">targets</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">admission.k8s.gatekeeper.sh</span>
<span class="w">      </span><span class="nt">rego</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">package k8srequiredlabels</span>

<span class="w">        </span><span class="no">violation[{&quot;msg&quot;: msg, &quot;details&quot;: {&quot;missing_labels&quot;: missing}}] {</span>
<span class="w">          </span><span class="no">provided := {label | input.review.object.metadata.labels[label]}</span>
<span class="w">          </span><span class="no">required := {label | label := input.parameters.labels[_]}</span>
<span class="w">          </span><span class="no">missing := required - provided</span>
<span class="w">          </span><span class="no">count(missing) &gt; 0</span>
<span class="w">          </span><span class="no">msg := sprintf(&quot;Missing required labels: %v&quot;, [missing])</span>
<span class="w">        </span><span class="no">}</span>
<span class="nn">---</span>
<span class="c1"># Constraint to enforce required labels</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">constraints.gatekeeper.sh/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">K8sRequiredLabels</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">require-app-labels</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">match</span><span class="p">:</span>
<span class="w">    </span><span class="nt">kinds</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;&quot;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">kinds</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;Pod&quot;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;apps&quot;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">kinds</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;Deployment&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;StatefulSet&quot;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">parameters</span><span class="p">:</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;app.kubernetes.io/name&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;app.kubernetes.io/version&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;app.kubernetes.io/managed-by&quot;</span>
</code></pre></div>
<hr />
<h2 id="severity-classification">Severity Classification<a class="headerlink" href="#severity-classification" title="Permanent link">&para;</a></h2>
<h3 id="severity-levels">Severity Levels<a class="headerlink" href="#severity-levels" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>
 Severity  Description                                                 

 CRITICAL  Actively exploited, remote code execution, data breach risk 
           CVSS: 9.0-10.0 | Requires immediate action                  

 HIGH      Easily exploitable, significant impact potential            
           CVSS: 7.0-8.9 | Fix within 7 days                           

 MEDIUM    Requires specific conditions, moderate impact               
           CVSS: 4.0-6.9 | Fix within 30 days                          

 LOW       Difficult to exploit, minimal impact                        
           CVSS: 0.1-3.9 | Fix within 90 days                          

 INFO      Best practice recommendations, no immediate risk            
           CVSS: N/A | Address during regular maintenance              

</code></pre></div>
<h3 id="severity-classification-by-finding-type">Severity Classification by Finding Type<a class="headerlink" href="#severity-classification-by-finding-type" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># severity-classification.yml</span>
<span class="nt">classification</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Authentication &amp; Authorization</span>
<span class="w">  </span><span class="nt">authentication_bypass</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CRITICAL</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A07:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Identification</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">Authentication</span><span class="nv"> </span><span class="s">Failures&quot;</span>
<span class="w">  </span><span class="nt">broken_access_control</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CRITICAL</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A01:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Broken</span><span class="nv"> </span><span class="s">Access</span><span class="nv"> </span><span class="s">Control&quot;</span>
<span class="w">  </span><span class="nt">privilege_escalation</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CRITICAL</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A01:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Broken</span><span class="nv"> </span><span class="s">Access</span><span class="nv"> </span><span class="s">Control&quot;</span>

<span class="w">  </span><span class="c1"># Injection</span>
<span class="w">  </span><span class="nt">sql_injection</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CRITICAL</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A03:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Injection&quot;</span>
<span class="w">  </span><span class="nt">command_injection</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CRITICAL</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A03:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Injection&quot;</span>
<span class="w">  </span><span class="nt">code_injection</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CRITICAL</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A03:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Injection&quot;</span>
<span class="w">  </span><span class="nt">xss_stored</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HIGH</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A03:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Injection&quot;</span>
<span class="w">  </span><span class="nt">xss_reflected</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MEDIUM</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A03:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Injection&quot;</span>
<span class="w">  </span><span class="nt">ldap_injection</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HIGH</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A03:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Injection&quot;</span>
<span class="w">  </span><span class="nt">xpath_injection</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HIGH</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A03:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Injection&quot;</span>

<span class="w">  </span><span class="c1"># Cryptography</span>
<span class="w">  </span><span class="nt">hardcoded_secrets</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CRITICAL</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A02:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Cryptographic</span><span class="nv"> </span><span class="s">Failures&quot;</span>
<span class="w">  </span><span class="nt">weak_encryption</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HIGH</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A02:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Cryptographic</span><span class="nv"> </span><span class="s">Failures&quot;</span>
<span class="w">  </span><span class="nt">insecure_random</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MEDIUM</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A02:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Cryptographic</span><span class="nv"> </span><span class="s">Failures&quot;</span>
<span class="w">  </span><span class="nt">missing_encryption</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HIGH</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A02:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Cryptographic</span><span class="nv"> </span><span class="s">Failures&quot;</span>

<span class="w">  </span><span class="c1"># Data Exposure</span>
<span class="w">  </span><span class="nt">sensitive_data_exposure</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HIGH</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A02:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Cryptographic</span><span class="nv"> </span><span class="s">Failures&quot;</span>
<span class="w">  </span><span class="nt">pii_exposure</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HIGH</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A02:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Cryptographic</span><span class="nv"> </span><span class="s">Failures&quot;</span>
<span class="w">  </span><span class="nt">debug_info_exposure</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MEDIUM</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A05:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Security</span><span class="nv"> </span><span class="s">Misconfiguration&quot;</span>

<span class="w">  </span><span class="c1"># Configuration</span>
<span class="w">  </span><span class="nt">security_misconfiguration</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MEDIUM</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A05:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Security</span><span class="nv"> </span><span class="s">Misconfiguration&quot;</span>
<span class="w">  </span><span class="nt">default_credentials</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CRITICAL</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A07:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Identification</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">Authentication</span><span class="nv"> </span><span class="s">Failures&quot;</span>
<span class="w">  </span><span class="nt">verbose_errors</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LOW</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A05:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Security</span><span class="nv"> </span><span class="s">Misconfiguration&quot;</span>

<span class="w">  </span><span class="c1"># Dependencies</span>
<span class="w">  </span><span class="nt">vulnerable_dependency_critical</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CRITICAL</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A06:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Vulnerable</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">Outdated</span><span class="nv"> </span><span class="s">Components&quot;</span>
<span class="w">  </span><span class="nt">vulnerable_dependency_high</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HIGH</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A06:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Vulnerable</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">Outdated</span><span class="nv"> </span><span class="s">Components&quot;</span>
<span class="w">  </span><span class="nt">vulnerable_dependency_medium</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MEDIUM</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A06:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Vulnerable</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">Outdated</span><span class="nv"> </span><span class="s">Components&quot;</span>
<span class="w">  </span><span class="nt">outdated_dependency</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LOW</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A06:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Vulnerable</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">Outdated</span><span class="nv"> </span><span class="s">Components&quot;</span>

<span class="w">  </span><span class="c1"># SSRF &amp; Path Traversal</span>
<span class="w">  </span><span class="nt">ssrf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HIGH</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A10:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Server-Side</span><span class="nv"> </span><span class="s">Request</span><span class="nv"> </span><span class="s">Forgery&quot;</span>
<span class="w">  </span><span class="nt">path_traversal</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HIGH</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A01:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Broken</span><span class="nv"> </span><span class="s">Access</span><span class="nv"> </span><span class="s">Control&quot;</span>

<span class="w">  </span><span class="c1"># Deserialization</span>
<span class="w">  </span><span class="nt">insecure_deserialization</span><span class="p">:</span>
<span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CRITICAL</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A08:2021</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Software</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">Data</span><span class="nv"> </span><span class="s">Integrity</span><span class="nv"> </span><span class="s">Failures&quot;</span>
</code></pre></div>
<h3 id="automated-severity-assignment">Automated Severity Assignment<a class="headerlink" href="#automated-severity-assignment" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># scripts/security/severity_classifier.py</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Automated severity classification for security findings.</span>

<span class="sd">@module severity_classifier</span>
<span class="sd">@description Classify security findings by severity</span>
<span class="sd">@version 1.0.0</span>
<span class="sd">@author Tyler Dukes</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Severity</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">CRITICAL</span> <span class="o">=</span> <span class="s2">&quot;CRITICAL&quot;</span>
    <span class="n">HIGH</span> <span class="o">=</span> <span class="s2">&quot;HIGH&quot;</span>
    <span class="n">MEDIUM</span> <span class="o">=</span> <span class="s2">&quot;MEDIUM&quot;</span>
    <span class="n">LOW</span> <span class="o">=</span> <span class="s2">&quot;LOW&quot;</span>
    <span class="n">INFO</span> <span class="o">=</span> <span class="s2">&quot;INFO&quot;</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityFinding</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a security finding.&quot;&quot;&quot;</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">line_number</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">cwe</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">cvss</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">severity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Severity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="k">class</span><span class="w"> </span><span class="nc">SeverityClassifier</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Classify security findings by severity.&quot;&quot;&quot;</span>

    <span class="c1"># Keywords indicating critical severity</span>
    <span class="n">CRITICAL_KEYWORDS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;remote code execution&quot;</span><span class="p">,</span> <span class="s2">&quot;rce&quot;</span><span class="p">,</span> <span class="s2">&quot;sql injection&quot;</span><span class="p">,</span> <span class="s2">&quot;command injection&quot;</span><span class="p">,</span>
        <span class="s2">&quot;authentication bypass&quot;</span><span class="p">,</span> <span class="s2">&quot;privilege escalation&quot;</span><span class="p">,</span> <span class="s2">&quot;hardcoded secret&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hardcoded password&quot;</span><span class="p">,</span> <span class="s2">&quot;hardcoded credential&quot;</span><span class="p">,</span> <span class="s2">&quot;insecure deserialization&quot;</span><span class="p">,</span>
        <span class="s2">&quot;arbitrary file write&quot;</span><span class="p">,</span> <span class="s2">&quot;arbitrary file read&quot;</span><span class="p">,</span> <span class="s2">&quot;path traversal&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="c1"># Keywords indicating high severity</span>
    <span class="n">HIGH_KEYWORDS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;xss&quot;</span><span class="p">,</span> <span class="s2">&quot;cross-site scripting&quot;</span><span class="p">,</span> <span class="s2">&quot;ssrf&quot;</span><span class="p">,</span> <span class="s2">&quot;server-side request forgery&quot;</span><span class="p">,</span>
        <span class="s2">&quot;weak encryption&quot;</span><span class="p">,</span> <span class="s2">&quot;broken access control&quot;</span><span class="p">,</span> <span class="s2">&quot;sensitive data exposure&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ldap injection&quot;</span><span class="p">,</span> <span class="s2">&quot;xpath injection&quot;</span><span class="p">,</span> <span class="s2">&quot;xml injection&quot;</span><span class="p">,</span> <span class="s2">&quot;missing auth&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="c1"># CVSS to severity mapping</span>
    <span class="n">CVSS_THRESHOLDS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mf">9.0</span><span class="p">:</span> <span class="n">Severity</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">,</span>
        <span class="mf">7.0</span><span class="p">:</span> <span class="n">Severity</span><span class="o">.</span><span class="n">HIGH</span><span class="p">,</span>
        <span class="mf">4.0</span><span class="p">:</span> <span class="n">Severity</span><span class="o">.</span><span class="n">MEDIUM</span><span class="p">,</span>
        <span class="mf">0.1</span><span class="p">:</span> <span class="n">Severity</span><span class="o">.</span><span class="n">LOW</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">:</span> <span class="n">Severity</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">classify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">finding</span><span class="p">:</span> <span class="n">SecurityFinding</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Severity</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Classify a finding&#39;s severity.&quot;&quot;&quot;</span>
        <span class="c1"># If CVSS is provided, use it</span>
        <span class="k">if</span> <span class="n">finding</span><span class="o">.</span><span class="n">cvss</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_classify_by_cvss</span><span class="p">(</span><span class="n">finding</span><span class="o">.</span><span class="n">cvss</span><span class="p">)</span>

        <span class="c1"># Check for critical keywords</span>
        <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">CRITICAL_KEYWORDS</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Severity</span><span class="o">.</span><span class="n">CRITICAL</span>

        <span class="c1"># Check for high keywords</span>
        <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">HIGH_KEYWORDS</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Severity</span><span class="o">.</span><span class="n">HIGH</span>

        <span class="c1"># Default to medium for unclassified security issues</span>
        <span class="k">return</span> <span class="n">Severity</span><span class="o">.</span><span class="n">MEDIUM</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_classify_by_cvss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cvss</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Severity</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Classify severity based on CVSS score.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">severity</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CVSS_THRESHOLDS</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">cvss</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">severity</span>
        <span class="k">return</span> <span class="n">Severity</span><span class="o">.</span><span class="n">INFO</span>


<span class="k">def</span><span class="w"> </span><span class="nf">classify_findings</span><span class="p">(</span><span class="n">findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SecurityFinding</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Severity</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">SecurityFinding</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Classify and group findings by severity.&quot;&quot;&quot;</span>
    <span class="n">classifier</span> <span class="o">=</span> <span class="n">SeverityClassifier</span><span class="p">()</span>
    <span class="n">classified</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Severity</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">SecurityFinding</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">s</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">Severity</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">findings</span><span class="p">:</span>
        <span class="n">severity</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">classify</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
        <span class="n">finding</span><span class="o">.</span><span class="n">severity</span> <span class="o">=</span> <span class="n">severity</span>
        <span class="n">classified</span><span class="p">[</span><span class="n">severity</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">classified</span>
</code></pre></div>
<hr />
<h2 id="false-positive-management">False Positive Management<a class="headerlink" href="#false-positive-management" title="Permanent link">&para;</a></h2>
<h3 id="false-positive-handling-workflow">False Positive Handling Workflow<a class="headerlink" href="#false-positive-handling-workflow" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>
                   False Positive Handling Workflow                   

                                                                     
  1. Finding Identified                                              
                                                                    
                                                                    
  2. Developer Reviews                                               
                                                                    
          Confirmed Vulnerability  Fix Required               
                                                                    
                                                                    
  3. False Positive?                                                 
                                                                    
          Create Suppression Request                             
                                                                    
                                                                    
  4. Security Team Reviews                                           
                                                                    
          Approve  Add to Baseline/Suppression                
                                                                    
          Reject  Developer Must Fix                          
                                                                     
  5. Document Decision                                               
                                                                    
                                                                    
  6. Update Suppression Files                                        
                                                                     

</code></pre></div>
<h3 id="unified-suppression-configuration">Unified Suppression Configuration<a class="headerlink" href="#unified-suppression-configuration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .security/suppressions.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span>
<span class="nt">last_updated</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2025-01-24&quot;</span>

<span class="nt">suppressions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Semgrep suppressions</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">semgrep</span>
<span class="w">    </span><span class="nt">rule_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-sql-injection</span>
<span class="w">    </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">src/legacy/reports.py</span>
<span class="w">    </span><span class="nt">line</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">45</span>
<span class="w">    </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Legacy</span><span class="nv"> </span><span class="s">code</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">input</span><span class="nv"> </span><span class="s">validation</span><span class="nv"> </span><span class="s">at</span><span class="nv"> </span><span class="s">controller</span><span class="nv"> </span><span class="s">level&quot;</span>
<span class="w">    </span><span class="nt">approved_by</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security-team&quot;</span>
<span class="w">    </span><span class="nt">approved_date</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2025-01-15&quot;</span>
<span class="w">    </span><span class="nt">expires</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2025-07-15&quot;</span>
<span class="w">    </span><span class="nt">jira_ticket</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;SEC-123&quot;</span>

<span class="w">  </span><span class="c1"># Bandit suppressions</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bandit</span>
<span class="w">    </span><span class="nt">rule_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">B608</span>
<span class="w">    </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">src/utils/shell.py</span>
<span class="w">    </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Input</span><span class="nv"> </span><span class="s">sanitized</span><span class="nv"> </span><span class="s">via</span><span class="nv"> </span><span class="s">allowlist</span><span class="nv"> </span><span class="s">pattern&quot;</span>
<span class="w">    </span><span class="nt">approved_by</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security-team&quot;</span>
<span class="w">    </span><span class="nt">approved_date</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2025-01-10&quot;</span>
<span class="w">    </span><span class="nt">expires</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2025-07-10&quot;</span>
<span class="w">    </span><span class="nt">jira_ticket</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;SEC-120&quot;</span>

<span class="w">  </span><span class="c1"># gosec suppressions</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gosec</span>
<span class="w">    </span><span class="nt">rule_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">G104</span>
<span class="w">    </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">internal/logger/logger.go</span>
<span class="w">    </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Error</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">logged,</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">returned</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">design</span><span class="nv"> </span><span class="s">decision&quot;</span>
<span class="w">    </span><span class="nt">approved_by</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security-team&quot;</span>
<span class="w">    </span><span class="nt">approved_date</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2025-01-12&quot;</span>
<span class="w">    </span><span class="nt">expires</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span><span class="w">  </span><span class="c1"># Permanent suppression</span>
<span class="w">    </span><span class="nt">jira_ticket</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;SEC-121&quot;</span>

<span class="w">  </span><span class="c1"># Trivy suppressions</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trivy</span>
<span class="w">    </span><span class="nt">cve</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CVE-2023-12345</span>
<span class="w">    </span><span class="nt">package</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lodash</span>
<span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4.17.21&quot;</span>
<span class="w">    </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Vulnerability</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">exploitable</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">our</span><span class="nv"> </span><span class="s">usage</span><span class="nv"> </span><span class="s">context&quot;</span>
<span class="w">    </span><span class="nt">approved_by</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security-team&quot;</span>
<span class="w">    </span><span class="nt">approved_date</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2025-01-05&quot;</span>
<span class="w">    </span><span class="nt">expires</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2025-04-05&quot;</span>
<span class="w">    </span><span class="nt">jira_ticket</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;SEC-115&quot;</span>

<span class="c1"># Global policies</span>
<span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="nt">max_suppression_duration_days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">180</span>
<span class="w">  </span><span class="nt">require_jira_ticket</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">require_security_approval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_expire_on_file_change</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<h3 id="inline-suppression-standards">Inline Suppression Standards<a class="headerlink" href="#inline-suppression-standards" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Python - Bandit suppression</span>
<span class="k">def</span><span class="w"> </span><span class="nf">execute_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute shell command with proper sanitization.&quot;&quot;&quot;</span>
    <span class="n">sanitized</span> <span class="o">=</span> <span class="n">sanitize_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="c1"># nosec B602 - Input sanitized via allowlist pattern</span>
    <span class="c1"># Approved: SEC-123, Expires: 2025-07-15</span>
    <span class="k">return</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="n">sanitized</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># nosec B602</span>


<span class="c1"># Python - Semgrep suppression</span>
<span class="k">def</span><span class="w"> </span><span class="nf">build_query</span><span class="p">(</span><span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">conditions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build parameterized query.&quot;&quot;&quot;</span>
    <span class="c1"># nosemgrep: python-sql-injection</span>
    <span class="c1"># Reason: Using parameterized query builder, not string concatenation</span>
    <span class="k">return</span> <span class="n">QueryBuilder</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">// Go - gosec suppression</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">processFile</span><span class="p">(</span><span class="nx">path</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// #nosec G304 - Path validated against allowlist</span>
<span class="w">    </span><span class="c1">// Approved: SEC-121, Expires: 2025-06-01</span>
<span class="w">    </span><span class="nx">data</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">os</span><span class="p">.</span><span class="nx">ReadFile</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">err</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">process</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">// JavaScript - ESLint suppression</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">executeUserCode</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// eslint-disable-next-line security/detect-eval-with-expression</span>
<span class="w">  </span><span class="c1">// Reason: Code is sandboxed via VM2 with strict timeout</span>
<span class="w">  </span><span class="c1">// Approved: SEC-130, Expires: 2025-08-01</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">sandbox</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="nx">code</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="false-positive-tracking-script">False Positive Tracking Script<a class="headerlink" href="#false-positive-tracking-script" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># scripts/security/track_suppressions.py</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Track and validate security suppressions.</span>

<span class="sd">@module track_suppressions</span>
<span class="sd">@description Manage and audit security suppressions</span>
<span class="sd">@version 1.0.0</span>
<span class="sd">@author Tyler Dukes</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Suppression</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a security suppression.&quot;&quot;&quot;</span>
    <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">rule_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">file</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">reason</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">approved_by</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">approved_date</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">expires</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">jira_ticket</span><span class="p">:</span> <span class="nb">str</span>


<span class="k">def</span><span class="w"> </span><span class="nf">load_suppressions</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.security/suppressions.yml&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Suppression</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load suppressions from configuration file.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span>
        <span class="n">Suppression</span><span class="p">(</span><span class="o">**</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;suppressions&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">check_expired_suppressions</span><span class="p">(</span><span class="n">suppressions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Suppression</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Suppression</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find expired suppressions.&quot;&quot;&quot;</span>
    <span class="n">today</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
    <span class="n">expired</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">suppressions</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">expires</span><span class="p">:</span>
            <span class="n">expires_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">expires</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">expires_date</span> <span class="o">&lt;</span> <span class="n">today</span><span class="p">:</span>
                <span class="n">expired</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">expired</span>


<span class="k">def</span><span class="w"> </span><span class="nf">check_expiring_soon</span><span class="p">(</span>
    <span class="n">suppressions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Suppression</span><span class="p">],</span>
    <span class="n">days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Suppression</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find suppressions expiring within specified days.&quot;&quot;&quot;</span>
    <span class="n">today</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
    <span class="n">threshold</span> <span class="o">=</span> <span class="n">today</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">days</span><span class="p">)</span>
    <span class="n">expiring</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">suppressions</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">expires</span><span class="p">:</span>
            <span class="n">expires_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">expires</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">today</span> <span class="o">&lt;=</span> <span class="n">expires_date</span> <span class="o">&lt;=</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="n">expiring</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">expiring</span>


<span class="k">def</span><span class="w"> </span><span class="nf">generate_report</span><span class="p">(</span><span class="n">suppressions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Suppression</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate suppression audit report.&quot;&quot;&quot;</span>
    <span class="n">expired</span> <span class="o">=</span> <span class="n">check_expired_suppressions</span><span class="p">(</span><span class="n">suppressions</span><span class="p">)</span>
    <span class="n">expiring_soon</span> <span class="o">=</span> <span class="n">check_expiring_soon</span><span class="p">(</span><span class="n">suppressions</span><span class="p">)</span>

    <span class="n">by_tool</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">suppressions</span><span class="p">:</span>
        <span class="n">by_tool</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">tool</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;total_suppressions&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">suppressions</span><span class="p">),</span>
        <span class="s2">&quot;expired&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">expired</span><span class="p">),</span>
        <span class="s2">&quot;expiring_in_30_days&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">expiring_soon</span><span class="p">),</span>
        <span class="s2">&quot;by_tool&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">tool</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="k">for</span> <span class="n">tool</span><span class="p">,</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">by_tool</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
        <span class="s2">&quot;expired_details&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;tool&quot;</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">tool</span><span class="p">,</span> <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">rule_id</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;expires&quot;</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">expires</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">expired</span>
        <span class="p">],</span>
        <span class="s2">&quot;expiring_details&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;tool&quot;</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">tool</span><span class="p">,</span> <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">rule_id</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;expires&quot;</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">expires</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">expiring_soon</span>
        <span class="p">],</span>
    <span class="p">}</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">suppressions</span> <span class="o">=</span> <span class="n">load_suppressions</span><span class="p">()</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">generate_report</span><span class="p">(</span><span class="n">suppressions</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total suppressions: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;total_suppressions&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expired: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;expired&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expiring in 30 days: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;expiring_in_30_days&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;expired_details&#39;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Expired suppressions:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;expired_details&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;tool&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;rule&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="security-gate-policies">Security Gate Policies<a class="headerlink" href="#security-gate-policies" title="Permanent link">&para;</a></h2>
<h3 id="gate-configuration">Gate Configuration<a class="headerlink" href="#gate-configuration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .security/gates.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span>

<span class="nt">gates</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Pre-commit gate (local development)</span>
<span class="w">  </span><span class="nt">pre_commit</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">blocking</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w">  </span><span class="c1"># Warn only</span>
<span class="w">    </span><span class="nt">checks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secret_detection</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sast_quick</span>
<span class="w">    </span><span class="nt">thresholds</span><span class="p">:</span>
<span class="w">      </span><span class="nt">critical</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">      </span><span class="nt">high</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>

<span class="w">  </span><span class="c1"># Pull request gate</span>
<span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">blocking</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">checks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secret_detection</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sast_full</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dependency_scan</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">container_scan</span>
<span class="w">    </span><span class="nt">thresholds</span><span class="p">:</span>
<span class="w">      </span><span class="nt">critical</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">      </span><span class="nt">high</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">      </span><span class="nt">medium</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">exceptions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;docs/**&quot;</span>
<span class="w">        </span><span class="nt">skip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sast_full</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">container_scan</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tests/**&quot;</span>
<span class="w">        </span><span class="nt">thresholds</span><span class="p">:</span>
<span class="w">          </span><span class="nt">medium</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>

<span class="w">  </span><span class="c1"># Main branch gate</span>
<span class="w">  </span><span class="nt">main_branch</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">blocking</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">checks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secret_detection</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sast_full</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dependency_scan</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">container_scan</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">infrastructure_scan</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dast_baseline</span>
<span class="w">    </span><span class="nt">thresholds</span><span class="p">:</span>
<span class="w">      </span><span class="nt">critical</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">      </span><span class="nt">high</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">      </span><span class="nt">medium</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">      </span><span class="nt">low</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>

<span class="w">  </span><span class="c1"># Release gate</span>
<span class="w">  </span><span class="nt">release</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">blocking</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">checks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secret_detection</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sast_full</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dependency_scan</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">container_scan</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">infrastructure_scan</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dast_full</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compliance_scan</span>
<span class="w">    </span><span class="nt">thresholds</span><span class="p">:</span>
<span class="w">      </span><span class="nt">critical</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">      </span><span class="nt">high</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">      </span><span class="nt">medium</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">      </span><span class="nt">low</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="w">    </span><span class="nt">require_manual_approval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="c1"># Check definitions</span>
<span class="nt">checks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">secret_detection</span><span class="p">:</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">gitleaks</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">trufflehog</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">fail_on_any</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">  </span><span class="nt">sast_quick</span><span class="p">:</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">semgrep</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">configs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">p/security-audit</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300</span>

<span class="w">  </span><span class="nt">sast_full</span><span class="p">:</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">semgrep</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">bandit</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">eslint-security</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">gosec</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">configs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">semgrep</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">p/security-audit</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">p/owasp-top-ten</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">900</span>

<span class="w">  </span><span class="nt">dependency_scan</span><span class="p">:</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">snyk</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">trivy</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">severity_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">high</span>

<span class="w">  </span><span class="nt">container_scan</span><span class="p">:</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">trivy</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">severity_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">high</span>
<span class="w">    </span><span class="nt">ignore_unfixed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">  </span><span class="nt">infrastructure_scan</span><span class="p">:</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">checkov</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">tfsec</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">frameworks</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">terraform</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">kubernetes</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">dockerfile</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">dast_baseline</span><span class="p">:</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">zap</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">scan_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">baseline</span>
<span class="w">    </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">staging</span>

<span class="w">  </span><span class="nt">dast_full</span><span class="p">:</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">zap</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">nuclei</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">scan_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">full</span>
<span class="w">    </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">staging</span>

<span class="w">  </span><span class="nt">compliance_scan</span><span class="p">:</span>
<span class="w">    </span><span class="nt">tools</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">inspec</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">profiles</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">cis-benchmark</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">pci-dss</span><span class="p p-Indicator">]</span>
</code></pre></div>
<h3 id="gate-implementation">Gate Implementation<a class="headerlink" href="#gate-implementation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># scripts/security/gate_checker.py</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Security gate checker for CI/CD pipelines.</span>

<span class="sd">@module gate_checker</span>
<span class="sd">@description Enforce security gates in pipelines</span>
<span class="sd">@version 1.0.0</span>
<span class="sd">@author Tyler Dukes</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>


<span class="k">class</span><span class="w"> </span><span class="nc">GateResult</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">PASS</span> <span class="o">=</span> <span class="s2">&quot;pass&quot;</span>
    <span class="n">WARN</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span>
    <span class="n">FAIL</span> <span class="o">=</span> <span class="s2">&quot;fail&quot;</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Finding</span><span class="p">:</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">rule_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">message</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">file</span><span class="p">:</span> <span class="nb">str</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">GateCheckResult</span><span class="p">:</span>
    <span class="n">gate_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">result</span><span class="p">:</span> <span class="n">GateResult</span>
    <span class="n">findings_count</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
    <span class="n">thresholds</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
    <span class="n">violations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">load_gate_config</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.security/gates.yml&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load gate configuration.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">count_findings_by_severity</span><span class="p">(</span><span class="n">findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Finding</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Count findings by severity level.&quot;&quot;&quot;</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;critical&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">findings</span><span class="p">:</span>
        <span class="n">severity</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">severity</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">severity</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">:</span>
            <span class="n">counts</span><span class="p">[</span><span class="n">severity</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">counts</span>


<span class="k">def</span><span class="w"> </span><span class="nf">check_gate</span><span class="p">(</span>
    <span class="n">gate_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Finding</span><span class="p">],</span>
    <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GateCheckResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if findings pass the specified gate.&quot;&quot;&quot;</span>
    <span class="n">gate_config</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gates&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">gate_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">gate_config</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown gate: </span><span class="si">{</span><span class="n">gate_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">gate_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">GateCheckResult</span><span class="p">(</span>
            <span class="n">gate_name</span><span class="o">=</span><span class="n">gate_name</span><span class="p">,</span>
            <span class="n">result</span><span class="o">=</span><span class="n">GateResult</span><span class="o">.</span><span class="n">PASS</span><span class="p">,</span>
            <span class="n">findings_count</span><span class="o">=</span><span class="p">{},</span>
            <span class="n">thresholds</span><span class="o">=</span><span class="p">{},</span>
            <span class="n">violations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Gate disabled&quot;</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="n">counts</span> <span class="o">=</span> <span class="n">count_findings_by_severity</span><span class="p">(</span><span class="n">findings</span><span class="p">)</span>
    <span class="n">thresholds</span> <span class="o">=</span> <span class="n">gate_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;thresholds&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="n">violations</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">severity</span><span class="p">,</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="n">thresholds</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">severity</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">actual</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">:</span>
            <span class="n">violations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">severity</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">actual</span><span class="si">}</span><span class="s2"> findings exceed threshold of </span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">violations</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">GateResult</span><span class="o">.</span><span class="n">FAIL</span> <span class="k">if</span> <span class="n">gate_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;blocking&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="k">else</span> <span class="n">GateResult</span><span class="o">.</span><span class="n">WARN</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">GateResult</span><span class="o">.</span><span class="n">PASS</span>

    <span class="k">return</span> <span class="n">GateCheckResult</span><span class="p">(</span>
        <span class="n">gate_name</span><span class="o">=</span><span class="n">gate_name</span><span class="p">,</span>
        <span class="n">result</span><span class="o">=</span><span class="n">result</span><span class="p">,</span>
        <span class="n">findings_count</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span>
        <span class="n">thresholds</span><span class="o">=</span><span class="n">thresholds</span><span class="p">,</span>
        <span class="n">violations</span><span class="o">=</span><span class="n">violations</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Main entry point for gate checker.&quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Security gate checker&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--gate&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Gate to check&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--findings&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Findings JSON file&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--config&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;.security/gates.yml&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Gate config&quot;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="n">config</span> <span class="o">=</span> <span class="n">load_gate_config</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">findings</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">findings_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">findings</span> <span class="o">=</span> <span class="p">[</span><span class="n">Finding</span><span class="p">(</span><span class="o">**</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">findings_data</span><span class="p">]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">check_gate</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gate</span><span class="p">,</span> <span class="n">findings</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Security Gate: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">gate_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Findings by severity:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">severity</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">findings_count</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">thresholds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">severity</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
        <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">count</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">threshold</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="mi">999</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">severity</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> (threshold: </span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">violations</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Violations:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">violations</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">result</span> <span class="o">==</span> <span class="n">GateResult</span><span class="o">.</span><span class="n">PASS</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
<h3 id="github-actions-gate-integration">GitHub Actions Gate Integration<a class="headerlink" href="#github-actions-gate-integration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .github/workflows/security-gate.yml</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Security Gate</span>

<span class="nt">on</span><span class="p">:</span>
<span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">push</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">]</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">security-scan</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">outputs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">findings_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ steps.aggregate.outputs.findings_file }}</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret Detection</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gitleaks/gitleaks-action@v2</span>
<span class="w">        </span><span class="nt">continue-on-error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SAST - Semgrep</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">returntocorp/semgrep-action@v1</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">p/security-audit p/owasp-top-ten</span>
<span class="w">          </span><span class="nt">generateSarif</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">continue-on-error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SAST - Bandit</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">pip install bandit</span>
<span class="w">          </span><span class="no">bandit -r src/ -f json -o bandit-results.json || true</span>
<span class="w">        </span><span class="nt">continue-on-error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Dependency Scan</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">snyk/actions/python@master</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">          </span><span class="nt">SNYK_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.SNYK_TOKEN }}</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--json-file-output=snyk-results.json</span>
<span class="w">        </span><span class="nt">continue-on-error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Aggregate Results</span>
<span class="w">        </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aggregate</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">python scripts/security/aggregate_findings.py \</span>
<span class="w">            </span><span class="no">--semgrep semgrep.sarif \</span>
<span class="w">            </span><span class="no">--bandit bandit-results.json \</span>
<span class="w">            </span><span class="no">--snyk snyk-results.json \</span>
<span class="w">            </span><span class="no">--output findings.json</span>
<span class="w">          </span><span class="no">echo &quot;findings_file=findings.json&quot; &gt;&gt; $GITHUB_OUTPUT</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload Findings</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/upload-artifact@v4</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-findings</span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">findings.json</span>

<span class="w">  </span><span class="nt">gate-check</span><span class="p">:</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-scan</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download Findings</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/download-artifact@v4</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-findings</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Determine Gate</span>
<span class="w">        </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gate</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">if [[ &quot;${{ github.event_name }}&quot; == &quot;pull_request&quot; ]]; then</span>
<span class="w">            </span><span class="no">echo &quot;gate=pull_request&quot; &gt;&gt; $GITHUB_OUTPUT</span>
<span class="w">          </span><span class="no">else</span>
<span class="w">            </span><span class="no">echo &quot;gate=main_branch&quot; &gt;&gt; $GITHUB_OUTPUT</span>
<span class="w">          </span><span class="no">fi</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Check Security Gate</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">python scripts/security/gate_checker.py \</span>
<span class="w">            </span><span class="no">--gate ${{ steps.gate.outputs.gate }} \</span>
<span class="w">            </span><span class="no">--findings findings.json \</span>
<span class="w">            </span><span class="no">--config .security/gates.yml</span>
</code></pre></div>
<hr />
<h2 id="remediation-slas">Remediation SLAs<a class="headerlink" href="#remediation-slas" title="Permanent link">&para;</a></h2>
<h3 id="sla-definitions">SLA Definitions<a class="headerlink" href="#sla-definitions" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>
 Severity  SLA          Requirements                                    

 CRITICAL  24 hours     - Immediate notification to security team       
                        - Incident response activation if needed        
                        - Hotfix deployment within SLA                  
                        - Post-incident review required                 

 HIGH      7 days       - Security team notification within 24h        
                        - Assigned owner within 48h                     
                        - Fix in next sprint or hotfix                  
                        - Testing required before deployment            

 MEDIUM    30 days      - Tracked in issue tracker                      
                        - Assigned owner within 1 week                  
                        - Scheduled for regular release                 
                        - Standard review process                       

 LOW       90 days      - Tracked in backlog                            
                        - Addressed during regular maintenance          
                        - Can be grouped with related fixes             
                        - May be deprioritized if resources limited     

 INFO      Best effort  - Tracked for awareness                         
                        - Addressed opportunistically                   
                        - No SLA enforcement                            

</code></pre></div>
<h3 id="sla-configuration">SLA Configuration<a class="headerlink" href="#sla-configuration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .security/sla.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span>

<span class="nt">sla_definitions</span><span class="p">:</span>
<span class="w">  </span><span class="nt">critical</span><span class="p">:</span>
<span class="w">    </span><span class="nt">response_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1h</span>
<span class="w">    </span><span class="nt">resolution_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">24h</span>
<span class="w">    </span><span class="nt">escalation_path</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-team</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">engineering-leads</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cto</span>
<span class="w">    </span><span class="nt">notifications</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">channel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slack</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;#security-alerts&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">channel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pagerduty</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-oncall</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">channel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">email</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security@example.com</span>

<span class="w">  </span><span class="nt">high</span><span class="p">:</span>
<span class="w">    </span><span class="nt">response_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">24h</span>
<span class="w">    </span><span class="nt">resolution_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7d</span>
<span class="w">    </span><span class="nt">escalation_path</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-team</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">engineering-leads</span>
<span class="w">    </span><span class="nt">notifications</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">channel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slack</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;#security-alerts&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">channel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">email</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security@example.com</span>

<span class="w">  </span><span class="nt">medium</span><span class="p">:</span>
<span class="w">    </span><span class="nt">response_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1w</span>
<span class="w">    </span><span class="nt">resolution_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30d</span>
<span class="w">    </span><span class="nt">escalation_path</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-team</span>
<span class="w">    </span><span class="nt">notifications</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">channel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slack</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;#security-findings&quot;</span>

<span class="w">  </span><span class="nt">low</span><span class="p">:</span>
<span class="w">    </span><span class="nt">response_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2w</span>
<span class="w">    </span><span class="nt">resolution_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">90d</span>
<span class="w">    </span><span class="nt">notifications</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">channel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slack</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;#security-findings&quot;</span>

<span class="c1"># Escalation rules</span>
<span class="nt">escalation</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Escalate if SLA is 75% expired</span>
<span class="w">  </span><span class="nt">warning_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.75</span>
<span class="w">  </span><span class="c1"># Escalate if SLA is 100% expired</span>
<span class="w">  </span><span class="nt">breach_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>

<span class="w">  </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">    </span><span class="nt">warning</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">notify_owner</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">notify_team_lead</span>
<span class="w">    </span><span class="nt">breach</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">notify_security_team</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">create_incident</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">block_deployments</span><span class="w">  </span><span class="c1"># For critical/high only</span>
</code></pre></div>
<h3 id="sla-tracking-script">SLA Tracking Script<a class="headerlink" href="#sla-tracking-script" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># scripts/security/sla_tracker.py</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Track and enforce security SLAs.</span>

<span class="sd">@module sla_tracker</span>
<span class="sd">@description Monitor and report on security finding SLAs</span>
<span class="sd">@version 1.0.0</span>
<span class="sd">@author Tyler Dukes</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>


<span class="k">class</span><span class="w"> </span><span class="nc">SLAStatus</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">ON_TRACK</span> <span class="o">=</span> <span class="s2">&quot;on_track&quot;</span>
    <span class="n">WARNING</span> <span class="o">=</span> <span class="s2">&quot;warning&quot;</span>
    <span class="n">BREACHED</span> <span class="o">=</span> <span class="s2">&quot;breached&quot;</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SLAConfig</span><span class="p">:</span>
    <span class="n">response_time</span><span class="p">:</span> <span class="n">timedelta</span>
    <span class="n">resolution_time</span><span class="p">:</span> <span class="n">timedelta</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TrackedFinding</span><span class="p">:</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">created_at</span><span class="p">:</span> <span class="n">datetime</span>
    <span class="n">response_at</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span>
    <span class="n">resolved_at</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span>
    <span class="n">owner</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">parse_duration</span><span class="p">(</span><span class="n">duration_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">timedelta</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse duration string (e.g., &#39;24h&#39;, &#39;7d&#39;) to timedelta.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">duration_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">duration_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">duration_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">duration_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">duration_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">weeks</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">duration_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown duration format: </span><span class="si">{</span><span class="n">duration_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">load_sla_config</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.security/sla.yml&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">SLAConfig</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load SLA configuration.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">sla_configs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">severity</span><span class="p">,</span> <span class="n">sla_def</span> <span class="ow">in</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;sla_definitions&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">sla_configs</span><span class="p">[</span><span class="n">severity</span><span class="p">]</span> <span class="o">=</span> <span class="n">SLAConfig</span><span class="p">(</span>
            <span class="n">response_time</span><span class="o">=</span><span class="n">parse_duration</span><span class="p">(</span><span class="n">sla_def</span><span class="p">[</span><span class="s2">&quot;response_time&quot;</span><span class="p">]),</span>
            <span class="n">resolution_time</span><span class="o">=</span><span class="n">parse_duration</span><span class="p">(</span><span class="n">sla_def</span><span class="p">[</span><span class="s2">&quot;resolution_time&quot;</span><span class="p">]),</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">sla_configs</span>


<span class="k">def</span><span class="w"> </span><span class="nf">check_sla_status</span><span class="p">(</span>
    <span class="n">finding</span><span class="p">:</span> <span class="n">TrackedFinding</span><span class="p">,</span>
    <span class="n">sla_config</span><span class="p">:</span> <span class="n">SLAConfig</span><span class="p">,</span>
    <span class="n">warning_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.75</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check SLA status for a finding.&quot;&quot;&quot;</span>
    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">elapsed</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">finding</span><span class="o">.</span><span class="n">created_at</span>

    <span class="c1"># Check response SLA</span>
    <span class="n">response_status</span> <span class="o">=</span> <span class="n">SLAStatus</span><span class="o">.</span><span class="n">ON_TRACK</span>
    <span class="k">if</span> <span class="n">finding</span><span class="o">.</span><span class="n">response_at</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">response_elapsed_ratio</span> <span class="o">=</span> <span class="n">elapsed</span> <span class="o">/</span> <span class="n">sla_config</span><span class="o">.</span><span class="n">response_time</span>
        <span class="k">if</span> <span class="n">response_elapsed_ratio</span> <span class="o">&gt;=</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">response_status</span> <span class="o">=</span> <span class="n">SLAStatus</span><span class="o">.</span><span class="n">BREACHED</span>
        <span class="k">elif</span> <span class="n">response_elapsed_ratio</span> <span class="o">&gt;=</span> <span class="n">warning_threshold</span><span class="p">:</span>
            <span class="n">response_status</span> <span class="o">=</span> <span class="n">SLAStatus</span><span class="o">.</span><span class="n">WARNING</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">response_time</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">response_at</span> <span class="o">-</span> <span class="n">finding</span><span class="o">.</span><span class="n">created_at</span>
        <span class="k">if</span> <span class="n">response_time</span> <span class="o">&gt;</span> <span class="n">sla_config</span><span class="o">.</span><span class="n">response_time</span><span class="p">:</span>
            <span class="n">response_status</span> <span class="o">=</span> <span class="n">SLAStatus</span><span class="o">.</span><span class="n">BREACHED</span>

    <span class="c1"># Check resolution SLA</span>
    <span class="n">resolution_status</span> <span class="o">=</span> <span class="n">SLAStatus</span><span class="o">.</span><span class="n">ON_TRACK</span>
    <span class="k">if</span> <span class="n">finding</span><span class="o">.</span><span class="n">resolved_at</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">resolution_elapsed_ratio</span> <span class="o">=</span> <span class="n">elapsed</span> <span class="o">/</span> <span class="n">sla_config</span><span class="o">.</span><span class="n">resolution_time</span>
        <span class="k">if</span> <span class="n">resolution_elapsed_ratio</span> <span class="o">&gt;=</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">resolution_status</span> <span class="o">=</span> <span class="n">SLAStatus</span><span class="o">.</span><span class="n">BREACHED</span>
        <span class="k">elif</span> <span class="n">resolution_elapsed_ratio</span> <span class="o">&gt;=</span> <span class="n">warning_threshold</span><span class="p">:</span>
            <span class="n">resolution_status</span> <span class="o">=</span> <span class="n">SLAStatus</span><span class="o">.</span><span class="n">WARNING</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">resolution_time</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">resolved_at</span> <span class="o">-</span> <span class="n">finding</span><span class="o">.</span><span class="n">created_at</span>
        <span class="k">if</span> <span class="n">resolution_time</span> <span class="o">&gt;</span> <span class="n">sla_config</span><span class="o">.</span><span class="n">resolution_time</span><span class="p">:</span>
            <span class="n">resolution_status</span> <span class="o">=</span> <span class="n">SLAStatus</span><span class="o">.</span><span class="n">BREACHED</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;finding_id&quot;</span><span class="p">:</span> <span class="n">finding</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">finding</span><span class="o">.</span><span class="n">severity</span><span class="p">,</span>
        <span class="s2">&quot;response_sla&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">response_status</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="s2">&quot;deadline&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">finding</span><span class="o">.</span><span class="n">created_at</span> <span class="o">+</span> <span class="n">sla_config</span><span class="o">.</span><span class="n">response_time</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s2">&quot;met&quot;</span><span class="p">:</span> <span class="n">finding</span><span class="o">.</span><span class="n">response_at</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;resolution_sla&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">resolution_status</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="s2">&quot;deadline&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">finding</span><span class="o">.</span><span class="n">created_at</span> <span class="o">+</span> <span class="n">sla_config</span><span class="o">.</span><span class="n">resolution_time</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s2">&quot;met&quot;</span><span class="p">:</span> <span class="n">finding</span><span class="o">.</span><span class="n">resolved_at</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>


<span class="k">def</span><span class="w"> </span><span class="nf">generate_sla_report</span><span class="p">(</span><span class="n">findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">TrackedFinding</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate SLA compliance report.&quot;&quot;&quot;</span>
    <span class="n">sla_configs</span> <span class="o">=</span> <span class="n">load_sla_config</span><span class="p">()</span>

    <span class="n">report</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;generated_at&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
        <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;total_findings&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">findings</span><span class="p">),</span>
            <span class="s2">&quot;open_findings&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;sla_breaches&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;sla_warnings&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;by_severity&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;findings&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">findings</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">finding</span><span class="o">.</span><span class="n">severity</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sla_configs</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">sla_config</span> <span class="o">=</span> <span class="n">sla_configs</span><span class="p">[</span><span class="n">finding</span><span class="o">.</span><span class="n">severity</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">check_sla_status</span><span class="p">(</span><span class="n">finding</span><span class="p">,</span> <span class="n">sla_config</span><span class="p">)</span>
        <span class="n">report</span><span class="p">[</span><span class="s2">&quot;findings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">finding</span><span class="o">.</span><span class="n">resolved_at</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">report</span><span class="p">[</span><span class="s2">&quot;summary&quot;</span><span class="p">][</span><span class="s2">&quot;open_findings&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="s2">&quot;resolution_sla&quot;</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;breached&quot;</span><span class="p">:</span>
            <span class="n">report</span><span class="p">[</span><span class="s2">&quot;summary&quot;</span><span class="p">][</span><span class="s2">&quot;sla_breaches&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">status</span><span class="p">[</span><span class="s2">&quot;resolution_sla&quot;</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;warning&quot;</span><span class="p">:</span>
            <span class="n">report</span><span class="p">[</span><span class="s2">&quot;summary&quot;</span><span class="p">][</span><span class="s2">&quot;sla_warnings&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">report</span>
</code></pre></div>
<hr />
<h2 id="issue-tracker-integration">Issue Tracker Integration<a class="headerlink" href="#issue-tracker-integration" title="Permanent link">&para;</a></h2>
<h3 id="jira-integration">Jira Integration<a class="headerlink" href="#jira-integration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># scripts/security/jira_integration.py</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Jira integration for security findings.</span>

<span class="sd">@module jira_integration</span>
<span class="sd">@description Create and manage Jira issues for security findings</span>
<span class="sd">@version 1.0.0</span>
<span class="sd">@author Tyler Dukes</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jira</span><span class="w"> </span><span class="kn">import</span> <span class="n">JIRA</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityFinding</span><span class="p">:</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">line_number</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">cwe</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">recommendation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="k">class</span><span class="w"> </span><span class="nc">JiraSecurityIntegration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manage security findings in Jira.&quot;&quot;&quot;</span>

    <span class="n">SEVERITY_TO_PRIORITY</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;critical&quot;</span><span class="p">:</span> <span class="s2">&quot;Highest&quot;</span><span class="p">,</span>
        <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span>
        <span class="s2">&quot;medium&quot;</span><span class="p">:</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
        <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span>
        <span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="s2">&quot;Lowest&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">server</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">api_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">project_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jira</span> <span class="o">=</span> <span class="n">JIRA</span><span class="p">(</span>
            <span class="n">server</span><span class="o">=</span><span class="n">server</span><span class="p">,</span>
            <span class="n">basic_auth</span><span class="o">=</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">api_token</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project_key</span> <span class="o">=</span> <span class="n">project_key</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_issue</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">finding</span><span class="p">:</span> <span class="n">SecurityFinding</span><span class="p">,</span>
        <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Jira issue for a security finding.&quot;&quot;&quot;</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span> <span class="ow">or</span> <span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">,</span> <span class="n">finding</span><span class="o">.</span><span class="n">tool</span><span class="p">,</span> <span class="n">finding</span><span class="o">.</span><span class="n">severity</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
        <span class="n">priority</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SEVERITY_TO_PRIORITY</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">finding</span><span class="o">.</span><span class="n">severity</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="s2">&quot;Medium&quot;</span><span class="p">)</span>

        <span class="n">description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_description</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>

        <span class="n">issue_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;project&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_key</span><span class="p">},</span>
            <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">severity</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span>
            <span class="s2">&quot;issuetype&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Bug&quot;</span><span class="p">},</span>
            <span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">priority</span><span class="p">},</span>
            <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="n">labels</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">components</span><span class="p">:</span>
            <span class="n">issue_dict</span><span class="p">[</span><span class="s2">&quot;components&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">c</span><span class="p">}</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">components</span><span class="p">]</span>

        <span class="n">issue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jira</span><span class="o">.</span><span class="n">create_issue</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="n">issue_dict</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">issue</span><span class="o">.</span><span class="n">key</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">finding</span><span class="p">:</span> <span class="n">SecurityFinding</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Format finding details for Jira description.&quot;&quot;&quot;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">h2. Security Finding Details</span>

<span class="s2">||Field||Value||</span>
<span class="s2">|Severity|</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">severity</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">|</span>
<span class="s2">|Tool|</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">tool</span><span class="si">}</span><span class="s2">|</span>
<span class="s2">|File|</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">line_number</span><span class="si">}</span><span class="s2">|</span>
<span class="s2">|CWE|</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">cwe</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="si">}</span><span class="s2">|</span>

<span class="s2">h2. Description</span>
<span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">description</span><span class="si">}</span>

<span class="s2">h2. Location</span>
<span class="se">{{</span><span class="s2">code</span><span class="se">}}</span>
<span class="s2">File: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span>
<span class="s2">Line: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">line_number</span><span class="si">}</span>
<span class="se">{{</span><span class="s2">code</span><span class="se">}}</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">finding</span><span class="o">.</span><span class="n">recommendation</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">h2. Recommendation</span>
<span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">recommendation</span><span class="si">}</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">description</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_existing_issue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">finding</span><span class="p">:</span> <span class="n">SecurityFinding</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find existing issue for a finding.&quot;&quot;&quot;</span>
        <span class="n">jql</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;project = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">project_key</span><span class="si">}</span><span class="s1"> AND &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;labels = &quot;security&quot; AND &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;labels = &quot;</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">tool</span><span class="si">}</span><span class="s1">&quot; AND &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;text ~ &quot;</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s1">&quot; AND &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;status not in (Done, Closed)&#39;</span>
        <span class="p">)</span>

        <span class="n">issues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jira</span><span class="o">.</span><span class="n">search_issues</span><span class="p">(</span><span class="n">jql</span><span class="p">,</span> <span class="n">maxResults</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">issues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">key</span> <span class="k">if</span> <span class="n">issues</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_or_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">finding</span><span class="p">:</span> <span class="n">SecurityFinding</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create new issue or update existing one.&quot;&quot;&quot;</span>
        <span class="n">existing_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_existing_issue</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">existing_key</span><span class="p">:</span>
            <span class="c1"># Add comment to existing issue</span>
            <span class="n">comment</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Finding still present in latest scan:</span><span class="se">\n</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">jira</span><span class="o">.</span><span class="n">add_comment</span><span class="p">(</span><span class="n">existing_key</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;updated&quot;</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="n">existing_key</span><span class="p">}</span>

        <span class="n">new_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_issue</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;created&quot;</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="n">new_key</span><span class="p">}</span>


<span class="k">def</span><span class="w"> </span><span class="nf">sync_findings_to_jira</span><span class="p">(</span><span class="n">findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SecurityFinding</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sync security findings to Jira.&quot;&quot;&quot;</span>
    <span class="n">integration</span> <span class="o">=</span> <span class="n">JiraSecurityIntegration</span><span class="p">(</span>
        <span class="n">server</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;JIRA_SERVER&quot;</span><span class="p">],</span>
        <span class="n">username</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;JIRA_USERNAME&quot;</span><span class="p">],</span>
        <span class="n">api_token</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;JIRA_API_TOKEN&quot;</span><span class="p">],</span>
        <span class="n">project_key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;JIRA_PROJECT_KEY&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">findings</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">integration</span><span class="o">.</span><span class="n">create_or_update</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;finding_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">id</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
<h3 id="github-issues-integration">GitHub Issues Integration<a class="headerlink" href="#github-issues-integration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># scripts/security/github_issues.py</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">GitHub Issues integration for security findings.</span>

<span class="sd">@module github_issues</span>
<span class="sd">@description Create and manage GitHub issues for security findings</span>
<span class="sd">@version 1.0.0</span>
<span class="sd">@author Tyler Dukes</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">github</span><span class="w"> </span><span class="kn">import</span> <span class="n">Github</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityFinding</span><span class="p">:</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">line_number</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">cwe</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">recommendation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="k">class</span><span class="w"> </span><span class="nc">GitHubSecurityIntegration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manage security findings in GitHub Issues.&quot;&quot;&quot;</span>

    <span class="n">SEVERITY_TO_LABELS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;critical&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">,</span> <span class="s2">&quot;priority:critical&quot;</span><span class="p">,</span> <span class="s2">&quot;severity:critical&quot;</span><span class="p">],</span>
        <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">,</span> <span class="s2">&quot;priority:high&quot;</span><span class="p">,</span> <span class="s2">&quot;severity:high&quot;</span><span class="p">],</span>
        <span class="s2">&quot;medium&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">,</span> <span class="s2">&quot;priority:medium&quot;</span><span class="p">,</span> <span class="s2">&quot;severity:medium&quot;</span><span class="p">],</span>
        <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">,</span> <span class="s2">&quot;priority:low&quot;</span><span class="p">,</span> <span class="s2">&quot;severity:low&quot;</span><span class="p">],</span>
        <span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">,</span> <span class="s2">&quot;severity:info&quot;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">repo</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">github</span> <span class="o">=</span> <span class="n">Github</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">get_repo</span><span class="p">(</span><span class="n">repo</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_issue</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">finding</span><span class="p">:</span> <span class="n">SecurityFinding</span><span class="p">,</span>
        <span class="n">additional_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a GitHub issue for a security finding.&quot;&quot;&quot;</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SEVERITY_TO_LABELS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">finding</span><span class="o">.</span><span class="n">severity</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
            <span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="o">.</span><span class="n">tool</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">additional_labels</span><span class="p">:</span>
            <span class="n">labels</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">additional_labels</span><span class="p">)</span>

        <span class="n">body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_body</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">severity</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">issue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repo</span><span class="o">.</span><span class="n">create_issue</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">issue</span><span class="o">.</span><span class="n">number</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_body</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">finding</span><span class="p">:</span> <span class="n">SecurityFinding</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Format finding details for issue body.&quot;&quot;&quot;</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;## Security Finding Details&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;| Field | Value |&quot;</span><span class="p">,</span>
            <span class="s2">&quot;|-------|-------|&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;| **Severity** | </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">severity</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> |&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;| **Tool** | </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">tool</span><span class="si">}</span><span class="s2"> |&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;| **File** | `</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">line_number</span><span class="si">}</span><span class="s2">` |&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;| **CWE** | </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">cwe</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="si">}</span><span class="s2"> |&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;## Description&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">finding</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;## Location&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;```&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;File: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Line: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">line_number</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;```&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="n">finding</span><span class="o">.</span><span class="n">recommendation</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;## Recommendation&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">finding</span><span class="o">.</span><span class="n">recommendation</span><span class="p">,</span>
            <span class="p">])</span>

        <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;---&quot;</span><span class="p">,</span>
            <span class="s2">&quot;*This issue was automatically created by the security scanning pipeline.*&quot;</span><span class="p">,</span>
        <span class="p">])</span>

        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_existing_issue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">finding</span><span class="p">:</span> <span class="n">SecurityFinding</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find existing open issue for a finding.&quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;repo:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repo</span><span class="o">.</span><span class="n">full_name</span><span class="si">}</span><span class="s1"> &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;is:issue is:open &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;label:security label:</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">tool</span><span class="si">}</span><span class="s1"> &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s1">&quot; in:body&#39;</span>
        <span class="p">)</span>

        <span class="n">issues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">search_issues</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="n">issues</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">issue</span><span class="o">.</span><span class="n">number</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_or_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">finding</span><span class="p">:</span> <span class="n">SecurityFinding</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create new issue or update existing one.&quot;&quot;&quot;</span>
        <span class="n">existing_number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_existing_issue</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">existing_number</span><span class="p">:</span>
            <span class="n">issue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repo</span><span class="o">.</span><span class="n">get_issue</span><span class="p">(</span><span class="n">existing_number</span><span class="p">)</span>
            <span class="n">comment</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Finding still present in latest scan:</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;**Tool:** </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">tool</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;**File:** `</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">line_number</span><span class="si">}</span><span class="s2">`</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">issue</span><span class="o">.</span><span class="n">create_comment</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;updated&quot;</span><span class="p">,</span> <span class="s2">&quot;number&quot;</span><span class="p">:</span> <span class="n">existing_number</span><span class="p">}</span>

        <span class="n">new_number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_issue</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;created&quot;</span><span class="p">,</span> <span class="s2">&quot;number&quot;</span><span class="p">:</span> <span class="n">new_number</span><span class="p">}</span>

<span class="k">def</span><span class="w"> </span><span class="nf">sync_findings_to_github</span><span class="p">(</span><span class="n">findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SecurityFinding</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sync security findings to GitHub Issues.&quot;&quot;&quot;</span>
    <span class="n">integration</span> <span class="o">=</span> <span class="n">GitHubSecurityIntegration</span><span class="p">(</span>
        <span class="n">token</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;GITHUB_TOKEN&quot;</span><span class="p">],</span>
        <span class="n">repo</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;GITHUB_REPOSITORY&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">findings</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">integration</span><span class="o">.</span><span class="n">create_or_update</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;finding_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">id</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
<h3 id="cicd-issue-creation">CI/CD Issue Creation<a class="headerlink" href="#cicd-issue-creation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .github/workflows/security-issues.yml</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Security Issue Management</span>

<span class="nt">on</span><span class="p">:</span>
<span class="w">  </span><span class="nt">workflow_run</span><span class="p">:</span>
<span class="w">    </span><span class="nt">workflows</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;Security</span><span class="nv"> </span><span class="s">Gate&quot;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">types</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">completed</span><span class="p p-Indicator">]</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">create-issues</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.event.workflow_run.conclusion == &#39;failure&#39; }}</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download Findings</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dawidd6/action-download-artifact@v2</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">workflow</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-gate.yml</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-findings</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create Issues for New Findings</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">          </span><span class="nt">GITHUB_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.GITHUB_TOKEN }}</span>
<span class="w">          </span><span class="nt">GITHUB_REPOSITORY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.repository }}</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">python scripts/security/github_issues.py \</span>
<span class="w">            </span><span class="no">--findings findings.json \</span>
<span class="w">            </span><span class="no">--severity-threshold medium</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Post Summary</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">echo &quot;## Security Issues Created&quot; &gt;&gt; $GITHUB_STEP_SUMMARY</span>
<span class="w">          </span><span class="no">echo &quot;&quot; &gt;&gt; $GITHUB_STEP_SUMMARY</span>
<span class="w">          </span><span class="no">cat issue-summary.md &gt;&gt; $GITHUB_STEP_SUMMARY</span>
</code></pre></div>
<hr />
<h2 id="security-dashboards">Security Dashboards<a class="headerlink" href="#security-dashboards" title="Permanent link">&para;</a></h2>
<p>Centralized security dashboards provide visibility into vulnerability trends,
compliance status, and remediation progress across all security tools.</p>
<h3 id="grafana-security-dashboard">Grafana Security Dashboard<a class="headerlink" href="#grafana-security-dashboard" title="Permanent link">&para;</a></h3>
<p><strong>Dashboard configuration</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;dashboard&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Security Scanning Dashboard&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;uid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;security-overview&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;vulnerabilities&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;compliance&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;timezone&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;browser&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;refresh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;5m&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;panels&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Critical Vulnerabilities (Last 30 Days)&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;stat&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;gridPos&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;w&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;h&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sum(security_vulnerabilities_total{severity=\&quot;critical\&quot;})&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Critical&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;options&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;colorMode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;graphMode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;area&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;fieldConfig&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;defaults&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;thresholds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;absolute&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;steps&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;color&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;green&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;color&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;color&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">}</span>
<span class="w">              </span><span class="p">]</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Vulnerabilities by Severity&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;piechart&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;gridPos&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;w&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;h&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sum by (severity) (security_vulnerabilities_total)&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{severity}}&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Vulnerability Trend&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;timeseries&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;gridPos&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;w&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;h&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sum by (severity) (security_vulnerabilities_total)&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{severity}}&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;options&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;tooltip&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;multi&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Mean Time to Remediation&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;gauge&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;gridPos&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;w&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;h&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;avg(security_remediation_time_hours)&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MTTR (hours)&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;options&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;showThresholdLabels&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;showThresholdMarkers&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;fieldConfig&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;defaults&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;h&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;thresholds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;absolute&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;steps&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;color&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;green&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;color&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;color&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;orange&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">72</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;color&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">168</span><span class="w"> </span><span class="p">}</span>
<span class="w">              </span><span class="p">]</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Vulnerabilities by Tool&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;barchart&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;gridPos&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;w&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;h&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sum by (tool, severity) (security_vulnerabilities_total)&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{tool}} - {{severity}}&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Compliance Score&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;gauge&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;gridPos&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;w&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;h&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;security_compliance_score&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Compliance&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;fieldConfig&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;defaults&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;percent&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;min&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;max&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;thresholds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;absolute&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;steps&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;color&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;color&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;orange&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">70</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;color&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">85</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;color&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;green&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">95</span><span class="w"> </span><span class="p">}</span>
<span class="w">              </span><span class="p">]</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SLA Compliance&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;table&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;gridPos&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;w&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;h&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;security_sla_compliance&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;table&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="prometheus-metrics-exporter">Prometheus Metrics Exporter<a class="headerlink" href="#prometheus-metrics-exporter" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;Security metrics exporter for Prometheus.&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">prometheus_client</span><span class="w"> </span><span class="kn">import</span> <span class="n">CollectorRegistry</span><span class="p">,</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">Gauge</span><span class="p">,</span> <span class="n">Histogram</span><span class="p">,</span> <span class="n">start_http_server</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityMetrics</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Container for security metrics.&quot;&quot;&quot;</span>

    <span class="n">registry</span><span class="p">:</span> <span class="n">CollectorRegistry</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize Prometheus metrics.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vulnerabilities_total</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span>
            <span class="s2">&quot;security_vulnerabilities_total&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Total number of vulnerabilities detected&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;tool&quot;</span><span class="p">,</span> <span class="s2">&quot;severity&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">],</span>
            <span class="n">registry</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vulnerabilities_open</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span>
            <span class="s2">&quot;security_vulnerabilities_open&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Number of open vulnerabilities&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;tool&quot;</span><span class="p">,</span> <span class="s2">&quot;severity&quot;</span><span class="p">],</span>
            <span class="n">registry</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">remediation_time</span> <span class="o">=</span> <span class="n">Histogram</span><span class="p">(</span>
            <span class="s2">&quot;security_remediation_time_hours&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Time to remediate vulnerabilities in hours&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;severity&quot;</span><span class="p">],</span>
            <span class="n">buckets</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">168</span><span class="p">,</span> <span class="mi">336</span><span class="p">,</span> <span class="mi">720</span><span class="p">],</span>
            <span class="n">registry</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">scan_duration</span> <span class="o">=</span> <span class="n">Histogram</span><span class="p">(</span>
            <span class="s2">&quot;security_scan_duration_seconds&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Duration of security scans&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;tool&quot;</span><span class="p">],</span>
            <span class="n">buckets</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">1800</span><span class="p">],</span>
            <span class="n">registry</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">compliance_score</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span>
            <span class="s2">&quot;security_compliance_score&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Compliance score percentage&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;framework&quot;</span><span class="p">],</span>
            <span class="n">registry</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sla_compliance</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span>
            <span class="s2">&quot;security_sla_compliance&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SLA compliance status (1=compliant, 0=non-compliant)&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;severity&quot;</span><span class="p">],</span>
            <span class="n">registry</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">false_positive_rate</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span>
            <span class="s2">&quot;security_false_positive_rate&quot;</span><span class="p">,</span>
            <span class="s2">&quot;False positive rate percentage&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;tool&quot;</span><span class="p">],</span>
            <span class="n">registry</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">,</span>
        <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">record_vulnerability</span><span class="p">(</span>
    <span class="n">metrics</span><span class="p">:</span> <span class="n">SecurityMetrics</span><span class="p">,</span>
    <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">remediation_hours</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Record a vulnerability finding.&quot;&quot;&quot;</span>
    <span class="n">metrics</span><span class="o">.</span><span class="n">vulnerabilities_total</span><span class="o">.</span><span class="n">labels</span><span class="p">(</span>
        <span class="n">tool</span><span class="o">=</span><span class="n">tool</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="n">severity</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">category</span>
    <span class="p">)</span><span class="o">.</span><span class="n">inc</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">remediation_hours</span><span class="p">:</span>
        <span class="n">metrics</span><span class="o">.</span><span class="n">remediation_time</span><span class="o">.</span><span class="n">labels</span><span class="p">(</span><span class="n">severity</span><span class="o">=</span><span class="n">severity</span><span class="p">)</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">remediation_hours</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">update_open_vulnerabilities</span><span class="p">(</span>
    <span class="n">metrics</span><span class="p">:</span> <span class="n">SecurityMetrics</span><span class="p">,</span>
    <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">count</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update open vulnerability count.&quot;&quot;&quot;</span>
    <span class="n">metrics</span><span class="o">.</span><span class="n">vulnerabilities_open</span><span class="o">.</span><span class="n">labels</span><span class="p">(</span><span class="n">tool</span><span class="o">=</span><span class="n">tool</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="n">severity</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">record_scan</span><span class="p">(</span>
    <span class="n">metrics</span><span class="p">:</span> <span class="n">SecurityMetrics</span><span class="p">,</span>
    <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">duration_seconds</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Record a security scan execution.&quot;&quot;&quot;</span>
    <span class="n">metrics</span><span class="o">.</span><span class="n">scan_duration</span><span class="o">.</span><span class="n">labels</span><span class="p">(</span><span class="n">tool</span><span class="o">=</span><span class="n">tool</span><span class="p">)</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">duration_seconds</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">update_compliance</span><span class="p">(</span>
    <span class="n">metrics</span><span class="p">:</span> <span class="n">SecurityMetrics</span><span class="p">,</span>
    <span class="n">framework</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">score</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update compliance score.&quot;&quot;&quot;</span>
    <span class="n">metrics</span><span class="o">.</span><span class="n">compliance_score</span><span class="o">.</span><span class="n">labels</span><span class="p">(</span><span class="n">framework</span><span class="o">=</span><span class="n">framework</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start metrics server.&quot;&quot;&quot;</span>
    <span class="n">registry</span> <span class="o">=</span> <span class="n">CollectorRegistry</span><span class="p">()</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="n">SecurityMetrics</span><span class="p">(</span><span class="n">registry</span><span class="o">=</span><span class="n">registry</span><span class="p">)</span>

    <span class="c1">## Start HTTP server for Prometheus scraping</span>
    <span class="n">start_http_server</span><span class="p">(</span><span class="mi">8000</span><span class="p">,</span> <span class="n">registry</span><span class="o">=</span><span class="n">registry</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Security metrics server started on :8000&quot;</span><span class="p">)</span>

    <span class="c1">## Example metrics updates</span>
    <span class="n">record_vulnerability</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="s2">&quot;trivy&quot;</span><span class="p">,</span> <span class="s2">&quot;critical&quot;</span><span class="p">,</span> <span class="s2">&quot;container&quot;</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
    <span class="n">record_vulnerability</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="s2">&quot;snyk&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;dependency&quot;</span><span class="p">,</span> <span class="mf">24.0</span><span class="p">)</span>
    <span class="n">update_open_vulnerabilities</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="s2">&quot;semgrep&quot;</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">record_scan</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="s2">&quot;trivy&quot;</span><span class="p">,</span> <span class="mf">45.3</span><span class="p">)</span>
    <span class="n">update_compliance</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="s2">&quot;cis&quot;</span><span class="p">,</span> <span class="mf">92.5</span><span class="p">)</span>
    <span class="n">update_compliance</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="s2">&quot;pci-dss&quot;</span><span class="p">,</span> <span class="mf">88.0</span><span class="p">)</span>

    <span class="c1">## Keep server running</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
<h3 id="defectdojo-integration">DefectDojo Integration<a class="headerlink" href="#defectdojo-integration" title="Permanent link">&para;</a></h3>
<p>DefectDojo provides a comprehensive vulnerability management platform for
aggregating findings from multiple security tools.</p>
<p><strong>Import scan results</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;DefectDojo API integration for security scan imports.&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DefectDojoClient</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Client for DefectDojo REST API.&quot;&quot;&quot;</span>

    <span class="n">SCAN_TYPES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;trivy&quot;</span><span class="p">:</span> <span class="s2">&quot;Trivy Scan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;snyk&quot;</span><span class="p">:</span> <span class="s2">&quot;Snyk Scan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;semgrep&quot;</span><span class="p">:</span> <span class="s2">&quot;Semgrep JSON Report&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bandit&quot;</span><span class="p">:</span> <span class="s2">&quot;Bandit Scan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;zap&quot;</span><span class="p">:</span> <span class="s2">&quot;ZAP Scan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;checkov&quot;</span><span class="p">:</span> <span class="s2">&quot;Checkov Scan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gitleaks&quot;</span><span class="p">:</span> <span class="s2">&quot;Gitleaks Scan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sonarqube&quot;</span><span class="p">:</span> <span class="s2">&quot;SonarQube Scan&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">base_url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">api_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;DEFECTDOJO_URL&quot;</span><span class="p">,</span> <span class="s2">&quot;https://defectdojo.example.com&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">api_key</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;DEFECTDOJO_API_KEY&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Token </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_or_create_product</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">prod_type</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get or create a product and return its ID.&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/api/v2/products/&quot;</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;results&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/api/v2/products/&quot;</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
            <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;prod_type&quot;</span><span class="p">:</span> <span class="n">prod_type</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Product: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_or_create_engagement</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">product_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_start</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_end</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get or create an engagement and return its ID.&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/api/v2/engagements/&quot;</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;product&quot;</span><span class="p">:</span> <span class="n">product_id</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;results&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/api/v2/engagements/&quot;</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
            <span class="n">json</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;product&quot;</span><span class="p">:</span> <span class="n">product_id</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot;target_start&quot;</span><span class="p">:</span> <span class="n">target_start</span><span class="p">,</span>
                <span class="s2">&quot;target_end&quot;</span><span class="p">:</span> <span class="n">target_end</span><span class="p">,</span>
                <span class="s2">&quot;engagement_type&quot;</span><span class="p">:</span> <span class="s2">&quot;CI/CD&quot;</span><span class="p">,</span>
                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;In Progress&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">import_scan</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engagement_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">scan_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">verified</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Import scan results to DefectDojo.&quot;&quot;&quot;</span>
        <span class="n">scan_type_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SCAN_TYPES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">scan_type</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">scan_type</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/api/v2/import-scan/&quot;</span><span class="p">,</span>
                <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Token </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">},</span>
                <span class="n">data</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;engagement&quot;</span><span class="p">:</span> <span class="n">engagement_id</span><span class="p">,</span>
                    <span class="s2">&quot;scan_type&quot;</span><span class="p">:</span> <span class="n">scan_type_name</span><span class="p">,</span>
                    <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">verified</span><span class="p">,</span>
                    <span class="s2">&quot;active&quot;</span><span class="p">:</span> <span class="n">active</span><span class="p">,</span>
                    <span class="s2">&quot;close_old_findings&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;push_to_jira&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="n">files</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">f</span><span class="p">},</span>
            <span class="p">)</span>

        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">upload_scan_results</span><span class="p">(</span>
    <span class="n">product_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">engagement_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">scan_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">report_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Upload security scan results to DefectDojo.&quot;&quot;&quot;</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">DefectDojoClient</span><span class="p">()</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">date</span><span class="p">,</span> <span class="n">timedelta</span>

    <span class="n">today</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
    <span class="n">end_date</span> <span class="o">=</span> <span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>

    <span class="n">product_id</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_or_create_product</span><span class="p">(</span><span class="n">product_name</span><span class="p">)</span>
    <span class="n">engagement_id</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_or_create_engagement</span><span class="p">(</span>
        <span class="n">product_id</span><span class="p">,</span> <span class="n">engagement_name</span><span class="p">,</span> <span class="n">today</span><span class="p">,</span> <span class="n">end_date</span>
    <span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">import_scan</span><span class="p">(</span><span class="n">engagement_id</span><span class="p">,</span> <span class="n">scan_type</span><span class="p">,</span> <span class="n">report_path</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Imported </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;test_count&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2"> tests&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;findings_count&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2"> findings&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Usage: defectdojo_import.py &lt;product&gt; &lt;scan_type&gt; &lt;report_path&gt;&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">upload_scan_results</span><span class="p">(</span>
        <span class="n">product_name</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">engagement_name</span><span class="o">=</span><span class="s2">&quot;CI/CD Security Scans&quot;</span><span class="p">,</span>
        <span class="n">scan_type</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="n">report_path</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
    <span class="p">)</span>
</code></pre></div>
<p><strong>CI/CD integration for DefectDojo</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Security Scan with DefectDojo</span>

<span class="nt">on</span><span class="p">:</span>
<span class="w">  </span><span class="nt">push</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">]</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">security-scan</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Trivy Scan</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aquasecurity/trivy-action@master</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">scan-type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;fs&#39;</span>
<span class="w">          </span><span class="nt">scan-ref</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;.&#39;</span>
<span class="w">          </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;json&#39;</span>
<span class="w">          </span><span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;trivy-results.json&#39;</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Semgrep</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">returntocorp/semgrep-action@v1</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">p/security-audit</span>
<span class="w">          </span><span class="nt">generateSarif</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">          </span><span class="nt">SEMGREP_APP_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.SEMGREP_APP_TOKEN }}</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload to DefectDojo</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">          </span><span class="nt">DEFECTDOJO_URL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.DEFECTDOJO_URL }}</span>
<span class="w">          </span><span class="nt">DEFECTDOJO_API_KEY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.DEFECTDOJO_API_KEY }}</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">pip install requests</span>

<span class="w">          </span><span class="no">python scripts/defectdojo_import.py \</span>
<span class="w">            </span><span class="no">&quot;${{ github.repository }}&quot; \</span>
<span class="w">            </span><span class="no">&quot;trivy&quot; \</span>
<span class="w">            </span><span class="no">&quot;trivy-results.json&quot;</span>

<span class="w">          </span><span class="no">if [ -f semgrep.json ]; then</span>
<span class="w">            </span><span class="no">python scripts/defectdojo_import.py \</span>
<span class="w">              </span><span class="no">&quot;${{ github.repository }}&quot; \</span>
<span class="w">              </span><span class="no">&quot;semgrep&quot; \</span>
<span class="w">              </span><span class="no">&quot;semgrep.json&quot;</span>
<span class="w">          </span><span class="no">fi</span>
</code></pre></div>
<h3 id="consolidated-sarif-reporting">Consolidated SARIF Reporting<a class="headerlink" href="#consolidated-sarif-reporting" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;Consolidate SARIF reports from multiple security tools.&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>


<span class="k">def</span><span class="w"> </span><span class="nf">merge_sarif_reports</span><span class="p">(</span><span class="n">report_paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge multiple SARIF reports into a single report.&quot;&quot;&quot;</span>
    <span class="n">merged</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;https://json.schemastore.org/sarif-2.1.0.json&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;runs&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">report_path</span> <span class="ow">in</span> <span class="n">report_paths</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">report_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">report</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">merged</span><span class="p">[</span><span class="s2">&quot;runs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">report</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;runs&quot;</span><span class="p">,</span> <span class="p">[]))</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">merged</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">merged</span>


<span class="k">def</span><span class="w"> </span><span class="nf">generate_summary</span><span class="p">(</span><span class="n">sarif_report</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate summary statistics from SARIF report.&quot;&quot;&quot;</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;total_findings&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;by_severity&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;note&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
        <span class="s2">&quot;by_tool&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;by_rule&quot;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">sarif_report</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;runs&quot;</span><span class="p">,</span> <span class="p">[]):</span>
        <span class="n">tool_name</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tool&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;driver&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">)</span>
        <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;by_tool&quot;</span><span class="p">][</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;by_severity&quot;</span><span class="p">:</span> <span class="p">{}}</span>

        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">run</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;total_findings&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">severity</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;level&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">)</span>
            <span class="n">rule_id</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ruleId&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">)</span>

            <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;by_severity&quot;</span><span class="p">][</span><span class="n">severity</span><span class="p">]</span> <span class="o">=</span> <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;by_severity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">severity</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;by_tool&quot;</span><span class="p">][</span><span class="n">tool_name</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;by_tool&quot;</span><span class="p">][</span><span class="n">tool_name</span><span class="p">][</span><span class="s2">&quot;by_severity&quot;</span><span class="p">][</span><span class="n">severity</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;by_tool&quot;</span><span class="p">][</span><span class="n">tool_name</span><span class="p">][</span><span class="s2">&quot;by_severity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">severity</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">rule_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;by_rule&quot;</span><span class="p">]:</span>
                <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;by_rule&quot;</span><span class="p">][</span><span class="n">rule_id</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;by_rule&quot;</span><span class="p">][</span><span class="n">rule_id</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">summary</span>


<span class="k">def</span><span class="w"> </span><span class="nf">generate_markdown_report</span><span class="p">(</span><span class="n">summary</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate markdown summary report.&quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;# Security Scan Summary&quot;</span><span class="p">,</span>
        <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;**Total Findings:** </span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;total_findings&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;## Findings by Severity&quot;</span><span class="p">,</span>
        <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;| Severity | Count |&quot;</span><span class="p">,</span>
        <span class="s2">&quot;|----------|-------|&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">severity</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;by_severity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;| </span><span class="si">{</span><span class="n">severity</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> |&quot;</span><span class="p">)</span>

    <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;## Findings by Tool&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;| Tool | Total | Errors | Warnings |&quot;</span><span class="p">,</span>
            <span class="s2">&quot;|------|-------|--------|----------|&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">tool</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;by_tool&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;by_severity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">warnings</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;by_severity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;| </span><span class="si">{</span><span class="n">tool</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">errors</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">warnings</span><span class="si">}</span><span class="s2"> |&quot;</span><span class="p">)</span>

    <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;## Top 10 Rules Triggered&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;| Rule ID | Count |&quot;</span><span class="p">,</span>
            <span class="s2">&quot;|---------|-------|&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">sorted_rules</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="s2">&quot;by_rule&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">rule_id</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">sorted_rules</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;| </span><span class="si">{</span><span class="n">rule_id</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> |&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Usage: sarif_consolidate.py &lt;output.sarif&gt; &lt;input1.sarif&gt; [input2.sarif ...]&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">output_path</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">input_paths</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>

    <span class="n">merged</span> <span class="o">=</span> <span class="n">merge_sarif_reports</span><span class="p">(</span><span class="n">input_paths</span><span class="p">,</span> <span class="n">output_path</span><span class="p">)</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="n">generate_summary</span><span class="p">(</span><span class="n">merged</span><span class="p">)</span>
    <span class="n">markdown</span> <span class="o">=</span> <span class="n">generate_markdown_report</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">markdown</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;security-summary.md&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">markdown</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="cicd-integration">CI/CD Integration<a class="headerlink" href="#cicd-integration" title="Permanent link">&para;</a></h2>
<h3 id="github-actions">GitHub Actions<a class="headerlink" href="#github-actions" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Security Scans</span>

<span class="nt">on</span><span class="p">:</span>
<span class="w">  </span><span class="nt">push</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">schedule</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">cron</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0</span><span class="nv"> </span><span class="s">0</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">0&#39;</span><span class="w">  </span><span class="c1"># Weekly</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">secret-scan</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">fetch-depth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TruffleHog Secret Scan</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trufflesecurity/trufflehog@main</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./</span>
<span class="w">          </span><span class="nt">base</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.event.repository.default_branch }}</span>
<span class="w">          </span><span class="nt">head</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HEAD</span>

<span class="w">  </span><span class="nt">sast</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Semgrep</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">returntocorp/semgrep-action@v1</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">            </span><span class="no">p/security-audit</span>
<span class="w">            </span><span class="no">p/owasp-top-ten</span>

<span class="w">  </span><span class="nt">dependency-scan</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Snyk</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">snyk/actions/node@master</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">          </span><span class="nt">SNYK_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.SNYK_TOKEN }}</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--severity-threshold=high</span>

<span class="w">  </span><span class="nt">container-scan</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build image</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker build -t myapp:${{ github.sha }} .</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Trivy scan</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aquasecurity/trivy-action@master</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">image-ref</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp:${{ github.sha }}</span>
<span class="w">          </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;sarif&#39;</span>
<span class="w">          </span><span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;trivy-results.sarif&#39;</span>
<span class="w">          </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;CRITICAL,HIGH&#39;</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload Trivy results</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">github/codeql-action/upload-sarif@v2</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">sarif_file</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;trivy-results.sarif&#39;</span>

<span class="w">  </span><span class="nt">infrastructure-scan</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Checkov</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bridgecrewio/checkov-action@master</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">directory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terraform/</span>
<span class="w">          </span><span class="nt">framework</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terraform</span>
<span class="w">          </span><span class="nt">output_format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sarif</span>
<span class="w">          </span><span class="nt">output_file_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">checkov.sarif</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload Checkov results</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">github/codeql-action/upload-sarif@v2</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">sarif_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">checkov.sarif</span>
</code></pre></div>
<h3 id="gitlab-ci">GitLab CI<a class="headerlink" href="#gitlab-ci" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">stages</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security</span>

<span class="nt">secret-scan</span><span class="p">:</span>
<span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trufflesecurity/trufflehog:latest</span>
<span class="w">  </span><span class="nt">script</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trufflehog filesystem . --json --fail</span>

<span class="nt">sast</span><span class="p">:</span>
<span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">returntocorp/semgrep:latest</span>
<span class="w">  </span><span class="nt">script</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">semgrep --config=auto --sarif --output=semgrep.sarif .</span>
<span class="w">  </span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">    </span><span class="nt">reports</span><span class="p">:</span>
<span class="w">      </span><span class="nt">sast</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">semgrep.sarif</span>

<span class="nt">dependency-scan</span><span class="p">:</span>
<span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">snyk/snyk:python</span>
<span class="w">  </span><span class="nt">script</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">snyk test --severity-threshold=high --json &gt; snyk-report.json || true</span>
<span class="w">  </span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">    </span><span class="nt">reports</span><span class="p">:</span>
<span class="w">      </span><span class="nt">dependency_scanning</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">snyk-report.json</span>

<span class="nt">container-scan</span><span class="p">:</span>
<span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aquasec/trivy:latest</span>
<span class="w">  </span><span class="nt">script</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trivy image --severity HIGH,CRITICAL --format sarif --output trivy.sarif $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA</span>
<span class="w">  </span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">    </span><span class="nt">reports</span><span class="p">:</span>
<span class="w">      </span><span class="nt">container_scanning</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trivy.sarif</span>

<span class="nt">iac-scan</span><span class="p">:</span>
<span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bridgecrew/checkov:latest</span>
<span class="w">  </span><span class="nt">script</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">checkov -d terraform/ --framework terraform --output sarif --output-file checkov.sarif</span>
<span class="w">  </span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">    </span><span class="nt">reports</span><span class="p">:</span>
<span class="w">      </span><span class="nt">sast</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">checkov.sarif</span>
</code></pre></div>
<h3 id="jenkins">Jenkins<a class="headerlink" href="#jenkins" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">pipeline</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">agent</span><span class="w"> </span><span class="n">any</span>

<span class="w">    </span><span class="n">stages</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="n">stage</span><span class="o">(</span><span class="s1">&#39;Security Scans&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="n">parallel</span><span class="w"> </span><span class="o">{</span>
<span class="w">                </span><span class="n">stage</span><span class="o">(</span><span class="s1">&#39;Secret Scan&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">                    </span><span class="n">steps</span><span class="w"> </span><span class="o">{</span>
<span class="w">                        </span><span class="n">sh</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">                            docker run --rm -v $(pwd):/scan \</span>
<span class="s1">                                trufflesecurity/trufflehog:latest \</span>
<span class="s1">                                filesystem /scan --json --fail</span>
<span class="s1">                        &#39;&#39;&#39;</span>
<span class="w">                    </span><span class="o">}</span>
<span class="w">                </span><span class="o">}</span>

<span class="w">                </span><span class="n">stage</span><span class="o">(</span><span class="s1">&#39;SAST&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">                    </span><span class="n">steps</span><span class="w"> </span><span class="o">{</span>
<span class="w">                        </span><span class="n">sh</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">                            docker run --rm -v $(pwd):/src \</span>
<span class="s1">                                returntocorp/semgrep:latest \</span>
<span class="s1">                                semgrep --config=auto /src</span>
<span class="s1">                        &#39;&#39;&#39;</span>
<span class="w">                    </span><span class="o">}</span>
<span class="w">                </span><span class="o">}</span>

<span class="w">                </span><span class="n">stage</span><span class="o">(</span><span class="s1">&#39;Dependency Scan&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">                    </span><span class="n">steps</span><span class="w"> </span><span class="o">{</span>
<span class="w">                        </span><span class="n">sh</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">                            snyk test --severity-threshold=high \</span>
<span class="s1">                                --json &gt; snyk-report.json || true</span>
<span class="s1">                        &#39;&#39;&#39;</span>
<span class="w">                        </span><span class="n">archiveArtifacts</span><span class="w"> </span><span class="nl">artifacts:</span><span class="w"> </span><span class="s1">&#39;snyk-report.json&#39;</span>
<span class="w">                    </span><span class="o">}</span>
<span class="w">                </span><span class="o">}</span>

<span class="w">                </span><span class="n">stage</span><span class="o">(</span><span class="s1">&#39;Container Scan&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">                    </span><span class="n">steps</span><span class="w"> </span><span class="o">{</span>
<span class="w">                        </span><span class="n">sh</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">                            trivy image --severity HIGH,CRITICAL \</span>
<span class="s1">                                --format json \</span>
<span class="s1">                                --output trivy-report.json \</span>
<span class="s1">                                myapp:${GIT_COMMIT}</span>
<span class="s1">                        &#39;&#39;&#39;</span>
<span class="w">                        </span><span class="n">archiveArtifacts</span><span class="w"> </span><span class="nl">artifacts:</span><span class="w"> </span><span class="s1">&#39;trivy-report.json&#39;</span>
<span class="w">                    </span><span class="o">}</span>
<span class="w">                </span><span class="o">}</span>
<span class="w">            </span><span class="o">}</span>
<span class="w">        </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<hr />
<h2 id="security-policies">Security Policies<a class="headerlink" href="#security-policies" title="Permanent link">&para;</a></h2>
<h3 id="securitytxt">Security.txt<a class="headerlink" href="#securitytxt" title="Permanent link">&para;</a></h3>
<p>Place in <code>/.well-known/security.txt</code>:</p>
<div class="highlight"><pre><span></span><code>Contact: security@example.com
Expires: 2026-12-31T23:59:59.000Z
Encryption: https://example.com/pgp-key.txt
Acknowledgments: https://example.com/security-hall-of-fame
Preferred-Languages: en
Canonical: https://example.com/.well-known/security.txt
Policy: https://example.com/security-policy
</code></pre></div>
<h3 id="vulnerability-disclosure-policy">Vulnerability Disclosure Policy<a class="headerlink" href="#vulnerability-disclosure-policy" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="gu">## Vulnerability Disclosure Policy</span>

<span class="gu">## Reporting</span>

Please report security vulnerabilities to: security@example.com

Include:
<span class="k">-</span><span class="w"> </span>Description of the vulnerability
<span class="k">-</span><span class="w"> </span>Steps to reproduce
<span class="k">-</span><span class="w"> </span>Potential impact
<span class="k">-</span><span class="w"> </span>Suggested fixes (optional)

<span class="gu">## Response Timeline</span>

<span class="k">-</span><span class="w"> </span><span class="gs">**24 hours**</span>: Initial response
<span class="k">-</span><span class="w"> </span><span class="gs">**7 days**</span>: Preliminary assessment
<span class="k">-</span><span class="w"> </span><span class="gs">**30 days**</span>: Fix development
<span class="k">-</span><span class="w"> </span><span class="gs">**90 days**</span>: Public disclosure

<span class="gu">## Safe Harbor</span>

We will not pursue legal action against researchers who:
<span class="k">-</span><span class="w"> </span>Make good faith efforts to comply with this policy
<span class="k">-</span><span class="w"> </span>Do not access or modify user data
<span class="k">-</span><span class="w"> </span>Do not disrupt our services
</code></pre></div>
<hr />
<h2 id="resources">Resources<a class="headerlink" href="#resources" title="Permanent link">&para;</a></h2>
<h3 id="standards-and-guidelines">Standards and Guidelines<a class="headerlink" href="#standards-and-guidelines" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://owasp.org/www-project-top-ten/">OWASP Top 10</a></li>
<li><a href="https://owasp.org/www-community/Source_Code_Analysis_Tools">OWASP SAST Tools</a></li>
<li><a href="https://owasp.org/www-community/Vulnerability_Scanning_Tools">OWASP DAST Tools</a></li>
<li><a href="https://cwe.mitre.org/top25/">CWE Top 25</a></li>
<li><a href="https://www.nist.gov/cybersecurity">NIST Security Guidelines</a></li>
<li><a href="https://cloudsecurityalliance.org/">Cloud Security Alliance</a></li>
<li><a href="https://www.first.org/cvss/calculator/3.1">CVSS Calculator</a></li>
<li><a href="https://www.cisecurity.org/cis-benchmarks">CIS Benchmarks</a></li>
</ul>
<h3 id="secret-detection-tools">Secret Detection Tools<a class="headerlink" href="#secret-detection-tools" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://github.com/trufflesecurity/trufflehog">TruffleHog Documentation</a></li>
<li><a href="https://github.com/gitleaks/gitleaks">Gitleaks Documentation</a></li>
<li><a href="https://docs.gitguardian.com/">GitGuardian Documentation</a></li>
<li><a href="https://github.com/Yelp/detect-secrets">detect-secrets Documentation</a></li>
</ul>
<h3 id="sast-tools">SAST Tools<a class="headerlink" href="#sast-tools" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://semgrep.dev/docs/">Semgrep Documentation</a></li>
<li><a href="https://bandit.readthedocs.io/">Bandit Documentation</a></li>
<li><a href="https://securego.io/">gosec Documentation</a></li>
<li><a href="https://docs.sonarsource.com/sonarqube/">SonarQube Documentation</a></li>
<li><a href="https://github.com/eslint-community/eslint-plugin-security">ESLint Security Plugin</a></li>
</ul>
<h3 id="dast-tools">DAST Tools<a class="headerlink" href="#dast-tools" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://www.zaproxy.org/docs/">OWASP ZAP Documentation</a></li>
<li><a href="https://docs.projectdiscovery.io/tools/nuclei/">Nuclei Documentation</a></li>
<li><a href="https://portswigger.net/burp/documentation">Burp Suite Documentation</a></li>
</ul>
<h3 id="dependency-scanning-sca">Dependency Scanning (SCA)<a class="headerlink" href="#dependency-scanning-sca" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://docs.snyk.io/">Snyk Documentation</a></li>
<li><a href="https://owasp.org/www-project-dependency-check/">OWASP Dependency-Check</a></li>
<li><a href="https://github.com/anchore/grype">Grype Documentation</a></li>
</ul>
<h3 id="container-and-infrastructure-security">Container and Infrastructure Security<a class="headerlink" href="#container-and-infrastructure-security" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://aquasecurity.github.io/trivy/">Trivy Documentation</a></li>
<li><a href="https://www.checkov.io/1.Welcome/What%20is%20Checkov.html">Checkov Documentation</a></li>
<li><a href="https://aquasecurity.github.io/tfsec/">tfsec Documentation</a></li>
<li><a href="https://github.com/aquasecurity/kube-bench">kube-bench Documentation</a></li>
</ul>
<h3 id="policy-as-code">Policy as Code<a class="headerlink" href="#policy-as-code" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://www.openpolicyagent.org/docs/latest/">Open Policy Agent (OPA)</a></li>
<li><a href="https://www.openpolicyagent.org/docs/latest/policy-language/">Rego Policy Language</a></li>
<li><a href="https://www.conftest.dev/">Conftest Documentation</a></li>
<li><a href="https://open-policy-agent.github.io/gatekeeper/">Gatekeeper Documentation</a></li>
</ul>
<h3 id="compliance-and-benchmarks">Compliance and Benchmarks<a class="headerlink" href="#compliance-and-benchmarks" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://www.cisecurity.org/cis-benchmarks">CIS Benchmarks</a></li>
<li><a href="https://docs.chef.io/inspec/">Chef InSpec</a></li>
<li><a href="https://www.open-scap.org/tools/openscap-base/">OpenSCAP Documentation</a></li>
<li><a href="https://github.com/prowler-cloud/prowler">Prowler Documentation</a></li>
</ul>
<h3 id="security-dashboards-and-management">Security Dashboards and Management<a class="headerlink" href="#security-dashboards-and-management" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://defectdojo.github.io/django-DefectDojo/">DefectDojo Documentation</a></li>
<li><a href="https://sarifweb.azurewebsites.net/">SARIF Specification</a></li>
</ul>
<hr />
<p><strong>Next Steps:</strong></p>
<ul>
<li>Review the <a href="../ai_validation_pipeline/">AI Validation Pipeline</a> for complete CI/CD security integration</li>
<li>See <a href="../precommit_hooks_guide/">Pre-commit Hooks Guide</a> for local security checks</li>
<li>Check <a href="../github_actions_guide/">GitHub Actions Guide</a> for security workflows</li>
<li>Explore <a href="../observability_guide/">Observability Guide</a> for security monitoring integration</li>
</ul>







  
  



  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/tydukes" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in/tydukes" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "content.code.annotate", "search.highlight", "search.share"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>