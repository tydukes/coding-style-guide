# SonarCloud Security Hotspot Review Guide

## GitHub Actions Version Tag Hotspots

### Context

This project intentionally uses **version tags** (e.g., `@v6.0.1`) instead of full commit SHA hashes
for GitHub Actions, as documented in `SECURITY.md`. This is a deliberate security policy decision
that balances security, readability, and maintainability.

### Security Hotspot Rule: yaml:S6270

**Rule Description**: "Using unpinned GitHub Actions is security-sensitive"

**Our Policy**: We use version tags for official GitHub Actions (actions/*, docker/*, etc.)
and SHA pinning only for third-party actions with security concerns.

### Steps to Permanently Mark as Safe in SonarCloud

1. **Navigate to Security Hotspots**:
   - Go to <https://sonarcloud.io/project/security_hotspots?id=coding-style-guide>
   - Filter by: "To Review" or "Open"

2. **For Each GitHub Actions Hotspot**:
   - Click on the hotspot
   - Click **"Open"** or **"Safe"** (depending on SonarCloud version)
   - Select **"Safe"** from the dropdown
   - Add this comment:

     ```text
     Accepted Risk: Version tags intentionally used per SECURITY.md policy.
     Official GitHub Actions (actions/*, docker/*, astral-sh/*) use version tags
     for improved maintainability and automatic security updates via Dependabot.
     See: https://github.com/tydukes/coding-style-guide/blob/main/SECURITY.md
     ```

   - Click **"Mark as Safe"**

3. **Bulk Review** (if available):
   - Select all 5 hotspots using checkboxes
   - Click "Bulk change" â†’ "Mark as Safe"
   - Add the same comment for all

### Expected Hotspots (5 total)

Based on our workflow files, these are likely the hotspots:

1. `.github/workflows/ci.yml` - actions/checkout@v6.0.1
2. `.github/workflows/ci.yml` - actions/cache@v5
3. `.github/workflows/ci.yml` - actions/upload-artifact@v6
4. `.github/workflows/deploy.yml` - actions/checkout@v6
5. `.github/workflows/container.yml` - docker/setup-buildx-action@v3

### Why This is Safe

1. **Official Actions**: We only use version tags for official GitHub-maintained actions
2. **Dependabot**: Automatically updates version tags to latest secure versions
3. **Audit Trail**: Git history shows all version changes
4. **Signed Releases**: GitHub official actions are signed and verified
5. **Lower Maintenance**: Easier to read and maintain than 40-character SHAs

### Automated Review (Optional)

If you want to automate this in the future, you can use the SonarCloud API:

```bash
# Set environment variables
export SONAR_TOKEN="your-token-here"
export SONAR_ORG="tydukes"
export SONAR_PROJECT="coding-style-guide"

# Get all open security hotspots
curl -u "${SONAR_TOKEN}:" \
  "https://sonarcloud.io/api/hotspots/search?projectKey=${SONAR_PROJECT}&status=TO_REVIEW"

# Mark hotspot as safe (replace HOTSPOT_KEY with actual key from above)
curl -u "${SONAR_TOKEN}:" -X POST \
  "https://sonarcloud.io/api/hotspots/change_status" \
  -d "hotspot=HOTSPOT_KEY" \
  -d "status=REVIEWED" \
  -d "resolution=SAFE" \
  -d "comment=Accepted Risk: Version tags intentionally used per SECURITY.md policy"
```

### References

- [SECURITY.md](../SECURITY.md) - Our GitHub Actions versioning policy
- [SonarCloud Security Hotspots Docs](https://docs.sonarcloud.io/digging-deeper/security-hotspots/)
- [GitHub Actions Security Hardening](https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions)

---

**Last Updated**: 2026-01-04
**Reviewed By**: Tyler Dukes
**Next Review**: When adding new workflows or changing versioning policy
